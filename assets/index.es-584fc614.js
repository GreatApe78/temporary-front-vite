import{b7 as Wo,b8 as zu,d as ot,b9 as cw,e as Ir,f as uw,ba as vf,o as hw}from"./index-ce1aab06.js";import{e as Dr,H as Ku}from"./index-eaa96ed7.js";import{c as op,r as ap}from"./index-c2afdd99.js";var As={};Object.defineProperty(As,"__esModule",{value:!0});function lw(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return JSON.parse(i)}catch{return i}}As.safeJsonParse=lw;function fw(i){return typeof i=="string"?i:JSON.stringify(i,(e,t)=>typeof t>"u"?null:t)}As.safeJsonStringify=fw;var Vc,yf;function dw(){if(yf)return Vc;yf=1;function i(t){try{return JSON.stringify(t)}catch{return'"[Circular]"'}}Vc=e;function e(t,s,o){var c=o&&o.stringify||i,d=1;if(typeof t=="object"&&t!==null){var f=s.length+d;if(f===1)return t;var g=new Array(f);g[0]=c(t);for(var y=1;y<f;y++)g[y]=c(s[y]);return g.join(" ")}if(typeof t!="string")return t;var b=s.length;if(b===0)return t;for(var x="",P=1-d,A=-1,q=t&&t.length||0,z=0;z<q;){if(t.charCodeAt(z)===37&&z+1<q){switch(A=A>-1?A:0,t.charCodeAt(z+1)){case 100:case 102:if(P>=b||s[P]==null)break;A<z&&(x+=t.slice(A,z)),x+=Number(s[P]),A=z+2,z++;break;case 105:if(P>=b||s[P]==null)break;A<z&&(x+=t.slice(A,z)),x+=Math.floor(Number(s[P])),A=z+2,z++;break;case 79:case 111:case 106:if(P>=b||s[P]===void 0)break;A<z&&(x+=t.slice(A,z));var K=typeof s[P];if(K==="string"){x+="'"+s[P]+"'",A=z+2,z++;break}if(K==="function"){x+=s[P].name||"<anonymous>",A=z+2,z++;break}x+=c(s[P]),A=z+2,z++;break;case 115:if(P>=b)break;A<z&&(x+=t.slice(A,z)),x+=String(s[P]),A=z+2,z++;break;case 37:A<z&&(x+=t.slice(A,z)),x+="%",A=z+2,z++,P--;break}++P}++z}return A===-1?t:(A<q&&(x+=t.slice(A)),x)}return Vc}let Dn=class{};class pw extends Dn{constructor(e){super(),this.opts=e,this.protocol="wc",this.version=2}}let gw=class extends Dn{constructor(e,t){super(),this.core=e,this.logger=t,this.records=new Map}};class vw{constructor(e,t){this.logger=e,this.core=t}}let yw=class extends Dn{constructor(e,t){super(),this.relayer=e,this.logger=t}},_w=class extends Dn{constructor(e){super()}},mw=class{constructor(e,t,s,o){this.core=e,this.logger=t,this.name=s}};class ww extends Dn{constructor(e,t){super(),this.relayer=e,this.logger=t}}let bw=class extends Dn{constructor(e,t){super(),this.core=e,this.logger=t}},Ew=class{constructor(e,t){this.projectId=e,this.logger=t}},Sw=class{constructor(e){this.opts=e,this.protocol="wc",this.version=2}},Iw=class{constructor(e){this.client=e}};var Vu={},na={},Me={},cp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,g){var y=f>>>16&65535,b=f&65535,x=g>>>16&65535,P=g&65535;return b*P+(y*P+b*x<<16>>>0)|0}i.mul=Math.imul||e;function t(f,g){return f+g|0}i.add=t;function s(f,g){return f-g|0}i.sub=s;function o(f,g){return f<<g|f>>>32-g}i.rotl=o;function c(f,g){return f<<32-g|f>>>g}i.rotr=c;function d(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||d,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(cp);Object.defineProperty(Me,"__esModule",{value:!0});var up=cp;function Ow(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Me.readInt16BE=Ow;function Pw(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Me.readUint16BE=Pw;function xw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Me.readInt16LE=xw;function Tw(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Me.readUint16LE=Tw;function hp(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Me.writeUint16BE=hp;Me.writeInt16BE=hp;function lp(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Me.writeUint16LE=lp;Me.writeInt16LE=lp;function yu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Me.readInt32BE=yu;function _u(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Me.readUint32BE=_u;function mu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Me.readInt32LE=mu;function wu(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Me.readUint32LE=wu;function Yo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Me.writeUint32BE=Yo;Me.writeInt32BE=Yo;function Jo(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Me.writeUint32LE=Jo;Me.writeInt32LE=Jo;function Nw(i,e){e===void 0&&(e=0);var t=yu(i,e),s=yu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Me.readInt64BE=Nw;function Aw(i,e){e===void 0&&(e=0);var t=_u(i,e),s=_u(i,e+4);return t*4294967296+s}Me.readUint64BE=Aw;function Rw(i,e){e===void 0&&(e=0);var t=mu(i,e),s=mu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Me.readInt64LE=Rw;function Cw(i,e){e===void 0&&(e=0);var t=wu(i,e),s=wu(i,e+4);return s*4294967296+t}Me.readUint64LE=Cw;function fp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Yo(i/4294967296>>>0,e,t),Yo(i>>>0,e,t+4),e}Me.writeUint64BE=fp;Me.writeInt64BE=fp;function dp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),Jo(i>>>0,e,t),Jo(i/4294967296>>>0,e,t+4),e}Me.writeUint64LE=dp;Me.writeInt64LE=dp;function Uw(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Me.readUintBE=Uw;function $w(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Me.readUintLE=$w;function Lw(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!up.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Me.writeUintBE=Lw;function Fw(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!up.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Me.writeUintLE=Fw;function Dw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Me.readFloat32BE=Dw;function Mw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Me.readFloat32LE=Mw;function jw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Me.readFloat64BE=jw;function qw(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Me.readFloat64LE=qw;function Hw(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Me.writeFloat32BE=Hw;function Bw(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Me.writeFloat32LE=Bw;function zw(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Me.writeFloat64BE=zw;function Kw(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Me.writeFloat64LE=Kw;var Yr={};Object.defineProperty(Yr,"__esModule",{value:!0});function Vw(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Yr.wipe=Vw;Object.defineProperty(na,"__esModule",{value:!0});var Zt=Me,bu=Yr,kw=20;function Gw(i,e,t){for(var s=1634760805,o=857760878,c=2036477234,d=1797285236,f=t[3]<<24|t[2]<<16|t[1]<<8|t[0],g=t[7]<<24|t[6]<<16|t[5]<<8|t[4],y=t[11]<<24|t[10]<<16|t[9]<<8|t[8],b=t[15]<<24|t[14]<<16|t[13]<<8|t[12],x=t[19]<<24|t[18]<<16|t[17]<<8|t[16],P=t[23]<<24|t[22]<<16|t[21]<<8|t[20],A=t[27]<<24|t[26]<<16|t[25]<<8|t[24],q=t[31]<<24|t[30]<<16|t[29]<<8|t[28],z=e[3]<<24|e[2]<<16|e[1]<<8|e[0],K=e[7]<<24|e[6]<<16|e[5]<<8|e[4],oe=e[11]<<24|e[10]<<16|e[9]<<8|e[8],C=e[15]<<24|e[14]<<16|e[13]<<8|e[12],D=s,I=o,N=c,w=d,h=f,m=g,G=y,k=b,se=x,ce=P,ge=A,U=q,H=z,le=K,te=oe,W=C,ee=0;ee<kw;ee+=2)D=D+h|0,H^=D,H=H>>>32-16|H<<16,se=se+H|0,h^=se,h=h>>>32-12|h<<12,I=I+m|0,le^=I,le=le>>>32-16|le<<16,ce=ce+le|0,m^=ce,m=m>>>32-12|m<<12,N=N+G|0,te^=N,te=te>>>32-16|te<<16,ge=ge+te|0,G^=ge,G=G>>>32-12|G<<12,w=w+k|0,W^=w,W=W>>>32-16|W<<16,U=U+W|0,k^=U,k=k>>>32-12|k<<12,N=N+G|0,te^=N,te=te>>>32-8|te<<8,ge=ge+te|0,G^=ge,G=G>>>32-7|G<<7,w=w+k|0,W^=w,W=W>>>32-8|W<<8,U=U+W|0,k^=U,k=k>>>32-7|k<<7,I=I+m|0,le^=I,le=le>>>32-8|le<<8,ce=ce+le|0,m^=ce,m=m>>>32-7|m<<7,D=D+h|0,H^=D,H=H>>>32-8|H<<8,se=se+H|0,h^=se,h=h>>>32-7|h<<7,D=D+m|0,W^=D,W=W>>>32-16|W<<16,ge=ge+W|0,m^=ge,m=m>>>32-12|m<<12,I=I+G|0,H^=I,H=H>>>32-16|H<<16,U=U+H|0,G^=U,G=G>>>32-12|G<<12,N=N+k|0,le^=N,le=le>>>32-16|le<<16,se=se+le|0,k^=se,k=k>>>32-12|k<<12,w=w+h|0,te^=w,te=te>>>32-16|te<<16,ce=ce+te|0,h^=ce,h=h>>>32-12|h<<12,N=N+k|0,le^=N,le=le>>>32-8|le<<8,se=se+le|0,k^=se,k=k>>>32-7|k<<7,w=w+h|0,te^=w,te=te>>>32-8|te<<8,ce=ce+te|0,h^=ce,h=h>>>32-7|h<<7,I=I+G|0,H^=I,H=H>>>32-8|H<<8,U=U+H|0,G^=U,G=G>>>32-7|G<<7,D=D+m|0,W^=D,W=W>>>32-8|W<<8,ge=ge+W|0,m^=ge,m=m>>>32-7|m<<7;Zt.writeUint32LE(D+s|0,i,0),Zt.writeUint32LE(I+o|0,i,4),Zt.writeUint32LE(N+c|0,i,8),Zt.writeUint32LE(w+d|0,i,12),Zt.writeUint32LE(h+f|0,i,16),Zt.writeUint32LE(m+g|0,i,20),Zt.writeUint32LE(G+y|0,i,24),Zt.writeUint32LE(k+b|0,i,28),Zt.writeUint32LE(se+x|0,i,32),Zt.writeUint32LE(ce+P|0,i,36),Zt.writeUint32LE(ge+A|0,i,40),Zt.writeUint32LE(U+q|0,i,44),Zt.writeUint32LE(H+z|0,i,48),Zt.writeUint32LE(le+K|0,i,52),Zt.writeUint32LE(te+oe|0,i,56),Zt.writeUint32LE(W+C|0,i,60)}function pp(i,e,t,s,o){if(o===void 0&&(o=0),i.length!==32)throw new Error("ChaCha: key size must be 32 bytes");if(s.length<t.length)throw new Error("ChaCha: destination is shorter than source");var c,d;if(o===0){if(e.length!==8&&e.length!==12)throw new Error("ChaCha nonce must be 8 or 12 bytes");c=new Uint8Array(16),d=c.length-e.length,c.set(e,d)}else{if(e.length!==16)throw new Error("ChaCha nonce with counter must be 16 bytes");c=e,d=o}for(var f=new Uint8Array(64),g=0;g<t.length;g+=64){Gw(f,c,i);for(var y=g;y<g+64&&y<t.length;y++)s[y]=t[y]^f[y-g];Yw(c,0,d)}return bu.wipe(f),o===0&&bu.wipe(c),s}na.streamXOR=pp;function Ww(i,e,t,s){return s===void 0&&(s=0),bu.wipe(t),pp(i,e,t,t,s)}na.stream=Ww;function Yw(i,e,t){for(var s=1;t--;)s=s+(i[e]&255)|0,i[e]=s&255,s>>>=8,e++;if(s>0)throw new Error("ChaCha: counter overflow")}var gp={},Fi={};Object.defineProperty(Fi,"__esModule",{value:!0});function Jw(i,e,t){return~(i-1)&e|i-1&t}Fi.select=Jw;function Qw(i,e){return(i|0)-(e|0)-1>>>31&1}Fi.lessOrEqual=Qw;function vp(i,e){if(i.length!==e.length)return 0;for(var t=0,s=0;s<i.length;s++)t|=i[s]^e[s];return 1&t-1>>>8}Fi.compare=vp;function Xw(i,e){return i.length===0||e.length===0?!1:vp(i,e)!==0}Fi.equal=Xw;(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Fi,t=Yr;i.DIGEST_LENGTH=16;var s=function(){function d(f){this.digestLength=i.DIGEST_LENGTH,this._buffer=new Uint8Array(16),this._r=new Uint16Array(10),this._h=new Uint16Array(10),this._pad=new Uint16Array(8),this._leftover=0,this._fin=0,this._finished=!1;var g=f[0]|f[1]<<8;this._r[0]=g&8191;var y=f[2]|f[3]<<8;this._r[1]=(g>>>13|y<<3)&8191;var b=f[4]|f[5]<<8;this._r[2]=(y>>>10|b<<6)&7939;var x=f[6]|f[7]<<8;this._r[3]=(b>>>7|x<<9)&8191;var P=f[8]|f[9]<<8;this._r[4]=(x>>>4|P<<12)&255,this._r[5]=P>>>1&8190;var A=f[10]|f[11]<<8;this._r[6]=(P>>>14|A<<2)&8191;var q=f[12]|f[13]<<8;this._r[7]=(A>>>11|q<<5)&8065;var z=f[14]|f[15]<<8;this._r[8]=(q>>>8|z<<8)&8191,this._r[9]=z>>>5&127,this._pad[0]=f[16]|f[17]<<8,this._pad[1]=f[18]|f[19]<<8,this._pad[2]=f[20]|f[21]<<8,this._pad[3]=f[22]|f[23]<<8,this._pad[4]=f[24]|f[25]<<8,this._pad[5]=f[26]|f[27]<<8,this._pad[6]=f[28]|f[29]<<8,this._pad[7]=f[30]|f[31]<<8}return d.prototype._blocks=function(f,g,y){for(var b=this._fin?0:2048,x=this._h[0],P=this._h[1],A=this._h[2],q=this._h[3],z=this._h[4],K=this._h[5],oe=this._h[6],C=this._h[7],D=this._h[8],I=this._h[9],N=this._r[0],w=this._r[1],h=this._r[2],m=this._r[3],G=this._r[4],k=this._r[5],se=this._r[6],ce=this._r[7],ge=this._r[8],U=this._r[9];y>=16;){var H=f[g+0]|f[g+1]<<8;x+=H&8191;var le=f[g+2]|f[g+3]<<8;P+=(H>>>13|le<<3)&8191;var te=f[g+4]|f[g+5]<<8;A+=(le>>>10|te<<6)&8191;var W=f[g+6]|f[g+7]<<8;q+=(te>>>7|W<<9)&8191;var ee=f[g+8]|f[g+9]<<8;z+=(W>>>4|ee<<12)&8191,K+=ee>>>1&8191;var Y=f[g+10]|f[g+11]<<8;oe+=(ee>>>14|Y<<2)&8191;var re=f[g+12]|f[g+13]<<8;C+=(Y>>>11|re<<5)&8191;var Pe=f[g+14]|f[g+15]<<8;D+=(re>>>8|Pe<<8)&8191,I+=Pe>>>5|b;var ie=0,we=ie;we+=x*N,we+=P*(5*U),we+=A*(5*ge),we+=q*(5*ce),we+=z*(5*se),ie=we>>>13,we&=8191,we+=K*(5*k),we+=oe*(5*G),we+=C*(5*m),we+=D*(5*h),we+=I*(5*w),ie+=we>>>13,we&=8191;var he=ie;he+=x*w,he+=P*N,he+=A*(5*U),he+=q*(5*ge),he+=z*(5*ce),ie=he>>>13,he&=8191,he+=K*(5*se),he+=oe*(5*k),he+=C*(5*G),he+=D*(5*m),he+=I*(5*h),ie+=he>>>13,he&=8191;var _e=ie;_e+=x*h,_e+=P*w,_e+=A*N,_e+=q*(5*U),_e+=z*(5*ge),ie=_e>>>13,_e&=8191,_e+=K*(5*ce),_e+=oe*(5*se),_e+=C*(5*k),_e+=D*(5*G),_e+=I*(5*m),ie+=_e>>>13,_e&=8191;var j=ie;j+=x*m,j+=P*h,j+=A*w,j+=q*N,j+=z*(5*U),ie=j>>>13,j&=8191,j+=K*(5*ge),j+=oe*(5*ce),j+=C*(5*se),j+=D*(5*k),j+=I*(5*G),ie+=j>>>13,j&=8191;var M=ie;M+=x*G,M+=P*m,M+=A*h,M+=q*w,M+=z*N,ie=M>>>13,M&=8191,M+=K*(5*U),M+=oe*(5*ge),M+=C*(5*ce),M+=D*(5*se),M+=I*(5*k),ie+=M>>>13,M&=8191;var R=ie;R+=x*k,R+=P*G,R+=A*m,R+=q*h,R+=z*w,ie=R>>>13,R&=8191,R+=K*N,R+=oe*(5*U),R+=C*(5*ge),R+=D*(5*ce),R+=I*(5*se),ie+=R>>>13,R&=8191;var l=ie;l+=x*se,l+=P*k,l+=A*G,l+=q*m,l+=z*h,ie=l>>>13,l&=8191,l+=K*w,l+=oe*N,l+=C*(5*U),l+=D*(5*ge),l+=I*(5*ce),ie+=l>>>13,l&=8191;var O=ie;O+=x*ce,O+=P*se,O+=A*k,O+=q*G,O+=z*m,ie=O>>>13,O&=8191,O+=K*h,O+=oe*w,O+=C*N,O+=D*(5*U),O+=I*(5*ge),ie+=O>>>13,O&=8191;var ne=ie;ne+=x*ge,ne+=P*ce,ne+=A*se,ne+=q*k,ne+=z*G,ie=ne>>>13,ne&=8191,ne+=K*m,ne+=oe*h,ne+=C*w,ne+=D*N,ne+=I*(5*U),ie+=ne>>>13,ne&=8191;var fe=ie;fe+=x*U,fe+=P*ge,fe+=A*ce,fe+=q*se,fe+=z*k,ie=fe>>>13,fe&=8191,fe+=K*G,fe+=oe*m,fe+=C*h,fe+=D*w,fe+=I*N,ie+=fe>>>13,fe&=8191,ie=(ie<<2)+ie|0,ie=ie+we|0,we=ie&8191,ie=ie>>>13,he+=ie,x=we,P=he,A=_e,q=j,z=M,K=R,oe=l,C=O,D=ne,I=fe,g+=16,y-=16}this._h[0]=x,this._h[1]=P,this._h[2]=A,this._h[3]=q,this._h[4]=z,this._h[5]=K,this._h[6]=oe,this._h[7]=C,this._h[8]=D,this._h[9]=I},d.prototype.finish=function(f,g){g===void 0&&(g=0);var y=new Uint16Array(10),b,x,P,A;if(this._leftover){for(A=this._leftover,this._buffer[A++]=1;A<16;A++)this._buffer[A]=0;this._fin=1,this._blocks(this._buffer,0,16)}for(b=this._h[1]>>>13,this._h[1]&=8191,A=2;A<10;A++)this._h[A]+=b,b=this._h[A]>>>13,this._h[A]&=8191;for(this._h[0]+=b*5,b=this._h[0]>>>13,this._h[0]&=8191,this._h[1]+=b,b=this._h[1]>>>13,this._h[1]&=8191,this._h[2]+=b,y[0]=this._h[0]+5,b=y[0]>>>13,y[0]&=8191,A=1;A<10;A++)y[A]=this._h[A]+b,b=y[A]>>>13,y[A]&=8191;for(y[9]-=8192,x=(b^1)-1,A=0;A<10;A++)y[A]&=x;for(x=~x,A=0;A<10;A++)this._h[A]=this._h[A]&x|y[A];for(this._h[0]=(this._h[0]|this._h[1]<<13)&65535,this._h[1]=(this._h[1]>>>3|this._h[2]<<10)&65535,this._h[2]=(this._h[2]>>>6|this._h[3]<<7)&65535,this._h[3]=(this._h[3]>>>9|this._h[4]<<4)&65535,this._h[4]=(this._h[4]>>>12|this._h[5]<<1|this._h[6]<<14)&65535,this._h[5]=(this._h[6]>>>2|this._h[7]<<11)&65535,this._h[6]=(this._h[7]>>>5|this._h[8]<<8)&65535,this._h[7]=(this._h[8]>>>8|this._h[9]<<5)&65535,P=this._h[0]+this._pad[0],this._h[0]=P&65535,A=1;A<8;A++)P=(this._h[A]+this._pad[A]|0)+(P>>>16)|0,this._h[A]=P&65535;return f[g+0]=this._h[0]>>>0,f[g+1]=this._h[0]>>>8,f[g+2]=this._h[1]>>>0,f[g+3]=this._h[1]>>>8,f[g+4]=this._h[2]>>>0,f[g+5]=this._h[2]>>>8,f[g+6]=this._h[3]>>>0,f[g+7]=this._h[3]>>>8,f[g+8]=this._h[4]>>>0,f[g+9]=this._h[4]>>>8,f[g+10]=this._h[5]>>>0,f[g+11]=this._h[5]>>>8,f[g+12]=this._h[6]>>>0,f[g+13]=this._h[6]>>>8,f[g+14]=this._h[7]>>>0,f[g+15]=this._h[7]>>>8,this._finished=!0,this},d.prototype.update=function(f){var g=0,y=f.length,b;if(this._leftover){b=16-this._leftover,b>y&&(b=y);for(var x=0;x<b;x++)this._buffer[this._leftover+x]=f[g+x];if(y-=b,g+=b,this._leftover+=b,this._leftover<16)return this;this._blocks(this._buffer,0,16),this._leftover=0}if(y>=16&&(b=y-y%16,this._blocks(f,g,b),g+=b,y-=b),y){for(var x=0;x<y;x++)this._buffer[this._leftover+x]=f[g+x];this._leftover+=y}return this},d.prototype.digest=function(){if(this._finished)throw new Error("Poly1305 was finished");var f=new Uint8Array(16);return this.finish(f),f},d.prototype.clean=function(){return t.wipe(this._buffer),t.wipe(this._r),t.wipe(this._h),t.wipe(this._pad),this._leftover=0,this._fin=0,this._finished=!0,this},d}();i.Poly1305=s;function o(d,f){var g=new s(d);g.update(f);var y=g.digest();return g.clean(),y}i.oneTimeAuth=o;function c(d,f){return d.length!==i.DIGEST_LENGTH||f.length!==i.DIGEST_LENGTH?!1:e.equal(d,f)}i.equal=c})(gp);(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=na,t=gp,s=Yr,o=Me,c=Fi;i.KEY_LENGTH=32,i.NONCE_LENGTH=12,i.TAG_LENGTH=16;var d=new Uint8Array(16),f=function(){function g(y){if(this.nonceLength=i.NONCE_LENGTH,this.tagLength=i.TAG_LENGTH,y.length!==i.KEY_LENGTH)throw new Error("ChaCha20Poly1305 needs 32-byte key");this._key=new Uint8Array(y)}return g.prototype.seal=function(y,b,x,P){if(y.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");var A=new Uint8Array(16);A.set(y,A.length-y.length);var q=new Uint8Array(32);e.stream(this._key,A,q,4);var z=b.length+this.tagLength,K;if(P){if(P.length!==z)throw new Error("ChaCha20Poly1305: incorrect destination length");K=P}else K=new Uint8Array(z);return e.streamXOR(this._key,A,b,K,4),this._authenticate(K.subarray(K.length-this.tagLength,K.length),q,K.subarray(0,K.length-this.tagLength),x),s.wipe(A),K},g.prototype.open=function(y,b,x,P){if(y.length>16)throw new Error("ChaCha20Poly1305: incorrect nonce length");if(b.length<this.tagLength)return null;var A=new Uint8Array(16);A.set(y,A.length-y.length);var q=new Uint8Array(32);e.stream(this._key,A,q,4);var z=new Uint8Array(this.tagLength);if(this._authenticate(z,q,b.subarray(0,b.length-this.tagLength),x),!c.equal(z,b.subarray(b.length-this.tagLength,b.length)))return null;var K=b.length-this.tagLength,oe;if(P){if(P.length!==K)throw new Error("ChaCha20Poly1305: incorrect destination length");oe=P}else oe=new Uint8Array(K);return e.streamXOR(this._key,A,b.subarray(0,b.length-this.tagLength),oe,4),s.wipe(A),oe},g.prototype.clean=function(){return s.wipe(this._key),this},g.prototype._authenticate=function(y,b,x,P){var A=new t.Poly1305(b);P&&(A.update(P),P.length%16>0&&A.update(d.subarray(P.length%16))),A.update(x),x.length%16>0&&A.update(d.subarray(x.length%16));var q=new Uint8Array(8);P&&o.writeUint64LE(P.length,q),A.update(q),o.writeUint64LE(x.length,q),A.update(q);for(var z=A.digest(),K=0;K<z.length;K++)y[K]=z[K];A.clean(),s.wipe(z),s.wipe(q)},g}();i.ChaCha20Poly1305=f})(Vu);var yp={},Rs={},ku={};Object.defineProperty(ku,"__esModule",{value:!0});function Zw(i){return typeof i.saveState<"u"&&typeof i.restoreState<"u"&&typeof i.cleanSavedState<"u"}ku.isSerializableHash=Zw;Object.defineProperty(Rs,"__esModule",{value:!0});var ri=ku,eb=Fi,tb=Yr,_p=function(){function i(e,t){this._finished=!1,this._inner=new e,this._outer=new e,this.blockSize=this._outer.blockSize,this.digestLength=this._outer.digestLength;var s=new Uint8Array(this.blockSize);t.length>this.blockSize?this._inner.update(t).finish(s).clean():s.set(t);for(var o=0;o<s.length;o++)s[o]^=54;this._inner.update(s);for(var o=0;o<s.length;o++)s[o]^=106;this._outer.update(s),ri.isSerializableHash(this._inner)&&ri.isSerializableHash(this._outer)&&(this._innerKeyedState=this._inner.saveState(),this._outerKeyedState=this._outer.saveState()),tb.wipe(s)}return i.prototype.reset=function(){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't reset() because hash doesn't implement restoreState()");return this._inner.restoreState(this._innerKeyedState),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.clean=function(){ri.isSerializableHash(this._inner)&&this._inner.cleanSavedState(this._innerKeyedState),ri.isSerializableHash(this._outer)&&this._outer.cleanSavedState(this._outerKeyedState),this._inner.clean(),this._outer.clean()},i.prototype.update=function(e){return this._inner.update(e),this},i.prototype.finish=function(e){return this._finished?(this._outer.finish(e),this):(this._inner.finish(e),this._outer.update(e.subarray(0,this.digestLength)).finish(e),this._finished=!0,this)},i.prototype.digest=function(){var e=new Uint8Array(this.digestLength);return this.finish(e),e},i.prototype.saveState=function(){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't saveState() because hash doesn't implement it");return this._inner.saveState()},i.prototype.restoreState=function(e){if(!ri.isSerializableHash(this._inner)||!ri.isSerializableHash(this._outer))throw new Error("hmac: can't restoreState() because hash doesn't implement it");return this._inner.restoreState(e),this._outer.restoreState(this._outerKeyedState),this._finished=!1,this},i.prototype.cleanSavedState=function(e){if(!ri.isSerializableHash(this._inner))throw new Error("hmac: can't cleanSavedState() because hash doesn't implement it");this._inner.cleanSavedState(e)},i}();Rs.HMAC=_p;function rb(i,e,t){var s=new _p(i,e);s.update(t);var o=s.digest();return s.clean(),o}Rs.hmac=rb;Rs.equal=eb.equal;Object.defineProperty(yp,"__esModule",{value:!0});var _f=Rs,mf=Yr,ib=function(){function i(e,t,s,o){s===void 0&&(s=new Uint8Array(0)),this._counter=new Uint8Array(1),this._hash=e,this._info=o;var c=_f.hmac(this._hash,s,t);this._hmac=new _f.HMAC(e,c),this._buffer=new Uint8Array(this._hmac.digestLength),this._bufpos=this._buffer.length}return i.prototype._fillBuffer=function(){this._counter[0]++;var e=this._counter[0];if(e===0)throw new Error("hkdf: cannot expand more");this._hmac.reset(),e>1&&this._hmac.update(this._buffer),this._info&&this._hmac.update(this._info),this._hmac.update(this._counter),this._hmac.finish(this._buffer),this._bufpos=0},i.prototype.expand=function(e){for(var t=new Uint8Array(e),s=0;s<t.length;s++)this._bufpos===this._buffer.length&&this._fillBuffer(),t[s]=this._buffer[this._bufpos++];return t},i.prototype.clean=function(){this._hmac.clean(),mf.wipe(this._buffer),mf.wipe(this._counter),this._bufpos=0},i}(),nb=yp.HKDF=ib,sa={},oa={},aa={};Object.defineProperty(aa,"__esModule",{value:!0});aa.BrowserRandomSource=void 0;const wf=65536;let sb=class{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=wf)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,wf)));return t}};aa.BrowserRandomSource=sb;var ca={};Object.defineProperty(ca,"__esModule",{value:!0});ca.NodeRandomSource=void 0;const ob=Yr;let ab=class{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof op<"u"){const e=ap();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,ob.wipe)(t),s}};ca.NodeRandomSource=ab;Object.defineProperty(oa,"__esModule",{value:!0});oa.SystemRandomSource=void 0;const cb=aa,ub=ca;let hb=class{constructor(){if(this.isAvailable=!1,this.name="",this._source=new cb.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new ub.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}};oa.SystemRandomSource=hb;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=oa,t=Me,s=Yr;i.defaultRandomSource=new e.SystemRandomSource;function o(y,b=i.defaultRandomSource){return b.randomBytes(y)}i.randomBytes=o;function c(y=i.defaultRandomSource){const b=o(4,y),x=(0,t.readUint32LE)(b);return(0,s.wipe)(b),x}i.randomUint32=c;const d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(y,b=d,x=i.defaultRandomSource){if(b.length<2)throw new Error("randomString charset is too short");if(b.length>256)throw new Error("randomString charset is too long");let P="";const A=b.length,q=256-256%A;for(;y>0;){const z=o(Math.ceil(y*256/q),x);for(let K=0;K<z.length&&y>0;K++){const oe=z[K];oe<q&&(P+=b.charAt(oe%A),y--)}(0,s.wipe)(z)}return P}i.randomString=f;function g(y,b=d,x=i.defaultRandomSource){const P=Math.ceil(y/(Math.log(b.length)/Math.LN2));return f(P,b,x)}i.randomStringForEntropy=g})(sa);var ua={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Me,t=Yr;i.DIGEST_LENGTH=32,i.BLOCK_SIZE=64;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._state=new Int32Array(8),this._temp=new Int32Array(64),this._buffer=new Uint8Array(128),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._state[0]=1779033703,this._state[1]=3144134277,this._state[2]=1013904242,this._state[3]=2773480762,this._state[4]=1359893119,this._state[5]=2600822924,this._state[6]=528734635,this._state[7]=1541459225},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._temp),this.reset()},f.prototype.update=function(g,y){if(y===void 0&&(y=g.length),this._finished)throw new Error("SHA256: can't update because hash was finished.");var b=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<this.blockSize&&y>0;)this._buffer[this._bufferLength++]=g[b++],y--;this._bufferLength===this.blockSize&&(c(this._temp,this._state,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(b=c(this._temp,this._state,g,b,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=g[b++],y--;return this},f.prototype.finish=function(g){if(!this._finished){var y=this._bytesHashed,b=this._bufferLength,x=y/536870912|0,P=y<<3,A=y%64<56?64:128;this._buffer[b]=128;for(var q=b+1;q<A-8;q++)this._buffer[q]=0;e.writeUint32BE(x,this._buffer,A-8),e.writeUint32BE(P,this._buffer,A-4),c(this._temp,this._state,this._buffer,0,A),this._finished=!0}for(var q=0;q<this.digestLength/4;q++)e.writeUint32BE(this._state[q],g,q*4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{state:new Int32Array(this._state),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._state.set(g.state),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.state),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA256=s;var o=new Int32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]);function c(f,g,y,b,x){for(;x>=64;){for(var P=g[0],A=g[1],q=g[2],z=g[3],K=g[4],oe=g[5],C=g[6],D=g[7],I=0;I<16;I++){var N=b+I*4;f[I]=e.readUint32BE(y,N)}for(var I=16;I<64;I++){var w=f[I-2],h=(w>>>17|w<<32-17)^(w>>>19|w<<32-19)^w>>>10;w=f[I-15];var m=(w>>>7|w<<32-7)^(w>>>18|w<<32-18)^w>>>3;f[I]=(h+f[I-7]|0)+(m+f[I-16]|0)}for(var I=0;I<64;I++){var h=(((K>>>6|K<<26)^(K>>>11|K<<21)^(K>>>25|K<<7))+(K&oe^~K&C)|0)+(D+(o[I]+f[I]|0)|0)|0,m=((P>>>2|P<<32-2)^(P>>>13|P<<32-13)^(P>>>22|P<<32-22))+(P&A^P&q^A&q)|0;D=C,C=oe,oe=K,K=z+h|0,z=q,q=A,A=P,P=h+m|0}g[0]+=P,g[1]+=A,g[2]+=q,g[3]+=z,g[4]+=K,g[5]+=oe,g[6]+=C,g[7]+=D,b+=64,x-=64}return b}function d(f){var g=new s;g.update(f);var y=g.digest();return g.clean(),y}i.hash=d})(ua);var Gu={};(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.sharedKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.scalarMultBase=i.scalarMult=i.SHARED_KEY_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=void 0;const e=sa,t=Yr;i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=32,i.SHARED_KEY_LENGTH=32;function s(I){const N=new Float64Array(16);if(I)for(let w=0;w<I.length;w++)N[w]=I[w];return N}const o=new Uint8Array(32);o[0]=9;const c=s([56129,1]);function d(I){let N=1;for(let w=0;w<16;w++){let h=I[w]+N+65535;N=Math.floor(h/65536),I[w]=h-N*65536}I[0]+=N-1+37*(N-1)}function f(I,N,w){const h=~(w-1);for(let m=0;m<16;m++){const G=h&(I[m]^N[m]);I[m]^=G,N[m]^=G}}function g(I,N){const w=s(),h=s();for(let m=0;m<16;m++)h[m]=N[m];d(h),d(h),d(h);for(let m=0;m<2;m++){w[0]=h[0]-65517;for(let k=1;k<15;k++)w[k]=h[k]-65535-(w[k-1]>>16&1),w[k-1]&=65535;w[15]=h[15]-32767-(w[14]>>16&1);const G=w[15]>>16&1;w[14]&=65535,f(h,w,1-G)}for(let m=0;m<16;m++)I[2*m]=h[m]&255,I[2*m+1]=h[m]>>8}function y(I,N){for(let w=0;w<16;w++)I[w]=N[2*w]+(N[2*w+1]<<8);I[15]&=32767}function b(I,N,w){for(let h=0;h<16;h++)I[h]=N[h]+w[h]}function x(I,N,w){for(let h=0;h<16;h++)I[h]=N[h]-w[h]}function P(I,N,w){let h,m,G=0,k=0,se=0,ce=0,ge=0,U=0,H=0,le=0,te=0,W=0,ee=0,Y=0,re=0,Pe=0,ie=0,we=0,he=0,_e=0,j=0,M=0,R=0,l=0,O=0,ne=0,fe=0,Ie=0,Be=0,ke=0,Fe=0,vt=0,yt=0,je=w[0],Oe=w[1],Ue=w[2],$e=w[3],qe=w[4],Te=w[5],Le=w[6],Se=w[7],Ne=w[8],ze=w[9],xe=w[10],Ge=w[11],Ye=w[12],tt=w[13],rt=w[14],Qe=w[15];h=N[0],G+=h*je,k+=h*Oe,se+=h*Ue,ce+=h*$e,ge+=h*qe,U+=h*Te,H+=h*Le,le+=h*Se,te+=h*Ne,W+=h*ze,ee+=h*xe,Y+=h*Ge,re+=h*Ye,Pe+=h*tt,ie+=h*rt,we+=h*Qe,h=N[1],k+=h*je,se+=h*Oe,ce+=h*Ue,ge+=h*$e,U+=h*qe,H+=h*Te,le+=h*Le,te+=h*Se,W+=h*Ne,ee+=h*ze,Y+=h*xe,re+=h*Ge,Pe+=h*Ye,ie+=h*tt,we+=h*rt,he+=h*Qe,h=N[2],se+=h*je,ce+=h*Oe,ge+=h*Ue,U+=h*$e,H+=h*qe,le+=h*Te,te+=h*Le,W+=h*Se,ee+=h*Ne,Y+=h*ze,re+=h*xe,Pe+=h*Ge,ie+=h*Ye,we+=h*tt,he+=h*rt,_e+=h*Qe,h=N[3],ce+=h*je,ge+=h*Oe,U+=h*Ue,H+=h*$e,le+=h*qe,te+=h*Te,W+=h*Le,ee+=h*Se,Y+=h*Ne,re+=h*ze,Pe+=h*xe,ie+=h*Ge,we+=h*Ye,he+=h*tt,_e+=h*rt,j+=h*Qe,h=N[4],ge+=h*je,U+=h*Oe,H+=h*Ue,le+=h*$e,te+=h*qe,W+=h*Te,ee+=h*Le,Y+=h*Se,re+=h*Ne,Pe+=h*ze,ie+=h*xe,we+=h*Ge,he+=h*Ye,_e+=h*tt,j+=h*rt,M+=h*Qe,h=N[5],U+=h*je,H+=h*Oe,le+=h*Ue,te+=h*$e,W+=h*qe,ee+=h*Te,Y+=h*Le,re+=h*Se,Pe+=h*Ne,ie+=h*ze,we+=h*xe,he+=h*Ge,_e+=h*Ye,j+=h*tt,M+=h*rt,R+=h*Qe,h=N[6],H+=h*je,le+=h*Oe,te+=h*Ue,W+=h*$e,ee+=h*qe,Y+=h*Te,re+=h*Le,Pe+=h*Se,ie+=h*Ne,we+=h*ze,he+=h*xe,_e+=h*Ge,j+=h*Ye,M+=h*tt,R+=h*rt,l+=h*Qe,h=N[7],le+=h*je,te+=h*Oe,W+=h*Ue,ee+=h*$e,Y+=h*qe,re+=h*Te,Pe+=h*Le,ie+=h*Se,we+=h*Ne,he+=h*ze,_e+=h*xe,j+=h*Ge,M+=h*Ye,R+=h*tt,l+=h*rt,O+=h*Qe,h=N[8],te+=h*je,W+=h*Oe,ee+=h*Ue,Y+=h*$e,re+=h*qe,Pe+=h*Te,ie+=h*Le,we+=h*Se,he+=h*Ne,_e+=h*ze,j+=h*xe,M+=h*Ge,R+=h*Ye,l+=h*tt,O+=h*rt,ne+=h*Qe,h=N[9],W+=h*je,ee+=h*Oe,Y+=h*Ue,re+=h*$e,Pe+=h*qe,ie+=h*Te,we+=h*Le,he+=h*Se,_e+=h*Ne,j+=h*ze,M+=h*xe,R+=h*Ge,l+=h*Ye,O+=h*tt,ne+=h*rt,fe+=h*Qe,h=N[10],ee+=h*je,Y+=h*Oe,re+=h*Ue,Pe+=h*$e,ie+=h*qe,we+=h*Te,he+=h*Le,_e+=h*Se,j+=h*Ne,M+=h*ze,R+=h*xe,l+=h*Ge,O+=h*Ye,ne+=h*tt,fe+=h*rt,Ie+=h*Qe,h=N[11],Y+=h*je,re+=h*Oe,Pe+=h*Ue,ie+=h*$e,we+=h*qe,he+=h*Te,_e+=h*Le,j+=h*Se,M+=h*Ne,R+=h*ze,l+=h*xe,O+=h*Ge,ne+=h*Ye,fe+=h*tt,Ie+=h*rt,Be+=h*Qe,h=N[12],re+=h*je,Pe+=h*Oe,ie+=h*Ue,we+=h*$e,he+=h*qe,_e+=h*Te,j+=h*Le,M+=h*Se,R+=h*Ne,l+=h*ze,O+=h*xe,ne+=h*Ge,fe+=h*Ye,Ie+=h*tt,Be+=h*rt,ke+=h*Qe,h=N[13],Pe+=h*je,ie+=h*Oe,we+=h*Ue,he+=h*$e,_e+=h*qe,j+=h*Te,M+=h*Le,R+=h*Se,l+=h*Ne,O+=h*ze,ne+=h*xe,fe+=h*Ge,Ie+=h*Ye,Be+=h*tt,ke+=h*rt,Fe+=h*Qe,h=N[14],ie+=h*je,we+=h*Oe,he+=h*Ue,_e+=h*$e,j+=h*qe,M+=h*Te,R+=h*Le,l+=h*Se,O+=h*Ne,ne+=h*ze,fe+=h*xe,Ie+=h*Ge,Be+=h*Ye,ke+=h*tt,Fe+=h*rt,vt+=h*Qe,h=N[15],we+=h*je,he+=h*Oe,_e+=h*Ue,j+=h*$e,M+=h*qe,R+=h*Te,l+=h*Le,O+=h*Se,ne+=h*Ne,fe+=h*ze,Ie+=h*xe,Be+=h*Ge,ke+=h*Ye,Fe+=h*tt,vt+=h*rt,yt+=h*Qe,G+=38*he,k+=38*_e,se+=38*j,ce+=38*M,ge+=38*R,U+=38*l,H+=38*O,le+=38*ne,te+=38*fe,W+=38*Ie,ee+=38*Be,Y+=38*ke,re+=38*Fe,Pe+=38*vt,ie+=38*yt,m=1,h=G+m+65535,m=Math.floor(h/65536),G=h-m*65536,h=k+m+65535,m=Math.floor(h/65536),k=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ce+m+65535,m=Math.floor(h/65536),ce=h-m*65536,h=ge+m+65535,m=Math.floor(h/65536),ge=h-m*65536,h=U+m+65535,m=Math.floor(h/65536),U=h-m*65536,h=H+m+65535,m=Math.floor(h/65536),H=h-m*65536,h=le+m+65535,m=Math.floor(h/65536),le=h-m*65536,h=te+m+65535,m=Math.floor(h/65536),te=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=Pe+m+65535,m=Math.floor(h/65536),Pe=h-m*65536,h=ie+m+65535,m=Math.floor(h/65536),ie=h-m*65536,h=we+m+65535,m=Math.floor(h/65536),we=h-m*65536,G+=m-1+37*(m-1),m=1,h=G+m+65535,m=Math.floor(h/65536),G=h-m*65536,h=k+m+65535,m=Math.floor(h/65536),k=h-m*65536,h=se+m+65535,m=Math.floor(h/65536),se=h-m*65536,h=ce+m+65535,m=Math.floor(h/65536),ce=h-m*65536,h=ge+m+65535,m=Math.floor(h/65536),ge=h-m*65536,h=U+m+65535,m=Math.floor(h/65536),U=h-m*65536,h=H+m+65535,m=Math.floor(h/65536),H=h-m*65536,h=le+m+65535,m=Math.floor(h/65536),le=h-m*65536,h=te+m+65535,m=Math.floor(h/65536),te=h-m*65536,h=W+m+65535,m=Math.floor(h/65536),W=h-m*65536,h=ee+m+65535,m=Math.floor(h/65536),ee=h-m*65536,h=Y+m+65535,m=Math.floor(h/65536),Y=h-m*65536,h=re+m+65535,m=Math.floor(h/65536),re=h-m*65536,h=Pe+m+65535,m=Math.floor(h/65536),Pe=h-m*65536,h=ie+m+65535,m=Math.floor(h/65536),ie=h-m*65536,h=we+m+65535,m=Math.floor(h/65536),we=h-m*65536,G+=m-1+37*(m-1),I[0]=G,I[1]=k,I[2]=se,I[3]=ce,I[4]=ge,I[5]=U,I[6]=H,I[7]=le,I[8]=te,I[9]=W,I[10]=ee,I[11]=Y,I[12]=re,I[13]=Pe,I[14]=ie,I[15]=we}function A(I,N){P(I,N,N)}function q(I,N){const w=s();for(let h=0;h<16;h++)w[h]=N[h];for(let h=253;h>=0;h--)A(w,w),h!==2&&h!==4&&P(w,w,N);for(let h=0;h<16;h++)I[h]=w[h]}function z(I,N){const w=new Uint8Array(32),h=new Float64Array(80),m=s(),G=s(),k=s(),se=s(),ce=s(),ge=s();for(let te=0;te<31;te++)w[te]=I[te];w[31]=I[31]&127|64,w[0]&=248,y(h,N);for(let te=0;te<16;te++)G[te]=h[te];m[0]=se[0]=1;for(let te=254;te>=0;--te){const W=w[te>>>3]>>>(te&7)&1;f(m,G,W),f(k,se,W),b(ce,m,k),x(m,m,k),b(k,G,se),x(G,G,se),A(se,ce),A(ge,m),P(m,k,m),P(k,G,ce),b(ce,m,k),x(m,m,k),A(G,m),x(k,se,ge),P(m,k,c),b(m,m,se),P(k,k,m),P(m,se,ge),P(se,G,h),A(G,ce),f(m,G,W),f(k,se,W)}for(let te=0;te<16;te++)h[te+16]=m[te],h[te+32]=k[te],h[te+48]=G[te],h[te+64]=se[te];const U=h.subarray(32),H=h.subarray(16);q(U,U),P(H,H,U);const le=new Uint8Array(32);return g(le,H),le}i.scalarMult=z;function K(I){return z(I,o)}i.scalarMultBase=K;function oe(I){if(I.length!==i.SECRET_KEY_LENGTH)throw new Error(`x25519: seed must be ${i.SECRET_KEY_LENGTH} bytes`);const N=new Uint8Array(I);return{publicKey:K(N),secretKey:N}}i.generateKeyPairFromSeed=oe;function C(I){const N=(0,e.randomBytes)(32,I),w=oe(N);return(0,t.wipe)(N),w}i.generateKeyPair=C;function D(I,N,w=!1){if(I.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect secret key length");if(N.length!==i.PUBLIC_KEY_LENGTH)throw new Error("X25519: incorrect public key length");const h=z(I,N);if(w){let m=0;for(let G=0;G<h.length;G++)m|=h[G];if(m===0)throw new Error("X25519: invalid shared key")}return h}i.sharedKey=D})(Gu);function Wu(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function mp(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?Wu(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function bf(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=mp(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return Wu(t)}function wp(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const Ef=wp("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),kc=wp("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=mp(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),bp={utf8:Ef,"utf-8":Ef,hex:Wo.base16,latin1:kc,ascii:kc,binary:kc,...Wo};function Gr(i,e="utf8"){const t=bp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?Wu(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function Wr(i,e="utf8"){const t=bp[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}var an={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Eu=function(i,e){return Eu=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Eu(i,e)};function lb(i,e){Eu(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Su=function(){return Su=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Su.apply(this,arguments)};function fb(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function db(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(o<3?d(c):o>3?d(e,t,c):d(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function pb(i,e){return function(t,s){e(t,s,i)}}function gb(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function vb(i,e,t,s){function o(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function f(b){try{y(s.next(b))}catch(x){d(x)}}function g(b){try{y(s.throw(b))}catch(x){d(x)}}function y(b){b.done?c(b.value):o(b.value).then(f,g)}y((s=s.apply(i,e||[])).next())})}function yb(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(y){return function(b){return g([y,b])}}function g(y){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=e.call(i,t)}catch(b){y=[6,b],o=0}finally{s=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function _b(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function mb(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Iu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Ep(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],d;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){d={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(d)throw d.error}}return c}function wb(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Ep(arguments[e]));return i}function bb(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],d=0,f=c.length;d<f;d++,o++)s[o]=c[d];return s}function Is(i){return this instanceof Is?(this.v=i,this):new Is(i)}function Eb(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},d("next"),d("throw"),d("return"),o[Symbol.asyncIterator]=function(){return this},o;function d(P){s[P]&&(o[P]=function(A){return new Promise(function(q,z){c.push([P,A,q,z])>1||f(P,A)})})}function f(P,A){try{g(s[P](A))}catch(q){x(c[0][3],q)}}function g(P){P.value instanceof Is?Promise.resolve(P.value.v).then(y,b):x(c[0][2],P)}function y(P){f("next",P)}function b(P){f("throw",P)}function x(P,A){P(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function Sb(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(d){return(t=!t)?{value:Is(i[o](d)),done:o==="return"}:c?c(d):d}:c}}function Ib(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Iu=="function"?Iu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(d){return new Promise(function(f,g){d=i[c](d),o(f,g,d.done,d.value)})}}function o(c,d,f,g){Promise.resolve(g).then(function(y){c({value:y,done:f})},d)}}function Ob(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function Pb(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function xb(i){return i&&i.__esModule?i:{default:i}}function Tb(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function Nb(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const Ab=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Su},__asyncDelegator:Sb,__asyncGenerator:Eb,__asyncValues:Ib,__await:Is,__awaiter:vb,__classPrivateFieldGet:Tb,__classPrivateFieldSet:Nb,__createBinding:_b,__decorate:db,__exportStar:mb,__extends:lb,__generator:yb,__importDefault:xb,__importStar:Pb,__makeTemplateObject:Ob,__metadata:gb,__param:pb,__read:Ep,__rest:fb,__spread:wb,__spreadArrays:bb,__values:Iu},Symbol.toStringTag,{value:"Module"})),ha=zu(Ab);var Gc={},as={},Sf;function Rb(){if(Sf)return as;Sf=1,Object.defineProperty(as,"__esModule",{value:!0}),as.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return as.delay=i,as}var Zi={},Wc={},en={},If;function Cb(){return If||(If=1,Object.defineProperty(en,"__esModule",{value:!0}),en.ONE_THOUSAND=en.ONE_HUNDRED=void 0,en.ONE_HUNDRED=100,en.ONE_THOUSAND=1e3),en}var Yc={},Of;function Ub(){return Of||(Of=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(Yc)),Yc}var Pf;function Sp(){return Pf||(Pf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(Cb(),i),e.__exportStar(Ub(),i)}(Wc)),Wc}var xf;function $b(){if(xf)return Zi;xf=1,Object.defineProperty(Zi,"__esModule",{value:!0}),Zi.fromMiliseconds=Zi.toMiliseconds=void 0;const i=Sp();function e(s){return s*i.ONE_THOUSAND}Zi.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return Zi.fromMiliseconds=t,Zi}var Tf;function Lb(){return Tf||(Tf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(Rb(),i),e.__exportStar($b(),i)}(Gc)),Gc}var Rn={},Nf;function Fb(){if(Nf)return Rn;Nf=1,Object.defineProperty(Rn,"__esModule",{value:!0}),Rn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Rn.Watch=i,Rn.default=i,Rn}var Jc={},cs={},Af;function Db(){if(Af)return cs;Af=1,Object.defineProperty(cs,"__esModule",{value:!0}),cs.IWatch=void 0;class i{}return cs.IWatch=i,cs}var Rf;function Mb(){return Rf||(Rf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),ha.__exportStar(Db(),i)}(Jc)),Jc}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=ha;e.__exportStar(Lb(),i),e.__exportStar(Fb(),i),e.__exportStar(Mb(),i),e.__exportStar(Sp(),i)})(an);var dt={};Object.defineProperty(dt,"__esModule",{value:!0});dt.getLocalStorage=dt.getLocalStorageOrThrow=dt.getCrypto=dt.getCryptoOrThrow=Op=dt.getLocation=dt.getLocationOrThrow=Yu=dt.getNavigator=dt.getNavigatorOrThrow=Ip=dt.getDocument=dt.getDocumentOrThrow=dt.getFromWindowOrThrow=dt.getFromWindow=void 0;function cn(i){let e;return typeof window<"u"&&typeof window[i]<"u"&&(e=window[i]),e}dt.getFromWindow=cn;function Mn(i){const e=cn(i);if(!e)throw new Error(`${i} is not defined in Window`);return e}dt.getFromWindowOrThrow=Mn;function jb(){return Mn("document")}dt.getDocumentOrThrow=jb;function qb(){return cn("document")}var Ip=dt.getDocument=qb;function Hb(){return Mn("navigator")}dt.getNavigatorOrThrow=Hb;function Bb(){return cn("navigator")}var Yu=dt.getNavigator=Bb;function zb(){return Mn("location")}dt.getLocationOrThrow=zb;function Kb(){return cn("location")}var Op=dt.getLocation=Kb;function Vb(){return Mn("crypto")}dt.getCryptoOrThrow=Vb;function kb(){return cn("crypto")}dt.getCrypto=kb;function Gb(){return Mn("localStorage")}dt.getLocalStorageOrThrow=Gb;function Wb(){return cn("localStorage")}dt.getLocalStorage=Wb;var Ju={};Object.defineProperty(Ju,"__esModule",{value:!0});var Pp=Ju.getWindowMetadata=void 0;const Cf=dt;function Yb(){let i,e;try{i=Cf.getDocumentOrThrow(),e=Cf.getLocationOrThrow()}catch{return null}function t(){const x=i.getElementsByTagName("link"),P=[];for(let A=0;A<x.length;A++){const q=x[A],z=q.getAttribute("rel");if(z&&z.toLowerCase().indexOf("icon")>-1){const K=q.getAttribute("href");if(K)if(K.toLowerCase().indexOf("https:")===-1&&K.toLowerCase().indexOf("http:")===-1&&K.indexOf("//")!==0){let oe=e.protocol+"//"+e.host;if(K.indexOf("/")===0)oe+=K;else{const C=e.pathname.split("/");C.pop();const D=C.join("/");oe+=D+"/"+K}P.push(oe)}else if(K.indexOf("//")===0){const oe=e.protocol+K;P.push(oe)}else P.push(K)}}return P}function s(...x){const P=i.getElementsByTagName("meta");for(let A=0;A<P.length;A++){const q=P[A],z=["itemprop","property","name"].map(K=>q.getAttribute(K)).filter(K=>K?x.includes(K):!1);if(z.length&&z){const K=q.getAttribute("content");if(K)return K}}return""}function o(){let x=s("name","og:site_name","og:title","twitter:title");return x||(x=i.title),x}function c(){return s("description","og:description","twitter:description","keywords")}const d=o(),f=c(),g=e.origin,y=t();return{description:f,url:g,icons:y,name:d}}Pp=Ju.getWindowMetadata=Yb;var Os={},Jb=i=>encodeURIComponent(i).replace(/[!'()*]/g,e=>`%${e.charCodeAt(0).toString(16).toUpperCase()}`),xp="%[a-f0-9]{2}",Uf=new RegExp("("+xp+")|([^%]+?)","gi"),$f=new RegExp("("+xp+")+","gi");function Ou(i,e){try{return[decodeURIComponent(i.join(""))]}catch{}if(i.length===1)return i;e=e||1;var t=i.slice(0,e),s=i.slice(e);return Array.prototype.concat.call([],Ou(t),Ou(s))}function Qb(i){try{return decodeURIComponent(i)}catch{for(var e=i.match(Uf)||[],t=1;t<e.length;t++)i=Ou(e,t).join(""),e=i.match(Uf)||[];return i}}function Xb(i){for(var e={"%FE%FF":"��","%FF%FE":"��"},t=$f.exec(i);t;){try{e[t[0]]=decodeURIComponent(t[0])}catch{var s=Qb(t[0]);s!==t[0]&&(e[t[0]]=s)}t=$f.exec(i)}e["%C2"]="�";for(var o=Object.keys(e),c=0;c<o.length;c++){var d=o[c];i=i.replace(new RegExp(d,"g"),e[d])}return i}var Zb=function(i){if(typeof i!="string")throw new TypeError("Expected `encodedURI` to be of type `string`, got `"+typeof i+"`");try{return i=i.replace(/\+/g," "),decodeURIComponent(i)}catch{return Xb(i)}},eE=(i,e)=>{if(!(typeof i=="string"&&typeof e=="string"))throw new TypeError("Expected the arguments to be of type `string`");if(e==="")return[i];const t=i.indexOf(e);return t===-1?[i]:[i.slice(0,t),i.slice(t+e.length)]},tE=function(i,e){for(var t={},s=Object.keys(i),o=Array.isArray(e),c=0;c<s.length;c++){var d=s[c],f=i[d];(o?e.indexOf(d)!==-1:e(d,f,i))&&(t[d]=f)}return t};(function(i){const e=Jb,t=Zb,s=eE,o=tE,c=C=>C==null,d=Symbol("encodeFragmentIdentifier");function f(C){switch(C.arrayFormat){case"index":return D=>(I,N)=>{const w=I.length;return N===void 0||C.skipNull&&N===null||C.skipEmptyString&&N===""?I:N===null?[...I,[b(D,C),"[",w,"]"].join("")]:[...I,[b(D,C),"[",b(w,C),"]=",b(N,C)].join("")]};case"bracket":return D=>(I,N)=>N===void 0||C.skipNull&&N===null||C.skipEmptyString&&N===""?I:N===null?[...I,[b(D,C),"[]"].join("")]:[...I,[b(D,C),"[]=",b(N,C)].join("")];case"colon-list-separator":return D=>(I,N)=>N===void 0||C.skipNull&&N===null||C.skipEmptyString&&N===""?I:N===null?[...I,[b(D,C),":list="].join("")]:[...I,[b(D,C),":list=",b(N,C)].join("")];case"comma":case"separator":case"bracket-separator":{const D=C.arrayFormat==="bracket-separator"?"[]=":"=";return I=>(N,w)=>w===void 0||C.skipNull&&w===null||C.skipEmptyString&&w===""?N:(w=w===null?"":w,N.length===0?[[b(I,C),D,b(w,C)].join("")]:[[N,b(w,C)].join(C.arrayFormatSeparator)])}default:return D=>(I,N)=>N===void 0||C.skipNull&&N===null||C.skipEmptyString&&N===""?I:N===null?[...I,b(D,C)]:[...I,[b(D,C),"=",b(N,C)].join("")]}}function g(C){let D;switch(C.arrayFormat){case"index":return(I,N,w)=>{if(D=/\[(\d*)\]$/.exec(I),I=I.replace(/\[\d*\]$/,""),!D){w[I]=N;return}w[I]===void 0&&(w[I]={}),w[I][D[1]]=N};case"bracket":return(I,N,w)=>{if(D=/(\[\])$/.exec(I),I=I.replace(/\[\]$/,""),!D){w[I]=N;return}if(w[I]===void 0){w[I]=[N];return}w[I]=[].concat(w[I],N)};case"colon-list-separator":return(I,N,w)=>{if(D=/(:list)$/.exec(I),I=I.replace(/:list$/,""),!D){w[I]=N;return}if(w[I]===void 0){w[I]=[N];return}w[I]=[].concat(w[I],N)};case"comma":case"separator":return(I,N,w)=>{const h=typeof N=="string"&&N.includes(C.arrayFormatSeparator),m=typeof N=="string"&&!h&&x(N,C).includes(C.arrayFormatSeparator);N=m?x(N,C):N;const G=h||m?N.split(C.arrayFormatSeparator).map(k=>x(k,C)):N===null?N:x(N,C);w[I]=G};case"bracket-separator":return(I,N,w)=>{const h=/(\[\])$/.test(I);if(I=I.replace(/\[\]$/,""),!h){w[I]=N&&x(N,C);return}const m=N===null?[]:N.split(C.arrayFormatSeparator).map(G=>x(G,C));if(w[I]===void 0){w[I]=m;return}w[I]=[].concat(w[I],m)};default:return(I,N,w)=>{if(w[I]===void 0){w[I]=N;return}w[I]=[].concat(w[I],N)}}}function y(C){if(typeof C!="string"||C.length!==1)throw new TypeError("arrayFormatSeparator must be single character string")}function b(C,D){return D.encode?D.strict?e(C):encodeURIComponent(C):C}function x(C,D){return D.decode?t(C):C}function P(C){return Array.isArray(C)?C.sort():typeof C=="object"?P(Object.keys(C)).sort((D,I)=>Number(D)-Number(I)).map(D=>C[D]):C}function A(C){const D=C.indexOf("#");return D!==-1&&(C=C.slice(0,D)),C}function q(C){let D="";const I=C.indexOf("#");return I!==-1&&(D=C.slice(I)),D}function z(C){C=A(C);const D=C.indexOf("?");return D===-1?"":C.slice(D+1)}function K(C,D){return D.parseNumbers&&!Number.isNaN(Number(C))&&typeof C=="string"&&C.trim()!==""?C=Number(C):D.parseBooleans&&C!==null&&(C.toLowerCase()==="true"||C.toLowerCase()==="false")&&(C=C.toLowerCase()==="true"),C}function oe(C,D){D=Object.assign({decode:!0,sort:!0,arrayFormat:"none",arrayFormatSeparator:",",parseNumbers:!1,parseBooleans:!1},D),y(D.arrayFormatSeparator);const I=g(D),N=Object.create(null);if(typeof C!="string"||(C=C.trim().replace(/^[?#&]/,""),!C))return N;for(const w of C.split("&")){if(w==="")continue;let[h,m]=s(D.decode?w.replace(/\+/g," "):w,"=");m=m===void 0?null:["comma","separator","bracket-separator"].includes(D.arrayFormat)?m:x(m,D),I(x(h,D),m,N)}for(const w of Object.keys(N)){const h=N[w];if(typeof h=="object"&&h!==null)for(const m of Object.keys(h))h[m]=K(h[m],D);else N[w]=K(h,D)}return D.sort===!1?N:(D.sort===!0?Object.keys(N).sort():Object.keys(N).sort(D.sort)).reduce((w,h)=>{const m=N[h];return m&&typeof m=="object"&&!Array.isArray(m)?w[h]=P(m):w[h]=m,w},Object.create(null))}i.extract=z,i.parse=oe,i.stringify=(C,D)=>{if(!C)return"";D=Object.assign({encode:!0,strict:!0,arrayFormat:"none",arrayFormatSeparator:","},D),y(D.arrayFormatSeparator);const I=m=>D.skipNull&&c(C[m])||D.skipEmptyString&&C[m]==="",N=f(D),w={};for(const m of Object.keys(C))I(m)||(w[m]=C[m]);const h=Object.keys(w);return D.sort!==!1&&h.sort(D.sort),h.map(m=>{const G=C[m];return G===void 0?"":G===null?b(m,D):Array.isArray(G)?G.length===0&&D.arrayFormat==="bracket-separator"?b(m,D)+"[]":G.reduce(N(m),[]).join("&"):b(m,D)+"="+b(G,D)}).filter(m=>m.length>0).join("&")},i.parseUrl=(C,D)=>{D=Object.assign({decode:!0},D);const[I,N]=s(C,"#");return Object.assign({url:I.split("?")[0]||"",query:oe(z(C),D)},D&&D.parseFragmentIdentifier&&N?{fragmentIdentifier:x(N,D)}:{})},i.stringifyUrl=(C,D)=>{D=Object.assign({encode:!0,strict:!0,[d]:!0},D);const I=A(C.url).split("?")[0]||"",N=i.extract(C.url),w=i.parse(N,{sort:!1}),h=Object.assign(w,C.query);let m=i.stringify(h,D);m&&(m=`?${m}`);let G=q(C.url);return C.fragmentIdentifier&&(G=`#${D[d]?b(C.fragmentIdentifier,D):C.fragmentIdentifier}`),`${I}${m}${G}`},i.pick=(C,D,I)=>{I=Object.assign({parseFragmentIdentifier:!0,[d]:!1},I);const{url:N,query:w,fragmentIdentifier:h}=i.parseUrl(C,I);return i.stringifyUrl({url:N,query:o(w,D),fragmentIdentifier:h},I)},i.exclude=(C,D,I)=>{const N=Array.isArray(D)?w=>!D.includes(w):(w,h)=>!D(w,h);return i.pick(C,N,I)}})(Os);const rE={waku:{publish:"waku_publish",batchPublish:"waku_batchPublish",subscribe:"waku_subscribe",batchSubscribe:"waku_batchSubscribe",subscription:"waku_subscription",unsubscribe:"waku_unsubscribe",batchUnsubscribe:"waku_batchUnsubscribe"},irn:{publish:"irn_publish",batchPublish:"irn_batchPublish",subscribe:"irn_subscribe",batchSubscribe:"irn_batchSubscribe",subscription:"irn_subscription",unsubscribe:"irn_unsubscribe",batchUnsubscribe:"irn_batchUnsubscribe"},iridium:{publish:"iridium_publish",batchPublish:"iridium_batchPublish",subscribe:"iridium_subscribe",batchSubscribe:"iridium_batchSubscribe",subscription:"iridium_subscription",unsubscribe:"iridium_unsubscribe",batchUnsubscribe:"iridium_batchUnsubscribe"}};function iE(i,e=[]){const t=[];return Object.keys(i).forEach(s=>{if(e.length&&!e.includes(s))return;const o=i[s];t.push(...o.accounts)}),t}function Tp(i,e){return i.includes(":")?[i]:e.chains||[]}const Np="base10",ur="base16",Pu="base64pad",Qu="utf8",Ap=0,un=1,nE=0,Lf=1,xu=12,Xu=32;function sE(){const i=Gu.generateKeyPair();return{privateKey:Wr(i.secretKey,ur),publicKey:Wr(i.publicKey,ur)}}function Tu(){const i=sa.randomBytes(Xu);return Wr(i,ur)}function oE(i,e){const t=Gu.sharedKey(Gr(i,ur),Gr(e,ur)),s=new nb(ua.SHA256,t).expand(Xu);return Wr(s,ur)}function aE(i){const e=ua.hash(Gr(i,ur));return Wr(e,ur)}function Ln(i){const e=ua.hash(Gr(i,Qu));return Wr(e,ur)}function cE(i){return Gr(`${i}`,Np)}function Cs(i){return Number(Wr(i,Np))}function uE(i){const e=cE(typeof i.type<"u"?i.type:Ap);if(Cs(e)===un&&typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");const t=typeof i.senderPublicKey<"u"?Gr(i.senderPublicKey,ur):void 0,s=typeof i.iv<"u"?Gr(i.iv,ur):sa.randomBytes(xu),o=new Vu.ChaCha20Poly1305(Gr(i.symKey,ur)).seal(s,Gr(i.message,Qu));return lE({type:e,sealed:o,iv:s,senderPublicKey:t})}function hE(i){const e=new Vu.ChaCha20Poly1305(Gr(i.symKey,ur)),{sealed:t,iv:s}=Qo(i.encoded),o=e.open(s,t);if(o===null)throw new Error("Failed to decrypt");return Wr(o,Qu)}function lE(i){if(Cs(i.type)===un){if(typeof i.senderPublicKey>"u")throw new Error("Missing sender public key for type 1 envelope");return Wr(bf([i.type,i.senderPublicKey,i.iv,i.sealed]),Pu)}return Wr(bf([i.type,i.iv,i.sealed]),Pu)}function Qo(i){const e=Gr(i,Pu),t=e.slice(nE,Lf),s=Lf;if(Cs(t)===un){const f=s+Xu,g=f+xu,y=e.slice(s,f),b=e.slice(f,g),x=e.slice(g);return{type:t,sealed:x,iv:b,senderPublicKey:y}}const o=s+xu,c=e.slice(s,o),d=e.slice(o);return{type:t,sealed:d,iv:c}}function fE(i,e){const t=Qo(i);return Rp({type:Cs(t.type),senderPublicKey:typeof t.senderPublicKey<"u"?Wr(t.senderPublicKey,ur):void 0,receiverPublicKey:e==null?void 0:e.receiverPublicKey})}function Rp(i){const e=(i==null?void 0:i.type)||Ap;if(e===un){if(typeof(i==null?void 0:i.senderPublicKey)>"u")throw new Error("missing sender public key");if(typeof(i==null?void 0:i.receiverPublicKey)>"u")throw new Error("missing receiver public key")}return{type:e,senderPublicKey:i==null?void 0:i.senderPublicKey,receiverPublicKey:i==null?void 0:i.receiverPublicKey}}function Ff(i){return i.type===un&&typeof i.senderPublicKey=="string"&&typeof i.receiverPublicKey=="string"}var dE=Object.defineProperty,Df=Object.getOwnPropertySymbols,pE=Object.prototype.hasOwnProperty,gE=Object.prototype.propertyIsEnumerable,Mf=(i,e,t)=>e in i?dE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,jf=(i,e)=>{for(var t in e||(e={}))pE.call(e,t)&&Mf(i,t,e[t]);if(Df)for(var t of Df(e))gE.call(e,t)&&Mf(i,t,e[t]);return i};const vE="ReactNative",Or={reactNative:"react-native",node:"node",browser:"browser",unknown:"unknown"},yE="js";function Zu(){return typeof ot.process<"u"&&typeof ot.process.versions<"u"&&typeof ot.process.versions.node<"u"}function la(){return!Ip()&&!!Yu()&&navigator.product===vE}function Us(){return!Zu()&&!!Yu()}function $s(){return la()?Or.reactNative:Zu()?Or.node:Us()?Or.browser:Or.unknown}function _E(i,e){let t=Os.parse(i);return t=jf(jf({},t),e),i=Os.stringify(t),i}function mE(){return Pp()||{name:"",description:"",url:"",icons:[""]}}function wE(){if($s()===Or.reactNative&&typeof ot.global<"u"&&typeof(ot.global==null?void 0:ot.global.Platform)<"u"){const{OS:t,Version:s}=ot.global.Platform;return[t,s].join("-")}const i=cw();if(i===null)return"unknown";const e=i.os?i.os.replace(" ","").toLowerCase():"unknown";return i.type==="browser"?[e,i.name,i.version].join("-"):[e,i.version].join("-")}function bE(){var i;const e=$s();return e===Or.browser?[e,((i=Op())==null?void 0:i.host)||"unknown"].join(":"):e}function EE(i,e,t){const s=wE(),o=bE();return[[i,e].join("-"),[yE,t].join("-"),s,o].join("/")}function SE({protocol:i,version:e,relayUrl:t,sdkVersion:s,auth:o,projectId:c,useOnCloseEvent:d}){const f=t.split("?"),g=EE(i,e,s),y={auth:o,ua:g,projectId:c,useOnCloseEvent:d||void 0},b=_E(f[1]||"",y);return f[0]+"?"+b}function on(i,e){return i.filter(t=>e.includes(t)).length===i.length}function Cp(i){return Object.fromEntries(i.entries())}function Up(i){return new Map(Object.entries(i))}function Un(i=an.FIVE_MINUTES,e){const t=an.toMiliseconds(i||an.FIVE_MINUTES);let s,o,c;return{resolve:d=>{c&&s&&(clearTimeout(c),s(d))},reject:d=>{c&&o&&(clearTimeout(c),o(d))},done:()=>new Promise((d,f)=>{c=setTimeout(()=>{f(new Error(e))},t),s=d,o=f})}}function Ps(i,e,t){return new Promise(async(s,o)=>{const c=setTimeout(()=>o(new Error(t)),e);try{const d=await i;s(d)}catch(d){o(d)}clearTimeout(c)})}function $p(i,e){if(typeof e=="string"&&e.startsWith(`${i}:`))return e;if(i.toLowerCase()==="topic"){if(typeof e!="string")throw new Error('Value must be "string" for expirer target type: topic');return`topic:${e}`}else if(i.toLowerCase()==="id"){if(typeof e!="number")throw new Error('Value must be "number" for expirer target type: id');return`id:${e}`}throw new Error(`Unknown expirer target type: ${i}`)}function IE(i){return $p("topic",i)}function OE(i){return $p("id",i)}function Lp(i){const[e,t]=i.split(":"),s={id:void 0,topic:void 0};if(e==="topic"&&typeof t=="string")s.topic=t;else if(e==="id"&&Number.isInteger(Number(t)))s.id=Number(t);else throw new Error(`Invalid target, expected id:number or topic:string, got ${e}:${t}`);return s}function Vr(i,e){return an.fromMiliseconds((e||Date.now())+an.toMiliseconds(i))}function $i(i){return Date.now()>=an.toMiliseconds(i)}function zt(i,e){return`${i}${e?`:${e}`:""}`}function Qc(i=[],e=[]){return[...new Set([...i,...e])]}async function PE({id:i,topic:e,wcDeepLink:t}){try{if(!t)return;const s=typeof t=="string"?JSON.parse(t):t;let o=s==null?void 0:s.href;if(typeof o!="string")return;o.endsWith("/")&&(o=o.slice(0,-1));const c=`${o}/wc?requestId=${i}&sessionTopic=${e}`,d=$s();d===Or.browser?c.startsWith("https://")?window.open(c,"_blank","noreferrer noopener"):window.open(c,"_self","noreferrer noopener"):d===Or.reactNative&&typeof(ot.global==null?void 0:ot.global.Linking)<"u"&&await ot.global.Linking.openURL(c)}catch(s){console.error(s)}}const xE="irn";function Nu(i){return(i==null?void 0:i.relay)||{protocol:xE}}function Vo(i){const e=rE[i];if(typeof e>"u")throw new Error(`Relay Protocol not supported: ${i}`);return e}var TE=Object.defineProperty,qf=Object.getOwnPropertySymbols,NE=Object.prototype.hasOwnProperty,AE=Object.prototype.propertyIsEnumerable,Hf=(i,e,t)=>e in i?TE(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,RE=(i,e)=>{for(var t in e||(e={}))NE.call(e,t)&&Hf(i,t,e[t]);if(qf)for(var t of qf(e))AE.call(e,t)&&Hf(i,t,e[t]);return i};function CE(i,e="-"){const t={},s="relay"+e;return Object.keys(i).forEach(o=>{if(o.startsWith(s)){const c=o.replace(s,""),d=i[o];t[c]=d}}),t}function UE(i){const e=i.indexOf(":"),t=i.indexOf("?")!==-1?i.indexOf("?"):void 0,s=i.substring(0,e),o=i.substring(e+1,t).split("@"),c=typeof t<"u"?i.substring(t):"",d=Os.parse(c);return{protocol:s,topic:$E(o[0]),version:parseInt(o[1],10),symKey:d.symKey,relay:CE(d)}}function $E(i){return i.startsWith("//")?i.substring(2):i}function LE(i,e="-"){const t="relay",s={};return Object.keys(i).forEach(o=>{const c=t+e+o;i[o]&&(s[c]=i[o])}),s}function FE(i){return`${i.protocol}:${i.topic}@${i.version}?`+Os.stringify(RE({symKey:i.symKey},LE(i.relay)))}function jn(i){const e=[];return i.forEach(t=>{const[s,o]=t.split(":");e.push(`${s}:${o}`)}),e}function DE(i){const e=[];return Object.values(i).forEach(t=>{e.push(...jn(t.accounts))}),e}function ME(i,e){const t=[];return Object.values(i).forEach(s=>{jn(s.accounts).includes(e)&&t.push(...s.methods)}),t}function jE(i,e){const t=[];return Object.values(i).forEach(s=>{jn(s.accounts).includes(e)&&t.push(...s.events)}),t}function qE(i,e){const t=ko(i,e);if(t)throw new Error(t.message);const s={};for(const[o,c]of Object.entries(i))s[o]={methods:c.methods,events:c.events,chains:c.accounts.map(d=>`${d.split(":")[0]}:${d.split(":")[1]}`)};return s}function eh(i){return i.includes(":")}function bs(i){return eh(i)?i.split(":")[0]:i}const HE={INVALID_METHOD:{message:"Invalid method.",code:1001},INVALID_EVENT:{message:"Invalid event.",code:1002},INVALID_UPDATE_REQUEST:{message:"Invalid update request.",code:1003},INVALID_EXTEND_REQUEST:{message:"Invalid extend request.",code:1004},INVALID_SESSION_SETTLE_REQUEST:{message:"Invalid session settle request.",code:1005},UNAUTHORIZED_METHOD:{message:"Unauthorized method.",code:3001},UNAUTHORIZED_EVENT:{message:"Unauthorized event.",code:3002},UNAUTHORIZED_UPDATE_REQUEST:{message:"Unauthorized update request.",code:3003},UNAUTHORIZED_EXTEND_REQUEST:{message:"Unauthorized extend request.",code:3004},USER_REJECTED:{message:"User rejected.",code:5e3},USER_REJECTED_CHAINS:{message:"User rejected chains.",code:5001},USER_REJECTED_METHODS:{message:"User rejected methods.",code:5002},USER_REJECTED_EVENTS:{message:"User rejected events.",code:5003},UNSUPPORTED_CHAINS:{message:"Unsupported chains.",code:5100},UNSUPPORTED_METHODS:{message:"Unsupported methods.",code:5101},UNSUPPORTED_EVENTS:{message:"Unsupported events.",code:5102},UNSUPPORTED_ACCOUNTS:{message:"Unsupported accounts.",code:5103},UNSUPPORTED_NAMESPACE_KEY:{message:"Unsupported namespace key.",code:5104},USER_DISCONNECTED:{message:"User disconnected.",code:6e3},SESSION_SETTLEMENT_FAILED:{message:"Session settlement failed.",code:7e3},WC_METHOD_UNSUPPORTED:{message:"Unsupported wc_ method.",code:10001}},BE={NOT_INITIALIZED:{message:"Not initialized.",code:1},NO_MATCHING_KEY:{message:"No matching key.",code:2},RESTORE_WILL_OVERRIDE:{message:"Restore will override.",code:3},RESUBSCRIBED:{message:"Resubscribed.",code:4},MISSING_OR_INVALID:{message:"Missing or invalid.",code:5},EXPIRED:{message:"Expired.",code:6},UNKNOWN_TYPE:{message:"Unknown type.",code:7},MISMATCHED_TOPIC:{message:"Mismatched topic.",code:8},NON_CONFORMING_NAMESPACES:{message:"Non conforming namespaces.",code:9}};function ue(i,e){const{message:t,code:s}=BE[i];return{message:e?`${t} ${e}`:t,code:s}}function $t(i,e){const{message:t,code:s}=HE[i];return{message:e?`${t} ${e}`:t,code:s}}function si(i,e){return Array.isArray(i)?typeof e<"u"&&i.length?i.every(e):!0:!1}function Fn(i){return Object.getPrototypeOf(i)===Object.prototype&&Object.keys(i).length}function cr(i){return typeof i>"u"}function Wt(i,e){return e&&cr(i)?!0:typeof i=="string"&&!!i.trim().length}function th(i,e){return e&&cr(i)?!0:typeof i=="number"&&!isNaN(i)}function zE(i,e){const{requiredNamespaces:t}=e,s=Object.keys(i.namespaces),o=Object.keys(t);let c=!0;return on(o,s)?(s.forEach(d=>{const{accounts:f,methods:g,events:y}=i.namespaces[d],b=jn(f),x=t[d];(!on(Tp(d,x),b)||!on(x.methods,g)||!on(x.events,y))&&(c=!1)}),c):!1}function Xo(i){return Wt(i,!1)&&i.includes(":")?i.split(":").length===2:!1}function KE(i){if(Wt(i,!1)&&i.includes(":")){const e=i.split(":");if(e.length===3){const t=e[0]+":"+e[1];return!!e[2]&&Xo(t)}}return!1}function VE(i){if(Wt(i,!1))try{return typeof new URL(i)<"u"}catch{return!1}return!1}function kE(i){var e;return(e=i==null?void 0:i.proposer)==null?void 0:e.publicKey}function GE(i){return i==null?void 0:i.topic}function WE(i,e){let t=null;return Wt(i==null?void 0:i.publicKey,!1)||(t=ue("MISSING_OR_INVALID",`${e} controller public key should be a string`)),t}function Bf(i){let e=!0;return si(i)?i.length&&(e=i.every(t=>Wt(t,!1))):e=!1,e}function YE(i,e,t){let s=null;return si(e)&&e.length?e.forEach(o=>{s||Xo(o)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chain ${o} should be a string and conform to "namespace:chainId" format`))}):Xo(i)||(s=$t("UNSUPPORTED_CHAINS",`${t}, chains must be defined as "namespace:chainId" e.g. "eip155:1": {...} in the namespace key OR as an array of CAIP-2 chainIds e.g. eip155: { chains: ["eip155:1", "eip155:5"] }`)),s}function JE(i,e,t){let s=null;return Object.entries(i).forEach(([o,c])=>{if(s)return;const d=YE(o,Tp(o,c),`${e} ${t}`);d&&(s=d)}),s}function QE(i,e){let t=null;return si(i)?i.forEach(s=>{t||KE(s)||(t=$t("UNSUPPORTED_ACCOUNTS",`${e}, account ${s} should be a string and conform to "namespace:chainId:address" format`))}):t=$t("UNSUPPORTED_ACCOUNTS",`${e}, accounts should be an array of strings conforming to "namespace:chainId:address" format`),t}function XE(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=QE(s==null?void 0:s.accounts,`${e} namespace`);o&&(t=o)}),t}function ZE(i,e){let t=null;return Bf(i==null?void 0:i.methods)?Bf(i==null?void 0:i.events)||(t=$t("UNSUPPORTED_EVENTS",`${e}, events should be an array of strings or empty array for no events`)):t=$t("UNSUPPORTED_METHODS",`${e}, methods should be an array of strings or empty array for no methods`),t}function Fp(i,e){let t=null;return Object.values(i).forEach(s=>{if(t)return;const o=ZE(s,`${e}, namespace`);o&&(t=o)}),t}function e6(i,e,t){let s=null;if(i&&Fn(i)){const o=Fp(i,e);o&&(s=o);const c=JE(i,e,t);c&&(s=c)}else s=ue("MISSING_OR_INVALID",`${e}, ${t} should be an object with data`);return s}function ko(i,e){let t=null;if(i&&Fn(i)){const s=Fp(i,e);s&&(t=s);const o=XE(i,e);o&&(t=o)}else t=ue("MISSING_OR_INVALID",`${e}, namespaces should be an object with data`);return t}function Dp(i){return Wt(i.protocol,!0)}function t6(i,e){let t=!1;return e&&!i?t=!0:i&&si(i)&&i.length&&i.forEach(s=>{t=Dp(s)}),t}function r6(i){return typeof i=="number"}function yr(i){return typeof i<"u"&&typeof i!==null}function i6(i){return!(!i||typeof i!="object"||!i.code||!th(i.code,!1)||!i.message||!Wt(i.message,!1))}function n6(i){return!(cr(i)||!Wt(i.method,!1))}function s6(i){return!(cr(i)||cr(i.result)&&cr(i.error)||!th(i.id,!1)||!Wt(i.jsonrpc,!1))}function o6(i){return!(cr(i)||!Wt(i.name,!1))}function zf(i,e){return!(!Xo(e)||!DE(i).includes(e))}function a6(i,e,t){return Wt(t,!1)?ME(i,e).includes(t):!1}function c6(i,e,t){return Wt(t,!1)?jE(i,e).includes(t):!1}function Kf(i,e,t){let s=null;const o=u6(i),c=h6(e),d=Object.keys(o),f=Object.keys(c),g=Vf(Object.keys(i)),y=Vf(Object.keys(e)),b=g.filter(x=>!y.includes(x));return b.length&&(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces keys don't satisfy requiredNamespaces.
      Required: ${b.toString()}
      Received: ${Object.keys(e).toString()}`)),on(d,f)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces chains don't satisfy required namespaces.
      Required: ${d.toString()}
      Approved: ${f.toString()}`)),Object.keys(e).forEach(x=>{if(!x.includes(":")||s)return;const P=jn(e[x].accounts);P.includes(x)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces accounts don't satisfy namespace accounts for ${x}
        Required: ${x}
        Approved: ${P.toString()}`))}),d.forEach(x=>{s||(on(o[x].methods,c[x].methods)?on(o[x].events,c[x].events)||(s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces events don't satisfy namespace events for ${x}`)):s=ue("NON_CONFORMING_NAMESPACES",`${t} namespaces methods don't satisfy namespace methods for ${x}`))}),s}function u6(i){const e={};return Object.keys(i).forEach(t=>{var s;t.includes(":")?e[t]=i[t]:(s=i[t].chains)==null||s.forEach(o=>{e[o]={methods:i[t].methods,events:i[t].events}})}),e}function Vf(i){return[...new Set(i.map(e=>e.includes(":")?e.split(":")[0]:e))]}function h6(i){const e={};return Object.keys(i).forEach(t=>{if(t.includes(":"))e[t]=i[t];else{const s=jn(i[t].accounts);s==null||s.forEach(o=>{e[o]={accounts:i[t].accounts.filter(c=>c.includes(`${o}:`)),methods:i[t].methods,events:i[t].events}})}}),e}function l6(i,e){return th(i,!1)&&i<=e.max&&i>=e.min}function kf(){const i=$s();return new Promise(e=>{switch(i){case Or.browser:e(f6());break;case Or.reactNative:e(d6());break;case Or.node:e(p6());break;default:e(!0)}})}function f6(){return Us()&&(navigator==null?void 0:navigator.onLine)}async function d6(){if(la()&&typeof ot.global<"u"&&ot.global!=null&&ot.global.NetInfo){const i=await(ot.global==null?void 0:ot.global.NetInfo.fetch());return i==null?void 0:i.isConnected}return!0}function p6(){return!0}function g6(i){switch($s()){case Or.browser:v6(i);break;case Or.reactNative:y6(i);break}}function v6(i){Us()&&(window.addEventListener("online",()=>i(!0)),window.addEventListener("offline",()=>i(!1)))}function y6(i){var e;la()&&typeof ot.global<"u"&&ot.global!=null&&ot.global.NetInfo&&((e=ot.global)==null||e.NetInfo.addEventListener(t=>i(t==null?void 0:t.isConnected)))}const Xc={};let Ho=class{static get(e){return Xc[e]}static set(e,t){Xc[e]=t}static delete(e){delete Xc[e]}};var Zo={exports:{}};Zo.exports;(function(i,e){var t=200,s="__lodash_hash_undefined__",o=1,c=2,d=9007199254740991,f="[object Arguments]",g="[object Array]",y="[object AsyncFunction]",b="[object Boolean]",x="[object Date]",P="[object Error]",A="[object Function]",q="[object GeneratorFunction]",z="[object Map]",K="[object Number]",oe="[object Null]",C="[object Object]",D="[object Promise]",I="[object Proxy]",N="[object RegExp]",w="[object Set]",h="[object String]",m="[object Symbol]",G="[object Undefined]",k="[object WeakMap]",se="[object ArrayBuffer]",ce="[object DataView]",ge="[object Float32Array]",U="[object Float64Array]",H="[object Int8Array]",le="[object Int16Array]",te="[object Int32Array]",W="[object Uint8Array]",ee="[object Uint8ClampedArray]",Y="[object Uint16Array]",re="[object Uint32Array]",Pe=/[\\^$.*+?()[\]{}|]/g,ie=/^\[object .+?Constructor\]$/,we=/^(?:0|[1-9]\d*)$/,he={};he[ge]=he[U]=he[H]=he[le]=he[te]=he[W]=he[ee]=he[Y]=he[re]=!0,he[f]=he[g]=he[se]=he[b]=he[ce]=he[x]=he[P]=he[A]=he[z]=he[K]=he[C]=he[N]=he[w]=he[h]=he[k]=!1;var _e=typeof Ir=="object"&&Ir&&Ir.Object===Object&&Ir,j=typeof self=="object"&&self&&self.Object===Object&&self,M=_e||j||Function("return this")(),R=e&&!e.nodeType&&e,l=R&&!0&&i&&!i.nodeType&&i,O=l&&l.exports===R,ne=O&&_e.process,fe=function(){try{return ne&&ne.binding&&ne.binding("util")}catch{}}(),Ie=fe&&fe.isTypedArray;function Be(E,$){for(var X=-1,de=E==null?0:E.length,ut=0,Re=[];++X<de;){var pt=E[X];$(pt,X,E)&&(Re[ut++]=pt)}return Re}function ke(E,$){for(var X=-1,de=$.length,ut=E.length;++X<de;)E[ut+X]=$[X];return E}function Fe(E,$){for(var X=-1,de=E==null?0:E.length;++X<de;)if($(E[X],X,E))return!0;return!1}function vt(E,$){for(var X=-1,de=Array(E);++X<E;)de[X]=$(X);return de}function yt(E){return function($){return E($)}}function je(E,$){return E.has($)}function Oe(E,$){return E==null?void 0:E[$]}function Ue(E){var $=-1,X=Array(E.size);return E.forEach(function(de,ut){X[++$]=[ut,de]}),X}function $e(E,$){return function(X){return E($(X))}}function qe(E){var $=-1,X=Array(E.size);return E.forEach(function(de){X[++$]=de}),X}var Te=Array.prototype,Le=Function.prototype,Se=Object.prototype,Ne=M["__core-js_shared__"],ze=Le.toString,xe=Se.hasOwnProperty,Ge=function(){var E=/[^.]+$/.exec(Ne&&Ne.keys&&Ne.keys.IE_PROTO||"");return E?"Symbol(src)_1."+E:""}(),Ye=Se.toString,tt=RegExp("^"+ze.call(xe).replace(Pe,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),rt=O?M.Buffer:void 0,Qe=M.Symbol,tr=M.Uint8Array,hr=Se.propertyIsEnumerable,Jr=Te.splice,rr=Qe?Qe.toStringTag:void 0,oi=Object.getOwnPropertySymbols,Si=rt?rt.isBuffer:void 0,ji=$e(Object.keys,Object),St=_r(M,"DataView"),_t=_r(M,"Map"),It=_r(M,"Promise"),Ot=_r(M,"Set"),bt=_r(M,"WeakMap"),mt=_r(Object,"create"),Ft=ci(St),Dt=ci(_t),Pt=ci(It),Mt=ci(Ot),xt=ci(bt),At=Qe?Qe.prototype:void 0,Tt=At?At.valueOf:void 0;function ft(E){var $=-1,X=E==null?0:E.length;for(this.clear();++$<X;){var de=E[$];this.set(de[0],de[1])}}function jt(){this.__data__=mt?mt(null):{},this.size=0}function qt(E){var $=this.has(E)&&delete this.__data__[E];return this.size-=$?1:0,$}function ba(E){var $=this.__data__;if(mt){var X=$[E];return X===s?void 0:X}return xe.call($,E)?$[E]:void 0}function Ea(E){var $=this.__data__;return mt?$[E]!==void 0:xe.call($,E)}function Sa(E,$){var X=this.__data__;return this.size+=this.has(E)?0:1,X[E]=mt&&$===void 0?s:$,this}ft.prototype.clear=jt,ft.prototype.delete=qt,ft.prototype.get=ba,ft.prototype.has=Ea,ft.prototype.set=Sa;function Pr(E){var $=-1,X=E==null?0:E.length;for(this.clear();++$<X;){var de=E[$];this.set(de[0],de[1])}}function Ia(){this.__data__=[],this.size=0}function Oa(E){var $=this.__data__,X=qi($,E);if(X<0)return!1;var de=$.length-1;return X==de?$.pop():Jr.call($,X,1),--this.size,!0}function Pa(E){var $=this.__data__,X=qi($,E);return X<0?void 0:$[X][1]}function xa(E){return qi(this.__data__,E)>-1}function Ta(E,$){var X=this.__data__,de=qi(X,E);return de<0?(++this.size,X.push([E,$])):X[de][1]=$,this}Pr.prototype.clear=Ia,Pr.prototype.delete=Oa,Pr.prototype.get=Pa,Pr.prototype.has=xa,Pr.prototype.set=Ta;function ai(E){var $=-1,X=E==null?0:E.length;for(this.clear();++$<X;){var de=E[$];this.set(de[0],de[1])}}function ln(){this.size=0,this.__data__={hash:new ft,map:new(_t||Pr),string:new ft}}function Na(E){var $=Ii(this,E).delete(E);return this.size-=$?1:0,$}function fn(E){return Ii(this,E).get(E)}function Aa(E){return Ii(this,E).has(E)}function Ra(E,$){var X=Ii(this,E),de=X.size;return X.set(E,$),this.size+=X.size==de?0:1,this}ai.prototype.clear=ln,ai.prototype.delete=Na,ai.prototype.get=fn,ai.prototype.has=Aa,ai.prototype.set=Ra;function dn(E){var $=-1,X=E==null?0:E.length;for(this.__data__=new ai;++$<X;)this.add(E[$])}function Fs(E){return this.__data__.set(E,s),this}function Ds(E){return this.__data__.has(E)}dn.prototype.add=dn.prototype.push=Fs,dn.prototype.has=Ds;function jr(E){var $=this.__data__=new Pr(E);this.size=$.size}function Ca(){this.__data__=new Pr,this.size=0}function Ua(E){var $=this.__data__,X=$.delete(E);return this.size=$.size,X}function $a(E){return this.__data__.get(E)}function La(E){return this.__data__.has(E)}function Ms(E,$){var X=this.__data__;if(X instanceof Pr){var de=X.__data__;if(!_t||de.length<t-1)return de.push([E,$]),this.size=++X.size,this;X=this.__data__=new ai(de)}return X.set(E,$),this.size=X.size,this}jr.prototype.clear=Ca,jr.prototype.delete=Ua,jr.prototype.get=$a,jr.prototype.has=La,jr.prototype.set=Ms;function js(E,$){var X=vn(E),de=!X&&Qs(E),ut=!X&&!de&&Kn(E),Re=!X&&!de&&!ut&&eo(E),pt=X||de||ut||Re,Ht=pt?vt(E.length,String):[],Xe=Ht.length;for(var ht in E)($||xe.call(E,ht))&&!(pt&&(ht=="length"||ut&&(ht=="offset"||ht=="parent")||Re&&(ht=="buffer"||ht=="byteLength"||ht=="byteOffset")||ks(ht,Xe)))&&Ht.push(ht);return Ht}function qi(E,$){for(var X=E.length;X--;)if(Js(E[X][0],$))return X;return-1}function Bn(E,$,X){var de=$(E);return vn(E)?de:ke(de,X(E))}function Hi(E){return E==null?E===void 0?G:oe:rr&&rr in Object(E)?Ks(E):Ma(E)}function zn(E){return zi(E)&&Hi(E)==f}function Bi(E,$,X,de,ut){return E===$?!0:E==null||$==null||!zi(E)&&!zi($)?E!==E&&$!==$:qs(E,$,X,de,Bi,ut)}function qs(E,$,X,de,ut,Re){var pt=vn(E),Ht=vn($),Xe=pt?g:Qr(E),ht=Ht?g:Qr($);Xe=Xe==f?C:Xe,ht=ht==f?C:ht;var Rt=Xe==C,lr=ht==C,Bt=Xe==ht;if(Bt&&Kn(E)){if(!Kn($))return!1;pt=!0,Rt=!1}if(Bt&&!Rt)return Re||(Re=new jr),pt||eo(E)?pn(E,$,X,de,ut,Re):Da(E,$,Xe,X,de,ut,Re);if(!(X&o)){var gt=Rt&&xe.call(E,"__wrapped__"),ir=lr&&xe.call($,"__wrapped__");if(gt||ir){var qr=gt?E.value():E,xr=ir?$.value():$;return Re||(Re=new jr),ut(qr,xr,X,de,Re)}}return Bt?(Re||(Re=new jr),zs(E,$,X,de,ut,Re)):!1}function Fa(E){if(!Zs(E)||Ws(E))return!1;var $=yn(E)?tt:ie;return $.test(ci(E))}function Hs(E){return zi(E)&&Xs(E.length)&&!!he[Hi(E)]}function Bs(E){if(!Ys(E))return ji(E);var $=[];for(var X in Object(E))xe.call(E,X)&&X!="constructor"&&$.push(X);return $}function pn(E,$,X,de,ut,Re){var pt=X&o,Ht=E.length,Xe=$.length;if(Ht!=Xe&&!(pt&&Xe>Ht))return!1;var ht=Re.get(E);if(ht&&Re.get($))return ht==$;var Rt=-1,lr=!0,Bt=X&c?new dn:void 0;for(Re.set(E,$),Re.set($,E);++Rt<Ht;){var gt=E[Rt],ir=$[Rt];if(de)var qr=pt?de(ir,gt,Rt,$,E,Re):de(gt,ir,Rt,E,$,Re);if(qr!==void 0){if(qr)continue;lr=!1;break}if(Bt){if(!Fe($,function(xr,Xr){if(!je(Bt,Xr)&&(gt===xr||ut(gt,xr,X,de,Re)))return Bt.push(Xr)})){lr=!1;break}}else if(!(gt===ir||ut(gt,ir,X,de,Re))){lr=!1;break}}return Re.delete(E),Re.delete($),lr}function Da(E,$,X,de,ut,Re,pt){switch(X){case ce:if(E.byteLength!=$.byteLength||E.byteOffset!=$.byteOffset)return!1;E=E.buffer,$=$.buffer;case se:return!(E.byteLength!=$.byteLength||!Re(new tr(E),new tr($)));case b:case x:case K:return Js(+E,+$);case P:return E.name==$.name&&E.message==$.message;case N:case h:return E==$+"";case z:var Ht=Ue;case w:var Xe=de&o;if(Ht||(Ht=qe),E.size!=$.size&&!Xe)return!1;var ht=pt.get(E);if(ht)return ht==$;de|=c,pt.set(E,$);var Rt=pn(Ht(E),Ht($),de,ut,Re,pt);return pt.delete(E),Rt;case m:if(Tt)return Tt.call(E)==Tt.call($)}return!1}function zs(E,$,X,de,ut,Re){var pt=X&o,Ht=gn(E),Xe=Ht.length,ht=gn($),Rt=ht.length;if(Xe!=Rt&&!pt)return!1;for(var lr=Xe;lr--;){var Bt=Ht[lr];if(!(pt?Bt in $:xe.call($,Bt)))return!1}var gt=Re.get(E);if(gt&&Re.get($))return gt==$;var ir=!0;Re.set(E,$),Re.set($,E);for(var qr=pt;++lr<Xe;){Bt=Ht[lr];var xr=E[Bt],Xr=$[Bt];if(de)var Vn=pt?de(Xr,xr,Bt,$,E,Re):de(xr,Xr,Bt,E,$,Re);if(!(Vn===void 0?xr===Xr||ut(xr,Xr,X,de,Re):Vn)){ir=!1;break}qr||(qr=Bt=="constructor")}if(ir&&!qr){var Ki=E.constructor,kt=$.constructor;Ki!=kt&&"constructor"in E&&"constructor"in $&&!(typeof Ki=="function"&&Ki instanceof Ki&&typeof kt=="function"&&kt instanceof kt)&&(ir=!1)}return Re.delete(E),Re.delete($),ir}function gn(E){return Bn(E,Ha,Vs)}function Ii(E,$){var X=E.__data__;return Gs($)?X[typeof $=="string"?"string":"hash"]:X.map}function _r(E,$){var X=Oe(E,$);return Fa(X)?X:void 0}function Ks(E){var $=xe.call(E,rr),X=E[rr];try{E[rr]=void 0;var de=!0}catch{}var ut=Ye.call(E);return de&&($?E[rr]=X:delete E[rr]),ut}var Vs=oi?function(E){return E==null?[]:(E=Object(E),Be(oi(E),function($){return hr.call(E,$)}))}:ct,Qr=Hi;(St&&Qr(new St(new ArrayBuffer(1)))!=ce||_t&&Qr(new _t)!=z||It&&Qr(It.resolve())!=D||Ot&&Qr(new Ot)!=w||bt&&Qr(new bt)!=k)&&(Qr=function(E){var $=Hi(E),X=$==C?E.constructor:void 0,de=X?ci(X):"";if(de)switch(de){case Ft:return ce;case Dt:return z;case Pt:return D;case Mt:return w;case xt:return k}return $});function ks(E,$){return $=$??d,!!$&&(typeof E=="number"||we.test(E))&&E>-1&&E%1==0&&E<$}function Gs(E){var $=typeof E;return $=="string"||$=="number"||$=="symbol"||$=="boolean"?E!=="__proto__":E===null}function Ws(E){return!!Ge&&Ge in E}function Ys(E){var $=E&&E.constructor,X=typeof $=="function"&&$.prototype||Se;return E===X}function Ma(E){return Ye.call(E)}function ci(E){if(E!=null){try{return ze.call(E)}catch{}try{return E+""}catch{}}return""}function Js(E,$){return E===$||E!==E&&$!==$}var Qs=zn(function(){return arguments}())?zn:function(E){return zi(E)&&xe.call(E,"callee")&&!hr.call(E,"callee")},vn=Array.isArray;function ja(E){return E!=null&&Xs(E.length)&&!yn(E)}var Kn=Si||at;function qa(E,$){return Bi(E,$)}function yn(E){if(!Zs(E))return!1;var $=Hi(E);return $==A||$==q||$==y||$==I}function Xs(E){return typeof E=="number"&&E>-1&&E%1==0&&E<=d}function Zs(E){var $=typeof E;return E!=null&&($=="object"||$=="function")}function zi(E){return E!=null&&typeof E=="object"}var eo=Ie?yt(Ie):Hs;function Ha(E){return ja(E)?js(E):Bs(E)}function ct(){return[]}function at(){return!1}i.exports=qa})(Zo,Zo.exports);var _6=Zo.exports;const m6=uw(_6);var fa={};/*! *****************************************************************************
Copyright (c) Microsoft Corporation.

Permission to use, copy, modify, and/or distribute this software for any
purpose with or without fee is hereby granted.

THE SOFTWARE IS PROVIDED "AS IS" AND THE AUTHOR DISCLAIMS ALL WARRANTIES WITH
REGARD TO THIS SOFTWARE INCLUDING ALL IMPLIED WARRANTIES OF MERCHANTABILITY
AND FITNESS. IN NO EVENT SHALL THE AUTHOR BE LIABLE FOR ANY SPECIAL, DIRECT,
INDIRECT, OR CONSEQUENTIAL DAMAGES OR ANY DAMAGES WHATSOEVER RESULTING FROM
LOSS OF USE, DATA OR PROFITS, WHETHER IN AN ACTION OF CONTRACT, NEGLIGENCE OR
OTHER TORTIOUS ACTION, ARISING OUT OF OR IN CONNECTION WITH THE USE OR
PERFORMANCE OF THIS SOFTWARE.
***************************************************************************** */var Au=function(i,e){return Au=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,s){t.__proto__=s}||function(t,s){for(var o in s)s.hasOwnProperty(o)&&(t[o]=s[o])},Au(i,e)};function w6(i,e){Au(i,e);function t(){this.constructor=i}i.prototype=e===null?Object.create(e):(t.prototype=e.prototype,new t)}var Ru=function(){return Ru=Object.assign||function(e){for(var t,s=1,o=arguments.length;s<o;s++){t=arguments[s];for(var c in t)Object.prototype.hasOwnProperty.call(t,c)&&(e[c]=t[c])}return e},Ru.apply(this,arguments)};function b6(i,e){var t={};for(var s in i)Object.prototype.hasOwnProperty.call(i,s)&&e.indexOf(s)<0&&(t[s]=i[s]);if(i!=null&&typeof Object.getOwnPropertySymbols=="function")for(var o=0,s=Object.getOwnPropertySymbols(i);o<s.length;o++)e.indexOf(s[o])<0&&Object.prototype.propertyIsEnumerable.call(i,s[o])&&(t[s[o]]=i[s[o]]);return t}function E6(i,e,t,s){var o=arguments.length,c=o<3?e:s===null?s=Object.getOwnPropertyDescriptor(e,t):s,d;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")c=Reflect.decorate(i,e,t,s);else for(var f=i.length-1;f>=0;f--)(d=i[f])&&(c=(o<3?d(c):o>3?d(e,t,c):d(e,t))||c);return o>3&&c&&Object.defineProperty(e,t,c),c}function S6(i,e){return function(t,s){e(t,s,i)}}function I6(i,e){if(typeof Reflect=="object"&&typeof Reflect.metadata=="function")return Reflect.metadata(i,e)}function O6(i,e,t,s){function o(c){return c instanceof t?c:new t(function(d){d(c)})}return new(t||(t=Promise))(function(c,d){function f(b){try{y(s.next(b))}catch(x){d(x)}}function g(b){try{y(s.throw(b))}catch(x){d(x)}}function y(b){b.done?c(b.value):o(b.value).then(f,g)}y((s=s.apply(i,e||[])).next())})}function P6(i,e){var t={label:0,sent:function(){if(c[0]&1)throw c[1];return c[1]},trys:[],ops:[]},s,o,c,d;return d={next:f(0),throw:f(1),return:f(2)},typeof Symbol=="function"&&(d[Symbol.iterator]=function(){return this}),d;function f(y){return function(b){return g([y,b])}}function g(y){if(s)throw new TypeError("Generator is already executing.");for(;t;)try{if(s=1,o&&(c=y[0]&2?o.return:y[0]?o.throw||((c=o.return)&&c.call(o),0):o.next)&&!(c=c.call(o,y[1])).done)return c;switch(o=0,c&&(y=[y[0]&2,c.value]),y[0]){case 0:case 1:c=y;break;case 4:return t.label++,{value:y[1],done:!1};case 5:t.label++,o=y[1],y=[0];continue;case 7:y=t.ops.pop(),t.trys.pop();continue;default:if(c=t.trys,!(c=c.length>0&&c[c.length-1])&&(y[0]===6||y[0]===2)){t=0;continue}if(y[0]===3&&(!c||y[1]>c[0]&&y[1]<c[3])){t.label=y[1];break}if(y[0]===6&&t.label<c[1]){t.label=c[1],c=y;break}if(c&&t.label<c[2]){t.label=c[2],t.ops.push(y);break}c[2]&&t.ops.pop(),t.trys.pop();continue}y=e.call(i,t)}catch(b){y=[6,b],o=0}finally{s=c=0}if(y[0]&5)throw y[1];return{value:y[0]?y[1]:void 0,done:!0}}}function x6(i,e,t,s){s===void 0&&(s=t),i[s]=e[t]}function T6(i,e){for(var t in i)t!=="default"&&!e.hasOwnProperty(t)&&(e[t]=i[t])}function Cu(i){var e=typeof Symbol=="function"&&Symbol.iterator,t=e&&i[e],s=0;if(t)return t.call(i);if(i&&typeof i.length=="number")return{next:function(){return i&&s>=i.length&&(i=void 0),{value:i&&i[s++],done:!i}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function Mp(i,e){var t=typeof Symbol=="function"&&i[Symbol.iterator];if(!t)return i;var s=t.call(i),o,c=[],d;try{for(;(e===void 0||e-- >0)&&!(o=s.next()).done;)c.push(o.value)}catch(f){d={error:f}}finally{try{o&&!o.done&&(t=s.return)&&t.call(s)}finally{if(d)throw d.error}}return c}function N6(){for(var i=[],e=0;e<arguments.length;e++)i=i.concat(Mp(arguments[e]));return i}function A6(){for(var i=0,e=0,t=arguments.length;e<t;e++)i+=arguments[e].length;for(var s=Array(i),o=0,e=0;e<t;e++)for(var c=arguments[e],d=0,f=c.length;d<f;d++,o++)s[o]=c[d];return s}function xs(i){return this instanceof xs?(this.v=i,this):new xs(i)}function R6(i,e,t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var s=t.apply(i,e||[]),o,c=[];return o={},d("next"),d("throw"),d("return"),o[Symbol.asyncIterator]=function(){return this},o;function d(P){s[P]&&(o[P]=function(A){return new Promise(function(q,z){c.push([P,A,q,z])>1||f(P,A)})})}function f(P,A){try{g(s[P](A))}catch(q){x(c[0][3],q)}}function g(P){P.value instanceof xs?Promise.resolve(P.value.v).then(y,b):x(c[0][2],P)}function y(P){f("next",P)}function b(P){f("throw",P)}function x(P,A){P(A),c.shift(),c.length&&f(c[0][0],c[0][1])}}function C6(i){var e,t;return e={},s("next"),s("throw",function(o){throw o}),s("return"),e[Symbol.iterator]=function(){return this},e;function s(o,c){e[o]=i[o]?function(d){return(t=!t)?{value:xs(i[o](d)),done:o==="return"}:c?c(d):d}:c}}function U6(i){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=i[Symbol.asyncIterator],t;return e?e.call(i):(i=typeof Cu=="function"?Cu(i):i[Symbol.iterator](),t={},s("next"),s("throw"),s("return"),t[Symbol.asyncIterator]=function(){return this},t);function s(c){t[c]=i[c]&&function(d){return new Promise(function(f,g){d=i[c](d),o(f,g,d.done,d.value)})}}function o(c,d,f,g){Promise.resolve(g).then(function(y){c({value:y,done:f})},d)}}function $6(i,e){return Object.defineProperty?Object.defineProperty(i,"raw",{value:e}):i.raw=e,i}function L6(i){if(i&&i.__esModule)return i;var e={};if(i!=null)for(var t in i)Object.hasOwnProperty.call(i,t)&&(e[t]=i[t]);return e.default=i,e}function F6(i){return i&&i.__esModule?i:{default:i}}function D6(i,e){if(!e.has(i))throw new TypeError("attempted to get private field on non-instance");return e.get(i)}function M6(i,e,t){if(!e.has(i))throw new TypeError("attempted to set private field on non-instance");return e.set(i,t),t}const j6=Object.freeze(Object.defineProperty({__proto__:null,get __assign(){return Ru},__asyncDelegator:C6,__asyncGenerator:R6,__asyncValues:U6,__await:xs,__awaiter:O6,__classPrivateFieldGet:D6,__classPrivateFieldSet:M6,__createBinding:x6,__decorate:E6,__exportStar:T6,__extends:w6,__generator:P6,__importDefault:F6,__importStar:L6,__makeTemplateObject:$6,__metadata:I6,__param:S6,__read:Mp,__rest:b6,__spread:N6,__spreadArrays:A6,__values:Cu},Symbol.toStringTag,{value:"Module"})),Mr=zu(j6);var us={exports:{}},Gf;function q6(){return Gf||(Gf=1,function(){let i;function e(){}i=e,i.prototype.getItem=function(t){return this.hasOwnProperty(t)?String(this[t]):null},i.prototype.setItem=function(t,s){this[t]=String(s)},i.prototype.removeItem=function(t){delete this[t]},i.prototype.clear=function(){const t=this;Object.keys(t).forEach(function(s){t[s]=void 0,delete t[s]})},i.prototype.key=function(t){return t=t||0,Object.keys(this)[t]},i.prototype.__defineGetter__("length",function(){return Object.keys(this).length}),typeof Ir<"u"&&Ir.localStorage?us.exports=Ir.localStorage:typeof window<"u"&&window.localStorage?us.exports=window.localStorage:us.exports=new e}()),us.exports}var Zc={},hs={},Wf;function H6(){if(Wf)return hs;Wf=1,Object.defineProperty(hs,"__esModule",{value:!0}),hs.IKeyValueStorage=void 0;class i{}return hs.IKeyValueStorage=i,hs}var ls={},Yf;function B6(){if(Yf)return ls;Yf=1,Object.defineProperty(ls,"__esModule",{value:!0}),ls.parseEntry=void 0;const i=As;function e(t){var s;return[t[0],i.safeJsonParse((s=t[1])!==null&&s!==void 0?s:"")]}return ls.parseEntry=e,ls}var Jf;function z6(){return Jf||(Jf=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Mr;e.__exportStar(H6(),i),e.__exportStar(B6(),i)}(Zc)),Zc}Object.defineProperty(fa,"__esModule",{value:!0});fa.KeyValueStorage=void 0;const $n=Mr,Qf=As,K6=$n.__importDefault(q6()),V6=z6();class jp{constructor(){this.localStorage=K6.default}getKeys(){return $n.__awaiter(this,void 0,void 0,function*(){return Object.keys(this.localStorage)})}getEntries(){return $n.__awaiter(this,void 0,void 0,function*(){return Object.entries(this.localStorage).map(V6.parseEntry)})}getItem(e){return $n.__awaiter(this,void 0,void 0,function*(){const t=this.localStorage.getItem(e);if(t!==null)return Qf.safeJsonParse(t)})}setItem(e,t){return $n.__awaiter(this,void 0,void 0,function*(){this.localStorage.setItem(e,Qf.safeJsonStringify(t))})}removeItem(e){return $n.__awaiter(this,void 0,void 0,function*(){this.localStorage.removeItem(e)})}}fa.KeyValueStorage=jp;var k6=fa.default=jp,qn={},fs={},ye={},eu={},ds={},Xf;function G6(){if(Xf)return ds;Xf=1,Object.defineProperty(ds,"__esModule",{value:!0}),ds.delay=void 0;function i(e){return new Promise(t=>{setTimeout(()=>{t(!0)},e)})}return ds.delay=i,ds}var tn={},tu={},rn={},Zf;function W6(){return Zf||(Zf=1,Object.defineProperty(rn,"__esModule",{value:!0}),rn.ONE_THOUSAND=rn.ONE_HUNDRED=void 0,rn.ONE_HUNDRED=100,rn.ONE_THOUSAND=1e3),rn}var ru={},ed;function Y6(){return ed||(ed=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.ONE_YEAR=i.FOUR_WEEKS=i.THREE_WEEKS=i.TWO_WEEKS=i.ONE_WEEK=i.THIRTY_DAYS=i.SEVEN_DAYS=i.FIVE_DAYS=i.THREE_DAYS=i.ONE_DAY=i.TWENTY_FOUR_HOURS=i.TWELVE_HOURS=i.SIX_HOURS=i.THREE_HOURS=i.ONE_HOUR=i.SIXTY_MINUTES=i.THIRTY_MINUTES=i.TEN_MINUTES=i.FIVE_MINUTES=i.ONE_MINUTE=i.SIXTY_SECONDS=i.THIRTY_SECONDS=i.TEN_SECONDS=i.FIVE_SECONDS=i.ONE_SECOND=void 0,i.ONE_SECOND=1,i.FIVE_SECONDS=5,i.TEN_SECONDS=10,i.THIRTY_SECONDS=30,i.SIXTY_SECONDS=60,i.ONE_MINUTE=i.SIXTY_SECONDS,i.FIVE_MINUTES=i.ONE_MINUTE*5,i.TEN_MINUTES=i.ONE_MINUTE*10,i.THIRTY_MINUTES=i.ONE_MINUTE*30,i.SIXTY_MINUTES=i.ONE_MINUTE*60,i.ONE_HOUR=i.SIXTY_MINUTES,i.THREE_HOURS=i.ONE_HOUR*3,i.SIX_HOURS=i.ONE_HOUR*6,i.TWELVE_HOURS=i.ONE_HOUR*12,i.TWENTY_FOUR_HOURS=i.ONE_HOUR*24,i.ONE_DAY=i.TWENTY_FOUR_HOURS,i.THREE_DAYS=i.ONE_DAY*3,i.FIVE_DAYS=i.ONE_DAY*5,i.SEVEN_DAYS=i.ONE_DAY*7,i.THIRTY_DAYS=i.ONE_DAY*30,i.ONE_WEEK=i.SEVEN_DAYS,i.TWO_WEEKS=i.ONE_WEEK*2,i.THREE_WEEKS=i.ONE_WEEK*3,i.FOUR_WEEKS=i.ONE_WEEK*4,i.ONE_YEAR=i.ONE_DAY*365}(ru)),ru}var td;function qp(){return td||(td=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Mr;e.__exportStar(W6(),i),e.__exportStar(Y6(),i)}(tu)),tu}var rd;function J6(){if(rd)return tn;rd=1,Object.defineProperty(tn,"__esModule",{value:!0}),tn.fromMiliseconds=tn.toMiliseconds=void 0;const i=qp();function e(s){return s*i.ONE_THOUSAND}tn.toMiliseconds=e;function t(s){return Math.floor(s/i.ONE_THOUSAND)}return tn.fromMiliseconds=t,tn}var id;function Q6(){return id||(id=1,function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Mr;e.__exportStar(G6(),i),e.__exportStar(J6(),i)}(eu)),eu}var Cn={},nd;function X6(){if(nd)return Cn;nd=1,Object.defineProperty(Cn,"__esModule",{value:!0}),Cn.Watch=void 0;class i{constructor(){this.timestamps=new Map}start(t){if(this.timestamps.has(t))throw new Error(`Watch already started for label: ${t}`);this.timestamps.set(t,{started:Date.now()})}stop(t){const s=this.get(t);if(typeof s.elapsed<"u")throw new Error(`Watch already stopped for label: ${t}`);const o=Date.now()-s.started;this.timestamps.set(t,{started:s.started,elapsed:o})}get(t){const s=this.timestamps.get(t);if(typeof s>"u")throw new Error(`No timestamp found for label: ${t}`);return s}elapsed(t){const s=this.get(t);return s.elapsed||Date.now()-s.started}}return Cn.Watch=i,Cn.default=i,Cn}var iu={},ps={},sd;function Z6(){if(sd)return ps;sd=1,Object.defineProperty(ps,"__esModule",{value:!0}),ps.IWatch=void 0;class i{}return ps.IWatch=i,ps}var od;function eS(){return od||(od=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Mr.__exportStar(Z6(),i)}(iu)),iu}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Mr;e.__exportStar(Q6(),i),e.__exportStar(X6(),i),e.__exportStar(eS(),i),e.__exportStar(qp(),i)})(ye);var nu={},gs={};let tS=class{};const rS=Object.freeze(Object.defineProperty({__proto__:null,IEvents:tS},Symbol.toStringTag,{value:"Module"})),iS=zu(rS);var ad;function nS(){if(ad)return gs;ad=1,Object.defineProperty(gs,"__esModule",{value:!0}),gs.IHeartBeat=void 0;const i=iS;class e extends i.IEvents{constructor(s){super()}}return gs.IHeartBeat=e,gs}var cd;function Hp(){return cd||(cd=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Mr.__exportStar(nS(),i)}(nu)),nu}var su={},nn={},ud;function sS(){if(ud)return nn;ud=1,Object.defineProperty(nn,"__esModule",{value:!0}),nn.HEARTBEAT_EVENTS=nn.HEARTBEAT_INTERVAL=void 0;const i=ye;return nn.HEARTBEAT_INTERVAL=i.FIVE_SECONDS,nn.HEARTBEAT_EVENTS={pulse:"heartbeat_pulse"},nn}var hd;function Bp(){return hd||(hd=1,function(i){Object.defineProperty(i,"__esModule",{value:!0}),Mr.__exportStar(sS(),i)}(su)),su}var ld;function oS(){if(ld)return fs;ld=1,Object.defineProperty(fs,"__esModule",{value:!0}),fs.HeartBeat=void 0;const i=Mr,e=Dr,t=ye,s=Hp(),o=Bp();class c extends s.IHeartBeat{constructor(f){super(f),this.events=new e.EventEmitter,this.interval=o.HEARTBEAT_INTERVAL,this.interval=(f==null?void 0:f.interval)||o.HEARTBEAT_INTERVAL}static init(f){return i.__awaiter(this,void 0,void 0,function*(){const g=new c(f);return yield g.init(),g})}init(){return i.__awaiter(this,void 0,void 0,function*(){yield this.initialize()})}stop(){clearInterval(this.intervalRef)}on(f,g){this.events.on(f,g)}once(f,g){this.events.once(f,g)}off(f,g){this.events.off(f,g)}removeListener(f,g){this.events.removeListener(f,g)}initialize(){return i.__awaiter(this,void 0,void 0,function*(){this.intervalRef=setInterval(()=>this.pulse(),t.toMiliseconds(this.interval))})}pulse(){this.events.emit(o.HEARTBEAT_EVENTS.pulse)}}return fs.HeartBeat=c,fs}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Mr;e.__exportStar(oS(),i),e.__exportStar(Hp(),i),e.__exportStar(Bp(),i)})(qn);var et={},ou,fd;function aS(){if(fd)return ou;fd=1;const i=dw();ou=o;const e=N().console||{},t={mapHttpRequest:q,mapHttpResponse:q,wrapRequestSerializer:z,wrapResponseSerializer:z,wrapErrorSerializer:z,req:q,res:q,err:P};function s(w,h){return Array.isArray(w)?w.filter(function(G){return G!=="!stdSerializers.err"}):w===!0?Object.keys(h):!1}function o(w){w=w||{},w.browser=w.browser||{};const h=w.browser.transmit;if(h&&typeof h.send!="function")throw Error("pino: transmit option must have a send function");const m=w.browser.write||e;w.browser.write&&(w.browser.asObject=!0);const G=w.serializers||{},k=s(w.browser.serialize,G);let se=w.browser.serialize;Array.isArray(w.browser.serialize)&&w.browser.serialize.indexOf("!stdSerializers.err")>-1&&(se=!1);const ce=["error","fatal","warn","info","debug","trace"];typeof m=="function"&&(m.error=m.fatal=m.warn=m.info=m.debug=m.trace=m),w.enabled===!1&&(w.level="silent");const ge=w.level||"info",U=Object.create(m);U.log||(U.log=K),Object.defineProperty(U,"levelVal",{get:le}),Object.defineProperty(U,"level",{get:te,set:W});const H={transmit:h,serialize:k,asObject:w.browser.asObject,levels:ce,timestamp:A(w)};U.levels=o.levels,U.level=ge,U.setMaxListeners=U.getMaxListeners=U.emit=U.addListener=U.on=U.prependListener=U.once=U.prependOnceListener=U.removeListener=U.removeAllListeners=U.listeners=U.listenerCount=U.eventNames=U.write=U.flush=K,U.serializers=G,U._serialize=k,U._stdErrSerialize=se,U.child=ee,h&&(U._logEvent=x());function le(){return this.level==="silent"?1/0:this.levels.values[this.level]}function te(){return this._level}function W(Y){if(Y!=="silent"&&!this.levels.values[Y])throw Error("unknown level "+Y);this._level=Y,c(H,U,"error","log"),c(H,U,"fatal","error"),c(H,U,"warn","error"),c(H,U,"info","log"),c(H,U,"debug","log"),c(H,U,"trace","log")}function ee(Y,re){if(!Y)throw new Error("missing bindings for child Pino");re=re||{},k&&Y.serializers&&(re.serializers=Y.serializers);const Pe=re.serializers;if(k&&Pe){var ie=Object.assign({},G,Pe),we=w.browser.serialize===!0?Object.keys(ie):k;delete Y.serializers,g([Y],we,ie,this._stdErrSerialize)}function he(_e){this._childLevel=(_e._childLevel|0)+1,this.error=y(_e,Y,"error"),this.fatal=y(_e,Y,"fatal"),this.warn=y(_e,Y,"warn"),this.info=y(_e,Y,"info"),this.debug=y(_e,Y,"debug"),this.trace=y(_e,Y,"trace"),ie&&(this.serializers=ie,this._serialize=we),h&&(this._logEvent=x([].concat(_e._logEvent.bindings,Y)))}return he.prototype=this,new he(this)}return U}o.levels={values:{fatal:60,error:50,warn:40,info:30,debug:20,trace:10},labels:{10:"trace",20:"debug",30:"info",40:"warn",50:"error",60:"fatal"}},o.stdSerializers=t,o.stdTimeFunctions=Object.assign({},{nullTime:oe,epochTime:C,unixTime:D,isoTime:I});function c(w,h,m,G){const k=Object.getPrototypeOf(h);h[m]=h.levelVal>h.levels.values[m]?K:k[m]?k[m]:e[m]||e[G]||K,d(w,h,m)}function d(w,h,m){!w.transmit&&h[m]===K||(h[m]=function(G){return function(){const se=w.timestamp(),ce=new Array(arguments.length),ge=Object.getPrototypeOf&&Object.getPrototypeOf(this)===e?e:this;for(var U=0;U<ce.length;U++)ce[U]=arguments[U];if(w.serialize&&!w.asObject&&g(ce,this._serialize,this.serializers,this._stdErrSerialize),w.asObject?G.call(ge,f(this,m,ce,se)):G.apply(ge,ce),w.transmit){const H=w.transmit.level||h.level,le=o.levels.values[H],te=o.levels.values[m];if(te<le)return;b(this,{ts:se,methodLevel:m,methodValue:te,transmitLevel:H,transmitValue:o.levels.values[w.transmit.level||h.level],send:w.transmit.send,val:h.levelVal},ce)}}}(h[m]))}function f(w,h,m,G){w._serialize&&g(m,w._serialize,w.serializers,w._stdErrSerialize);const k=m.slice();let se=k[0];const ce={};G&&(ce.time=G),ce.level=o.levels.values[h];let ge=(w._childLevel|0)+1;if(ge<1&&(ge=1),se!==null&&typeof se=="object"){for(;ge--&&typeof k[0]=="object";)Object.assign(ce,k.shift());se=k.length?i(k.shift(),k):void 0}else typeof se=="string"&&(se=i(k.shift(),k));return se!==void 0&&(ce.msg=se),ce}function g(w,h,m,G){for(const k in w)if(G&&w[k]instanceof Error)w[k]=o.stdSerializers.err(w[k]);else if(typeof w[k]=="object"&&!Array.isArray(w[k]))for(const se in w[k])h&&h.indexOf(se)>-1&&se in m&&(w[k][se]=m[se](w[k][se]))}function y(w,h,m){return function(){const G=new Array(1+arguments.length);G[0]=h;for(var k=1;k<G.length;k++)G[k]=arguments[k-1];return w[m].apply(this,G)}}function b(w,h,m){const G=h.send,k=h.ts,se=h.methodLevel,ce=h.methodValue,ge=h.val,U=w._logEvent.bindings;g(m,w._serialize||Object.keys(w.serializers),w.serializers,w._stdErrSerialize===void 0?!0:w._stdErrSerialize),w._logEvent.ts=k,w._logEvent.messages=m.filter(function(H){return U.indexOf(H)===-1}),w._logEvent.level.label=se,w._logEvent.level.value=ce,G(se,w._logEvent,ge),w._logEvent=x(U)}function x(w){return{ts:0,messages:[],bindings:w||[],level:{label:"",value:0}}}function P(w){const h={type:w.constructor.name,msg:w.message,stack:w.stack};for(const m in w)h[m]===void 0&&(h[m]=w[m]);return h}function A(w){return typeof w.timestamp=="function"?w.timestamp:w.timestamp===!1?oe:C}function q(){return{}}function z(w){return w}function K(){}function oe(){return!1}function C(){return Date.now()}function D(){return Math.round(Date.now()/1e3)}function I(){return new Date(Date.now()).toISOString()}function N(){function w(h){return typeof h<"u"&&h}try{return typeof globalThis<"u"||Object.defineProperty(Object.prototype,"globalThis",{get:function(){return delete Object.prototype.globalThis,this.globalThis=this},configurable:!0}),globalThis}catch{return w(self)||w(window)||w(this)||{}}}return ou}var sn={},dd;function zp(){return dd||(dd=1,Object.defineProperty(sn,"__esModule",{value:!0}),sn.PINO_CUSTOM_CONTEXT_KEY=sn.PINO_LOGGER_DEFAULTS=void 0,sn.PINO_LOGGER_DEFAULTS={level:"info"},sn.PINO_CUSTOM_CONTEXT_KEY="custom_context"),sn}var ar={},pd;function cS(){if(pd)return ar;pd=1,Object.defineProperty(ar,"__esModule",{value:!0}),ar.generateChildLogger=ar.formatChildLoggerContext=ar.getLoggerContext=ar.setBrowserLoggerContext=ar.getBrowserLoggerContext=ar.getDefaultLoggerOptions=void 0;const i=zp();function e(f){return Object.assign(Object.assign({},f),{level:(f==null?void 0:f.level)||i.PINO_LOGGER_DEFAULTS.level})}ar.getDefaultLoggerOptions=e;function t(f,g=i.PINO_CUSTOM_CONTEXT_KEY){return f[g]||""}ar.getBrowserLoggerContext=t;function s(f,g,y=i.PINO_CUSTOM_CONTEXT_KEY){return f[y]=g,f}ar.setBrowserLoggerContext=s;function o(f,g=i.PINO_CUSTOM_CONTEXT_KEY){let y="";return typeof f.bindings>"u"?y=t(f,g):y=f.bindings().context||"",y}ar.getLoggerContext=o;function c(f,g,y=i.PINO_CUSTOM_CONTEXT_KEY){const b=o(f,y);return b.trim()?`${b}/${g}`:g}ar.formatChildLoggerContext=c;function d(f,g,y=i.PINO_CUSTOM_CONTEXT_KEY){const b=c(f,g,y),x=f.child({context:b});return s(x,b,y)}return ar.generateChildLogger=d,ar}(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.pino=void 0;const e=Mr,t=e.__importDefault(aS());Object.defineProperty(i,"pino",{enumerable:!0,get:function(){return t.default}}),e.__exportStar(zp(),i),e.__exportStar(cS(),i)})(et);const uS=i=>JSON.stringify(i,(e,t)=>typeof t=="bigint"?t.toString()+"n":t),hS=i=>{const e=/([\[:])?(\d{17,}|(?:[9](?:[1-9]07199254740991|0[1-9]7199254740991|00[8-9]199254740991|007[2-9]99254740991|007199[3-9]54740991|0071992[6-9]4740991|00719925[5-9]740991|007199254[8-9]40991|0071992547[5-9]0991|00719925474[1-9]991|00719925474099[2-9])))([,\}\]])/g,t=i.replace(e,'$1"$2n"$3');return JSON.parse(t,(s,o)=>typeof o=="string"&&o.match(/^\d+n$/)?BigInt(o.substring(0,o.length-1)):o)};function rh(i){if(typeof i!="string")throw new Error(`Cannot safe json parse value of type ${typeof i}`);try{return hS(i)}catch{return i}}function Ts(i){return typeof i=="string"?i:uS(i)||""}var ih={},nh={},da={},pa={};Object.defineProperty(pa,"__esModule",{value:!0});pa.BrowserRandomSource=void 0;const gd=65536;class lS{constructor(){this.isAvailable=!1,this.isInstantiated=!1;const e=typeof self<"u"?self.crypto||self.msCrypto:null;e&&e.getRandomValues!==void 0&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Browser random byte generator is not available.");const t=new Uint8Array(e);for(let s=0;s<t.length;s+=gd)this._crypto.getRandomValues(t.subarray(s,s+Math.min(t.length-s,gd)));return t}}pa.BrowserRandomSource=lS;var ga={},Hn={};Object.defineProperty(Hn,"__esModule",{value:!0});function fS(i){for(var e=0;e<i.length;e++)i[e]=0;return i}Hn.wipe=fS;Object.defineProperty(ga,"__esModule",{value:!0});ga.NodeRandomSource=void 0;const dS=Hn;class pS{constructor(){if(this.isAvailable=!1,this.isInstantiated=!1,typeof op<"u"){const e=ap();e&&e.randomBytes&&(this._crypto=e,this.isAvailable=!0,this.isInstantiated=!0)}}randomBytes(e){if(!this.isAvailable||!this._crypto)throw new Error("Node.js random byte generator is not available.");let t=this._crypto.randomBytes(e);if(t.length!==e)throw new Error("NodeRandomSource: got fewer bytes than requested");const s=new Uint8Array(e);for(let o=0;o<s.length;o++)s[o]=t[o];return(0,dS.wipe)(t),s}}ga.NodeRandomSource=pS;Object.defineProperty(da,"__esModule",{value:!0});da.SystemRandomSource=void 0;const gS=pa,vS=ga;class yS{constructor(){if(this.isAvailable=!1,this.name="",this._source=new gS.BrowserRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Browser";return}if(this._source=new vS.NodeRandomSource,this._source.isAvailable){this.isAvailable=!0,this.name="Node";return}}randomBytes(e){if(!this.isAvailable)throw new Error("System random byte generator is not available.");return this._source.randomBytes(e)}}da.SystemRandomSource=yS;var Ve={},Kp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});function e(f,g){var y=f>>>16&65535,b=f&65535,x=g>>>16&65535,P=g&65535;return b*P+(y*P+b*x<<16>>>0)|0}i.mul=Math.imul||e;function t(f,g){return f+g|0}i.add=t;function s(f,g){return f-g|0}i.sub=s;function o(f,g){return f<<g|f>>>32-g}i.rotl=o;function c(f,g){return f<<32-g|f>>>g}i.rotr=c;function d(f){return typeof f=="number"&&isFinite(f)&&Math.floor(f)===f}i.isInteger=Number.isInteger||d,i.MAX_SAFE_INTEGER=9007199254740991,i.isSafeInteger=function(f){return i.isInteger(f)&&f>=-i.MAX_SAFE_INTEGER&&f<=i.MAX_SAFE_INTEGER}})(Kp);Object.defineProperty(Ve,"__esModule",{value:!0});var Vp=Kp;function _S(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])<<16>>16}Ve.readInt16BE=_S;function mS(i,e){return e===void 0&&(e=0),(i[e+0]<<8|i[e+1])>>>0}Ve.readUint16BE=mS;function wS(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])<<16>>16}Ve.readInt16LE=wS;function bS(i,e){return e===void 0&&(e=0),(i[e+1]<<8|i[e])>>>0}Ve.readUint16LE=bS;function kp(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>8,e[t+1]=i>>>0,e}Ve.writeUint16BE=kp;Ve.writeInt16BE=kp;function Gp(i,e,t){return e===void 0&&(e=new Uint8Array(2)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e}Ve.writeUint16LE=Gp;Ve.writeInt16LE=Gp;function Uu(i,e){return e===void 0&&(e=0),i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3]}Ve.readInt32BE=Uu;function $u(i,e){return e===void 0&&(e=0),(i[e]<<24|i[e+1]<<16|i[e+2]<<8|i[e+3])>>>0}Ve.readUint32BE=$u;function Lu(i,e){return e===void 0&&(e=0),i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e]}Ve.readInt32LE=Lu;function Fu(i,e){return e===void 0&&(e=0),(i[e+3]<<24|i[e+2]<<16|i[e+1]<<8|i[e])>>>0}Ve.readUint32LE=Fu;function ea(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>24,e[t+1]=i>>>16,e[t+2]=i>>>8,e[t+3]=i>>>0,e}Ve.writeUint32BE=ea;Ve.writeInt32BE=ea;function ta(i,e,t){return e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0),e[t+0]=i>>>0,e[t+1]=i>>>8,e[t+2]=i>>>16,e[t+3]=i>>>24,e}Ve.writeUint32LE=ta;Ve.writeInt32LE=ta;function ES(i,e){e===void 0&&(e=0);var t=Uu(i,e),s=Uu(i,e+4);return t*4294967296+s-(s>>31)*4294967296}Ve.readInt64BE=ES;function SS(i,e){e===void 0&&(e=0);var t=$u(i,e),s=$u(i,e+4);return t*4294967296+s}Ve.readUint64BE=SS;function IS(i,e){e===void 0&&(e=0);var t=Lu(i,e),s=Lu(i,e+4);return s*4294967296+t-(t>>31)*4294967296}Ve.readInt64LE=IS;function OS(i,e){e===void 0&&(e=0);var t=Fu(i,e),s=Fu(i,e+4);return s*4294967296+t}Ve.readUint64LE=OS;function Wp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ea(i/4294967296>>>0,e,t),ea(i>>>0,e,t+4),e}Ve.writeUint64BE=Wp;Ve.writeInt64BE=Wp;function Yp(i,e,t){return e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0),ta(i>>>0,e,t),ta(i/4294967296>>>0,e,t+4),e}Ve.writeUint64LE=Yp;Ve.writeInt64LE=Yp;function PS(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintBE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintBE: array is too short for the given bitLength");for(var s=0,o=1,c=i/8+t-1;c>=t;c--)s+=e[c]*o,o*=256;return s}Ve.readUintBE=PS;function xS(i,e,t){if(t===void 0&&(t=0),i%8!==0)throw new Error("readUintLE supports only bitLengths divisible by 8");if(i/8>e.length-t)throw new Error("readUintLE: array is too short for the given bitLength");for(var s=0,o=1,c=t;c<t+i/8;c++)s+=e[c]*o,o*=256;return s}Ve.readUintLE=xS;function TS(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintBE supports only bitLengths divisible by 8");if(!Vp.isSafeInteger(e))throw new Error("writeUintBE value must be an integer");for(var o=1,c=i/8+s-1;c>=s;c--)t[c]=e/o&255,o*=256;return t}Ve.writeUintBE=TS;function NS(i,e,t,s){if(t===void 0&&(t=new Uint8Array(i/8)),s===void 0&&(s=0),i%8!==0)throw new Error("writeUintLE supports only bitLengths divisible by 8");if(!Vp.isSafeInteger(e))throw new Error("writeUintLE value must be an integer");for(var o=1,c=s;c<s+i/8;c++)t[c]=e/o&255,o*=256;return t}Ve.writeUintLE=NS;function AS(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e)}Ve.readFloat32BE=AS;function RS(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat32(e,!0)}Ve.readFloat32LE=RS;function CS(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e)}Ve.readFloat64BE=CS;function US(i,e){e===void 0&&(e=0);var t=new DataView(i.buffer,i.byteOffset,i.byteLength);return t.getFloat64(e,!0)}Ve.readFloat64LE=US;function $S(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i),e}Ve.writeFloat32BE=$S;function LS(i,e,t){e===void 0&&(e=new Uint8Array(4)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat32(t,i,!0),e}Ve.writeFloat32LE=LS;function FS(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i),e}Ve.writeFloat64BE=FS;function DS(i,e,t){e===void 0&&(e=new Uint8Array(8)),t===void 0&&(t=0);var s=new DataView(e.buffer,e.byteOffset,e.byteLength);return s.setFloat64(t,i,!0),e}Ve.writeFloat64LE=DS;(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.randomStringForEntropy=i.randomString=i.randomUint32=i.randomBytes=i.defaultRandomSource=void 0;const e=da,t=Ve,s=Hn;i.defaultRandomSource=new e.SystemRandomSource;function o(y,b=i.defaultRandomSource){return b.randomBytes(y)}i.randomBytes=o;function c(y=i.defaultRandomSource){const b=o(4,y),x=(0,t.readUint32LE)(b);return(0,s.wipe)(b),x}i.randomUint32=c;const d="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz";function f(y,b=d,x=i.defaultRandomSource){if(b.length<2)throw new Error("randomString charset is too short");if(b.length>256)throw new Error("randomString charset is too long");let P="";const A=b.length,q=256-256%A;for(;y>0;){const z=o(Math.ceil(y*256/q),x);for(let K=0;K<z.length&&y>0;K++){const oe=z[K];oe<q&&(P+=b.charAt(oe%A),y--)}(0,s.wipe)(z)}return P}i.randomString=f;function g(y,b=d,x=i.defaultRandomSource){const P=Math.ceil(y/(Math.log(b.length)/Math.LN2));return f(P,b,x)}i.randomStringForEntropy=g})(nh);var Jp={};(function(i){Object.defineProperty(i,"__esModule",{value:!0});var e=Ve,t=Hn;i.DIGEST_LENGTH=64,i.BLOCK_SIZE=128;var s=function(){function f(){this.digestLength=i.DIGEST_LENGTH,this.blockSize=i.BLOCK_SIZE,this._stateHi=new Int32Array(8),this._stateLo=new Int32Array(8),this._tempHi=new Int32Array(16),this._tempLo=new Int32Array(16),this._buffer=new Uint8Array(256),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this.reset()}return f.prototype._initState=function(){this._stateHi[0]=1779033703,this._stateHi[1]=3144134277,this._stateHi[2]=1013904242,this._stateHi[3]=2773480762,this._stateHi[4]=1359893119,this._stateHi[5]=2600822924,this._stateHi[6]=528734635,this._stateHi[7]=1541459225,this._stateLo[0]=4089235720,this._stateLo[1]=2227873595,this._stateLo[2]=4271175723,this._stateLo[3]=1595750129,this._stateLo[4]=2917565137,this._stateLo[5]=725511199,this._stateLo[6]=4215389547,this._stateLo[7]=327033209},f.prototype.reset=function(){return this._initState(),this._bufferLength=0,this._bytesHashed=0,this._finished=!1,this},f.prototype.clean=function(){t.wipe(this._buffer),t.wipe(this._tempHi),t.wipe(this._tempLo),this.reset()},f.prototype.update=function(g,y){if(y===void 0&&(y=g.length),this._finished)throw new Error("SHA512: can't update because hash was finished.");var b=0;if(this._bytesHashed+=y,this._bufferLength>0){for(;this._bufferLength<i.BLOCK_SIZE&&y>0;)this._buffer[this._bufferLength++]=g[b++],y--;this._bufferLength===this.blockSize&&(c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,this.blockSize),this._bufferLength=0)}for(y>=this.blockSize&&(b=c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,g,b,y),y%=this.blockSize);y>0;)this._buffer[this._bufferLength++]=g[b++],y--;return this},f.prototype.finish=function(g){if(!this._finished){var y=this._bytesHashed,b=this._bufferLength,x=y/536870912|0,P=y<<3,A=y%128<112?128:256;this._buffer[b]=128;for(var q=b+1;q<A-8;q++)this._buffer[q]=0;e.writeUint32BE(x,this._buffer,A-8),e.writeUint32BE(P,this._buffer,A-4),c(this._tempHi,this._tempLo,this._stateHi,this._stateLo,this._buffer,0,A),this._finished=!0}for(var q=0;q<this.digestLength/8;q++)e.writeUint32BE(this._stateHi[q],g,q*8),e.writeUint32BE(this._stateLo[q],g,q*8+4);return this},f.prototype.digest=function(){var g=new Uint8Array(this.digestLength);return this.finish(g),g},f.prototype.saveState=function(){if(this._finished)throw new Error("SHA256: cannot save finished state");return{stateHi:new Int32Array(this._stateHi),stateLo:new Int32Array(this._stateLo),buffer:this._bufferLength>0?new Uint8Array(this._buffer):void 0,bufferLength:this._bufferLength,bytesHashed:this._bytesHashed}},f.prototype.restoreState=function(g){return this._stateHi.set(g.stateHi),this._stateLo.set(g.stateLo),this._bufferLength=g.bufferLength,g.buffer&&this._buffer.set(g.buffer),this._bytesHashed=g.bytesHashed,this._finished=!1,this},f.prototype.cleanSavedState=function(g){t.wipe(g.stateHi),t.wipe(g.stateLo),g.buffer&&t.wipe(g.buffer),g.bufferLength=0,g.bytesHashed=0},f}();i.SHA512=s;var o=new Int32Array([1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591]);function c(f,g,y,b,x,P,A){for(var q=y[0],z=y[1],K=y[2],oe=y[3],C=y[4],D=y[5],I=y[6],N=y[7],w=b[0],h=b[1],m=b[2],G=b[3],k=b[4],se=b[5],ce=b[6],ge=b[7],U,H,le,te,W,ee,Y,re;A>=128;){for(var Pe=0;Pe<16;Pe++){var ie=8*Pe+P;f[Pe]=e.readUint32BE(x,ie),g[Pe]=e.readUint32BE(x,ie+4)}for(var Pe=0;Pe<80;Pe++){var we=q,he=z,_e=K,j=oe,M=C,R=D,l=I,O=N,ne=w,fe=h,Ie=m,Be=G,ke=k,Fe=se,vt=ce,yt=ge;if(U=N,H=ge,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=(C>>>14|k<<32-14)^(C>>>18|k<<32-18)^(k>>>41-32|C<<32-(41-32)),H=(k>>>14|C<<32-14)^(k>>>18|C<<32-18)^(C>>>41-32|k<<32-(41-32)),W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,U=C&D^~C&I,H=k&se^~k&ce,W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,U=o[Pe*2],H=o[Pe*2+1],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,U=f[Pe%16],H=g[Pe%16],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,le=Y&65535|re<<16,te=W&65535|ee<<16,U=le,H=te,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=(q>>>28|w<<32-28)^(w>>>34-32|q<<32-(34-32))^(w>>>39-32|q<<32-(39-32)),H=(w>>>28|q<<32-28)^(q>>>34-32|w<<32-(34-32))^(q>>>39-32|w<<32-(39-32)),W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,U=q&z^q&K^z&K,H=w&h^w&m^h&m,W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,O=Y&65535|re<<16,yt=W&65535|ee<<16,U=j,H=Be,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=le,H=te,W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,j=Y&65535|re<<16,Be=W&65535|ee<<16,z=we,K=he,oe=_e,C=j,D=M,I=R,N=l,q=O,h=ne,m=fe,G=Ie,k=Be,se=ke,ce=Fe,ge=vt,w=yt,Pe%16===15)for(var ie=0;ie<16;ie++)U=f[ie],H=g[ie],W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=f[(ie+9)%16],H=g[(ie+9)%16],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,le=f[(ie+1)%16],te=g[(ie+1)%16],U=(le>>>1|te<<32-1)^(le>>>8|te<<32-8)^le>>>7,H=(te>>>1|le<<32-1)^(te>>>8|le<<32-8)^(te>>>7|le<<32-7),W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,le=f[(ie+14)%16],te=g[(ie+14)%16],U=(le>>>19|te<<32-19)^(te>>>61-32|le<<32-(61-32))^le>>>6,H=(te>>>19|le<<32-19)^(le>>>61-32|te<<32-(61-32))^(te>>>6|le<<32-6),W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,f[ie]=Y&65535|re<<16,g[ie]=W&65535|ee<<16}U=q,H=w,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[0],H=b[0],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[0]=q=Y&65535|re<<16,b[0]=w=W&65535|ee<<16,U=z,H=h,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[1],H=b[1],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[1]=z=Y&65535|re<<16,b[1]=h=W&65535|ee<<16,U=K,H=m,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[2],H=b[2],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[2]=K=Y&65535|re<<16,b[2]=m=W&65535|ee<<16,U=oe,H=G,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[3],H=b[3],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[3]=oe=Y&65535|re<<16,b[3]=G=W&65535|ee<<16,U=C,H=k,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[4],H=b[4],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[4]=C=Y&65535|re<<16,b[4]=k=W&65535|ee<<16,U=D,H=se,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[5],H=b[5],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[5]=D=Y&65535|re<<16,b[5]=se=W&65535|ee<<16,U=I,H=ce,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[6],H=b[6],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[6]=I=Y&65535|re<<16,b[6]=ce=W&65535|ee<<16,U=N,H=ge,W=H&65535,ee=H>>>16,Y=U&65535,re=U>>>16,U=y[7],H=b[7],W+=H&65535,ee+=H>>>16,Y+=U&65535,re+=U>>>16,ee+=W>>>16,Y+=ee>>>16,re+=Y>>>16,y[7]=N=Y&65535|re<<16,b[7]=ge=W&65535|ee<<16,P+=128,A-=128}return P}function d(f){var g=new s;g.update(f);var y=g.digest();return g.clean(),y}i.hash=d})(Jp);(function(i){Object.defineProperty(i,"__esModule",{value:!0}),i.convertSecretKeyToX25519=i.convertPublicKeyToX25519=i.verify=i.sign=i.extractPublicKeyFromSecretKey=i.generateKeyPair=i.generateKeyPairFromSeed=i.SEED_LENGTH=i.SECRET_KEY_LENGTH=i.PUBLIC_KEY_LENGTH=i.SIGNATURE_LENGTH=void 0;const e=nh,t=Jp,s=Hn;i.SIGNATURE_LENGTH=64,i.PUBLIC_KEY_LENGTH=32,i.SECRET_KEY_LENGTH=64,i.SEED_LENGTH=32;function o(j){const M=new Float64Array(16);if(j)for(let R=0;R<j.length;R++)M[R]=j[R];return M}const c=new Uint8Array(32);c[0]=9;const d=o(),f=o([1]),g=o([30883,4953,19914,30187,55467,16705,2637,112,59544,30585,16505,36039,65139,11119,27886,20995]),y=o([61785,9906,39828,60374,45398,33411,5274,224,53552,61171,33010,6542,64743,22239,55772,9222]),b=o([54554,36645,11616,51542,42930,38181,51040,26924,56412,64982,57905,49316,21502,52590,14035,8553]),x=o([26200,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214,26214]),P=o([41136,18958,6951,50414,58488,44335,6150,12099,55207,15867,153,11085,57099,20417,9344,11139]);function A(j,M){for(let R=0;R<16;R++)j[R]=M[R]|0}function q(j){let M=1;for(let R=0;R<16;R++){let l=j[R]+M+65535;M=Math.floor(l/65536),j[R]=l-M*65536}j[0]+=M-1+37*(M-1)}function z(j,M,R){const l=~(R-1);for(let O=0;O<16;O++){const ne=l&(j[O]^M[O]);j[O]^=ne,M[O]^=ne}}function K(j,M){const R=o(),l=o();for(let O=0;O<16;O++)l[O]=M[O];q(l),q(l),q(l);for(let O=0;O<2;O++){R[0]=l[0]-65517;for(let fe=1;fe<15;fe++)R[fe]=l[fe]-65535-(R[fe-1]>>16&1),R[fe-1]&=65535;R[15]=l[15]-32767-(R[14]>>16&1);const ne=R[15]>>16&1;R[14]&=65535,z(l,R,1-ne)}for(let O=0;O<16;O++)j[2*O]=l[O]&255,j[2*O+1]=l[O]>>8}function oe(j,M){let R=0;for(let l=0;l<32;l++)R|=j[l]^M[l];return(1&R-1>>>8)-1}function C(j,M){const R=new Uint8Array(32),l=new Uint8Array(32);return K(R,j),K(l,M),oe(R,l)}function D(j){const M=new Uint8Array(32);return K(M,j),M[0]&1}function I(j,M){for(let R=0;R<16;R++)j[R]=M[2*R]+(M[2*R+1]<<8);j[15]&=32767}function N(j,M,R){for(let l=0;l<16;l++)j[l]=M[l]+R[l]}function w(j,M,R){for(let l=0;l<16;l++)j[l]=M[l]-R[l]}function h(j,M,R){let l,O,ne=0,fe=0,Ie=0,Be=0,ke=0,Fe=0,vt=0,yt=0,je=0,Oe=0,Ue=0,$e=0,qe=0,Te=0,Le=0,Se=0,Ne=0,ze=0,xe=0,Ge=0,Ye=0,tt=0,rt=0,Qe=0,tr=0,hr=0,Jr=0,rr=0,oi=0,Si=0,ji=0,St=R[0],_t=R[1],It=R[2],Ot=R[3],bt=R[4],mt=R[5],Ft=R[6],Dt=R[7],Pt=R[8],Mt=R[9],xt=R[10],At=R[11],Tt=R[12],ft=R[13],jt=R[14],qt=R[15];l=M[0],ne+=l*St,fe+=l*_t,Ie+=l*It,Be+=l*Ot,ke+=l*bt,Fe+=l*mt,vt+=l*Ft,yt+=l*Dt,je+=l*Pt,Oe+=l*Mt,Ue+=l*xt,$e+=l*At,qe+=l*Tt,Te+=l*ft,Le+=l*jt,Se+=l*qt,l=M[1],fe+=l*St,Ie+=l*_t,Be+=l*It,ke+=l*Ot,Fe+=l*bt,vt+=l*mt,yt+=l*Ft,je+=l*Dt,Oe+=l*Pt,Ue+=l*Mt,$e+=l*xt,qe+=l*At,Te+=l*Tt,Le+=l*ft,Se+=l*jt,Ne+=l*qt,l=M[2],Ie+=l*St,Be+=l*_t,ke+=l*It,Fe+=l*Ot,vt+=l*bt,yt+=l*mt,je+=l*Ft,Oe+=l*Dt,Ue+=l*Pt,$e+=l*Mt,qe+=l*xt,Te+=l*At,Le+=l*Tt,Se+=l*ft,Ne+=l*jt,ze+=l*qt,l=M[3],Be+=l*St,ke+=l*_t,Fe+=l*It,vt+=l*Ot,yt+=l*bt,je+=l*mt,Oe+=l*Ft,Ue+=l*Dt,$e+=l*Pt,qe+=l*Mt,Te+=l*xt,Le+=l*At,Se+=l*Tt,Ne+=l*ft,ze+=l*jt,xe+=l*qt,l=M[4],ke+=l*St,Fe+=l*_t,vt+=l*It,yt+=l*Ot,je+=l*bt,Oe+=l*mt,Ue+=l*Ft,$e+=l*Dt,qe+=l*Pt,Te+=l*Mt,Le+=l*xt,Se+=l*At,Ne+=l*Tt,ze+=l*ft,xe+=l*jt,Ge+=l*qt,l=M[5],Fe+=l*St,vt+=l*_t,yt+=l*It,je+=l*Ot,Oe+=l*bt,Ue+=l*mt,$e+=l*Ft,qe+=l*Dt,Te+=l*Pt,Le+=l*Mt,Se+=l*xt,Ne+=l*At,ze+=l*Tt,xe+=l*ft,Ge+=l*jt,Ye+=l*qt,l=M[6],vt+=l*St,yt+=l*_t,je+=l*It,Oe+=l*Ot,Ue+=l*bt,$e+=l*mt,qe+=l*Ft,Te+=l*Dt,Le+=l*Pt,Se+=l*Mt,Ne+=l*xt,ze+=l*At,xe+=l*Tt,Ge+=l*ft,Ye+=l*jt,tt+=l*qt,l=M[7],yt+=l*St,je+=l*_t,Oe+=l*It,Ue+=l*Ot,$e+=l*bt,qe+=l*mt,Te+=l*Ft,Le+=l*Dt,Se+=l*Pt,Ne+=l*Mt,ze+=l*xt,xe+=l*At,Ge+=l*Tt,Ye+=l*ft,tt+=l*jt,rt+=l*qt,l=M[8],je+=l*St,Oe+=l*_t,Ue+=l*It,$e+=l*Ot,qe+=l*bt,Te+=l*mt,Le+=l*Ft,Se+=l*Dt,Ne+=l*Pt,ze+=l*Mt,xe+=l*xt,Ge+=l*At,Ye+=l*Tt,tt+=l*ft,rt+=l*jt,Qe+=l*qt,l=M[9],Oe+=l*St,Ue+=l*_t,$e+=l*It,qe+=l*Ot,Te+=l*bt,Le+=l*mt,Se+=l*Ft,Ne+=l*Dt,ze+=l*Pt,xe+=l*Mt,Ge+=l*xt,Ye+=l*At,tt+=l*Tt,rt+=l*ft,Qe+=l*jt,tr+=l*qt,l=M[10],Ue+=l*St,$e+=l*_t,qe+=l*It,Te+=l*Ot,Le+=l*bt,Se+=l*mt,Ne+=l*Ft,ze+=l*Dt,xe+=l*Pt,Ge+=l*Mt,Ye+=l*xt,tt+=l*At,rt+=l*Tt,Qe+=l*ft,tr+=l*jt,hr+=l*qt,l=M[11],$e+=l*St,qe+=l*_t,Te+=l*It,Le+=l*Ot,Se+=l*bt,Ne+=l*mt,ze+=l*Ft,xe+=l*Dt,Ge+=l*Pt,Ye+=l*Mt,tt+=l*xt,rt+=l*At,Qe+=l*Tt,tr+=l*ft,hr+=l*jt,Jr+=l*qt,l=M[12],qe+=l*St,Te+=l*_t,Le+=l*It,Se+=l*Ot,Ne+=l*bt,ze+=l*mt,xe+=l*Ft,Ge+=l*Dt,Ye+=l*Pt,tt+=l*Mt,rt+=l*xt,Qe+=l*At,tr+=l*Tt,hr+=l*ft,Jr+=l*jt,rr+=l*qt,l=M[13],Te+=l*St,Le+=l*_t,Se+=l*It,Ne+=l*Ot,ze+=l*bt,xe+=l*mt,Ge+=l*Ft,Ye+=l*Dt,tt+=l*Pt,rt+=l*Mt,Qe+=l*xt,tr+=l*At,hr+=l*Tt,Jr+=l*ft,rr+=l*jt,oi+=l*qt,l=M[14],Le+=l*St,Se+=l*_t,Ne+=l*It,ze+=l*Ot,xe+=l*bt,Ge+=l*mt,Ye+=l*Ft,tt+=l*Dt,rt+=l*Pt,Qe+=l*Mt,tr+=l*xt,hr+=l*At,Jr+=l*Tt,rr+=l*ft,oi+=l*jt,Si+=l*qt,l=M[15],Se+=l*St,Ne+=l*_t,ze+=l*It,xe+=l*Ot,Ge+=l*bt,Ye+=l*mt,tt+=l*Ft,rt+=l*Dt,Qe+=l*Pt,tr+=l*Mt,hr+=l*xt,Jr+=l*At,rr+=l*Tt,oi+=l*ft,Si+=l*jt,ji+=l*qt,ne+=38*Ne,fe+=38*ze,Ie+=38*xe,Be+=38*Ge,ke+=38*Ye,Fe+=38*tt,vt+=38*rt,yt+=38*Qe,je+=38*tr,Oe+=38*hr,Ue+=38*Jr,$e+=38*rr,qe+=38*oi,Te+=38*Si,Le+=38*ji,O=1,l=ne+O+65535,O=Math.floor(l/65536),ne=l-O*65536,l=fe+O+65535,O=Math.floor(l/65536),fe=l-O*65536,l=Ie+O+65535,O=Math.floor(l/65536),Ie=l-O*65536,l=Be+O+65535,O=Math.floor(l/65536),Be=l-O*65536,l=ke+O+65535,O=Math.floor(l/65536),ke=l-O*65536,l=Fe+O+65535,O=Math.floor(l/65536),Fe=l-O*65536,l=vt+O+65535,O=Math.floor(l/65536),vt=l-O*65536,l=yt+O+65535,O=Math.floor(l/65536),yt=l-O*65536,l=je+O+65535,O=Math.floor(l/65536),je=l-O*65536,l=Oe+O+65535,O=Math.floor(l/65536),Oe=l-O*65536,l=Ue+O+65535,O=Math.floor(l/65536),Ue=l-O*65536,l=$e+O+65535,O=Math.floor(l/65536),$e=l-O*65536,l=qe+O+65535,O=Math.floor(l/65536),qe=l-O*65536,l=Te+O+65535,O=Math.floor(l/65536),Te=l-O*65536,l=Le+O+65535,O=Math.floor(l/65536),Le=l-O*65536,l=Se+O+65535,O=Math.floor(l/65536),Se=l-O*65536,ne+=O-1+37*(O-1),O=1,l=ne+O+65535,O=Math.floor(l/65536),ne=l-O*65536,l=fe+O+65535,O=Math.floor(l/65536),fe=l-O*65536,l=Ie+O+65535,O=Math.floor(l/65536),Ie=l-O*65536,l=Be+O+65535,O=Math.floor(l/65536),Be=l-O*65536,l=ke+O+65535,O=Math.floor(l/65536),ke=l-O*65536,l=Fe+O+65535,O=Math.floor(l/65536),Fe=l-O*65536,l=vt+O+65535,O=Math.floor(l/65536),vt=l-O*65536,l=yt+O+65535,O=Math.floor(l/65536),yt=l-O*65536,l=je+O+65535,O=Math.floor(l/65536),je=l-O*65536,l=Oe+O+65535,O=Math.floor(l/65536),Oe=l-O*65536,l=Ue+O+65535,O=Math.floor(l/65536),Ue=l-O*65536,l=$e+O+65535,O=Math.floor(l/65536),$e=l-O*65536,l=qe+O+65535,O=Math.floor(l/65536),qe=l-O*65536,l=Te+O+65535,O=Math.floor(l/65536),Te=l-O*65536,l=Le+O+65535,O=Math.floor(l/65536),Le=l-O*65536,l=Se+O+65535,O=Math.floor(l/65536),Se=l-O*65536,ne+=O-1+37*(O-1),j[0]=ne,j[1]=fe,j[2]=Ie,j[3]=Be,j[4]=ke,j[5]=Fe,j[6]=vt,j[7]=yt,j[8]=je,j[9]=Oe,j[10]=Ue,j[11]=$e,j[12]=qe,j[13]=Te,j[14]=Le,j[15]=Se}function m(j,M){h(j,M,M)}function G(j,M){const R=o();let l;for(l=0;l<16;l++)R[l]=M[l];for(l=253;l>=0;l--)m(R,R),l!==2&&l!==4&&h(R,R,M);for(l=0;l<16;l++)j[l]=R[l]}function k(j,M){const R=o();let l;for(l=0;l<16;l++)R[l]=M[l];for(l=250;l>=0;l--)m(R,R),l!==1&&h(R,R,M);for(l=0;l<16;l++)j[l]=R[l]}function se(j,M){const R=o(),l=o(),O=o(),ne=o(),fe=o(),Ie=o(),Be=o(),ke=o(),Fe=o();w(R,j[1],j[0]),w(Fe,M[1],M[0]),h(R,R,Fe),N(l,j[0],j[1]),N(Fe,M[0],M[1]),h(l,l,Fe),h(O,j[3],M[3]),h(O,O,y),h(ne,j[2],M[2]),N(ne,ne,ne),w(fe,l,R),w(Ie,ne,O),N(Be,ne,O),N(ke,l,R),h(j[0],fe,Ie),h(j[1],ke,Be),h(j[2],Be,Ie),h(j[3],fe,ke)}function ce(j,M,R){for(let l=0;l<4;l++)z(j[l],M[l],R)}function ge(j,M){const R=o(),l=o(),O=o();G(O,M[2]),h(R,M[0],O),h(l,M[1],O),K(j,l),j[31]^=D(R)<<7}function U(j,M,R){A(j[0],d),A(j[1],f),A(j[2],f),A(j[3],d);for(let l=255;l>=0;--l){const O=R[l/8|0]>>(l&7)&1;ce(j,M,O),se(M,j),se(j,j),ce(j,M,O)}}function H(j,M){const R=[o(),o(),o(),o()];A(R[0],b),A(R[1],x),A(R[2],f),h(R[3],b,x),U(j,R,M)}function le(j){if(j.length!==i.SEED_LENGTH)throw new Error(`ed25519: seed must be ${i.SEED_LENGTH} bytes`);const M=(0,t.hash)(j);M[0]&=248,M[31]&=127,M[31]|=64;const R=new Uint8Array(32),l=[o(),o(),o(),o()];H(l,M),ge(R,l);const O=new Uint8Array(64);return O.set(j),O.set(R,32),{publicKey:R,secretKey:O}}i.generateKeyPairFromSeed=le;function te(j){const M=(0,e.randomBytes)(32,j),R=le(M);return(0,s.wipe)(M),R}i.generateKeyPair=te;function W(j){if(j.length!==i.SECRET_KEY_LENGTH)throw new Error(`ed25519: secret key must be ${i.SECRET_KEY_LENGTH} bytes`);return new Uint8Array(j.subarray(32))}i.extractPublicKeyFromSecretKey=W;const ee=new Float64Array([237,211,245,92,26,99,18,88,214,156,247,162,222,249,222,20,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,16]);function Y(j,M){let R,l,O,ne;for(l=63;l>=32;--l){for(R=0,O=l-32,ne=l-12;O<ne;++O)M[O]+=R-16*M[l]*ee[O-(l-32)],R=Math.floor((M[O]+128)/256),M[O]-=R*256;M[O]+=R,M[l]=0}for(R=0,O=0;O<32;O++)M[O]+=R-(M[31]>>4)*ee[O],R=M[O]>>8,M[O]&=255;for(O=0;O<32;O++)M[O]-=R*ee[O];for(l=0;l<32;l++)M[l+1]+=M[l]>>8,j[l]=M[l]&255}function re(j){const M=new Float64Array(64);for(let R=0;R<64;R++)M[R]=j[R];for(let R=0;R<64;R++)j[R]=0;Y(j,M)}function Pe(j,M){const R=new Float64Array(64),l=[o(),o(),o(),o()],O=(0,t.hash)(j.subarray(0,32));O[0]&=248,O[31]&=127,O[31]|=64;const ne=new Uint8Array(64);ne.set(O.subarray(32),32);const fe=new t.SHA512;fe.update(ne.subarray(32)),fe.update(M);const Ie=fe.digest();fe.clean(),re(Ie),H(l,Ie),ge(ne,l),fe.reset(),fe.update(ne.subarray(0,32)),fe.update(j.subarray(32)),fe.update(M);const Be=fe.digest();re(Be);for(let ke=0;ke<32;ke++)R[ke]=Ie[ke];for(let ke=0;ke<32;ke++)for(let Fe=0;Fe<32;Fe++)R[ke+Fe]+=Be[ke]*O[Fe];return Y(ne.subarray(32),R),ne}i.sign=Pe;function ie(j,M){const R=o(),l=o(),O=o(),ne=o(),fe=o(),Ie=o(),Be=o();return A(j[2],f),I(j[1],M),m(O,j[1]),h(ne,O,g),w(O,O,j[2]),N(ne,j[2],ne),m(fe,ne),m(Ie,fe),h(Be,Ie,fe),h(R,Be,O),h(R,R,ne),k(R,R),h(R,R,O),h(R,R,ne),h(R,R,ne),h(j[0],R,ne),m(l,j[0]),h(l,l,ne),C(l,O)&&h(j[0],j[0],P),m(l,j[0]),h(l,l,ne),C(l,O)?-1:(D(j[0])===M[31]>>7&&w(j[0],d,j[0]),h(j[3],j[0],j[1]),0)}function we(j,M,R){const l=new Uint8Array(32),O=[o(),o(),o(),o()],ne=[o(),o(),o(),o()];if(R.length!==i.SIGNATURE_LENGTH)throw new Error(`ed25519: signature must be ${i.SIGNATURE_LENGTH} bytes`);if(ie(ne,j))return!1;const fe=new t.SHA512;fe.update(R.subarray(0,32)),fe.update(j),fe.update(M);const Ie=fe.digest();return re(Ie),U(O,ne,Ie),H(ne,R.subarray(32)),se(O,ne),ge(l,O),!oe(R,l)}i.verify=we;function he(j){let M=[o(),o(),o(),o()];if(ie(M,j))throw new Error("Ed25519: invalid public key");let R=o(),l=o(),O=M[1];N(R,f,O),w(l,f,O),G(l,l),h(R,R,l);let ne=new Uint8Array(32);return K(ne,R),ne}i.convertPublicKeyToX25519=he;function _e(j){const M=(0,t.hash)(j.subarray(0,32));M[0]&=248,M[31]&=127,M[31]|=64;const R=new Uint8Array(M.subarray(0,32));return(0,s.wipe)(M),R}i.convertSecretKeyToX25519=_e})(ih);const MS="EdDSA",jS="JWT",Qp=".",Xp="base64url",qS="utf8",HS="utf8",BS=":",zS="did",KS="key",vd="base58btc",VS="z",kS="K36",GS=32;function sh(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function Zp(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?sh(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function WS(i,e){e||(e=i.reduce((o,c)=>o+c.length,0));const t=Zp(e);let s=0;for(const o of i)t.set(o,s),s+=o.length;return sh(t)}function eg(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const yd=eg("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),au=eg("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=Zp(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),tg={utf8:yd,"utf-8":yd,hex:Wo.base16,latin1:au,ascii:au,binary:au,...Wo};function va(i,e="utf8"){const t=tg[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?globalThis.Buffer.from(i.buffer,i.byteOffset,i.byteLength).toString("utf8"):t.encoder.encode(i).substring(1)}function oh(i,e="utf8"){const t=tg[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?sh(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}function ra(i){return va(oh(Ts(i),qS),Xp)}function rg(i){const e=oh(kS,vd),t=VS+va(WS([e,i]),vd);return[zS,KS,t].join(BS)}function YS(i){return va(i,Xp)}function JS(i){return oh([ra(i.header),ra(i.payload)].join(Qp),HS)}function QS(i){return[ra(i.header),ra(i.payload),YS(i.signature)].join(Qp)}function _d(i=nh.randomBytes(GS)){return ih.generateKeyPairFromSeed(i)}async function XS(i,e,t,s,o=ye.fromMiliseconds(Date.now())){const c={alg:MS,typ:jS},d=rg(s.publicKey),f=o+t,g={iss:d,sub:i,aud:e,iat:o,exp:f},y=JS({header:c,payload:g}),b=ih.sign(s.secretKey,y);return QS({header:c,payload:g,signature:b})}const ZS="PARSE_ERROR",e2="INVALID_REQUEST",t2="METHOD_NOT_FOUND",r2="INVALID_PARAMS",ig="INTERNAL_ERROR",ah="SERVER_ERROR",i2=[-32700,-32600,-32601,-32602,-32603],Ss={[ZS]:{code:-32700,message:"Parse error"},[e2]:{code:-32600,message:"Invalid Request"},[t2]:{code:-32601,message:"Method not found"},[r2]:{code:-32602,message:"Invalid params"},[ig]:{code:-32603,message:"Internal error"},[ah]:{code:-32e3,message:"Server error"}},ng=ah;function n2(i){return i2.includes(i)}function md(i){return Object.keys(Ss).includes(i)?Ss[i]:Ss[ng]}function s2(i){const e=Object.values(Ss).find(t=>t.code===i);return e||Ss[ng]}function sg(i,e,t){return i.message.includes("getaddrinfo ENOTFOUND")||i.message.includes("connect ECONNREFUSED")?new Error(`Unavailable ${t} RPC url at ${e}`):i}var og={},_i={},wd;function o2(){if(wd)return _i;wd=1,Object.defineProperty(_i,"__esModule",{value:!0}),_i.isBrowserCryptoAvailable=_i.getSubtleCrypto=_i.getBrowerCrypto=void 0;function i(){return(Ir===null||Ir===void 0?void 0:Ir.crypto)||(Ir===null||Ir===void 0?void 0:Ir.msCrypto)||{}}_i.getBrowerCrypto=i;function e(){const s=i();return s.subtle||s.webkitSubtle}_i.getSubtleCrypto=e;function t(){return!!i()&&!!e()}return _i.isBrowserCryptoAvailable=t,_i}var mi={},bd;function a2(){if(bd)return mi;bd=1,Object.defineProperty(mi,"__esModule",{value:!0}),mi.isBrowser=mi.isNode=mi.isReactNative=void 0;function i(){return typeof document>"u"&&typeof navigator<"u"&&navigator.product==="ReactNative"}mi.isReactNative=i;function e(){return typeof ot.process<"u"&&typeof ot.process.versions<"u"&&typeof ot.process.versions.node<"u"}mi.isNode=e;function t(){return!i()&&!e()}return mi.isBrowser=t,mi}(function(i){Object.defineProperty(i,"__esModule",{value:!0});const e=Mr;e.__exportStar(o2(),i),e.__exportStar(a2(),i)})(og);function ch(i=3){const e=Date.now()*Math.pow(10,i),t=Math.floor(Math.random()*Math.pow(10,i));return e+t}function ag(i=6){return BigInt(ch(i))}function Ns(i,e,t){return{id:t||ch(),jsonrpc:"2.0",method:i,params:e}}function uh(i,e){return{id:i,jsonrpc:"2.0",result:e}}function ya(i,e,t){return{id:i,jsonrpc:"2.0",error:c2(e,t)}}function c2(i,e){return typeof i>"u"?md(ig):(typeof i=="string"&&(i=Object.assign(Object.assign({},md(ah)),{message:i})),typeof e<"u"&&(i.data=e),n2(i.code)&&(i=s2(i.code)),i)}class u2{}class h2 extends u2{constructor(){super()}}class l2 extends h2{constructor(e){super()}}const f2="^https?:",d2="^wss?:";function p2(i){const e=i.match(new RegExp(/^\w+:/,"gi"));if(!(!e||!e.length))return e[0]}function cg(i,e){const t=p2(i);return typeof t>"u"?!1:new RegExp(e).test(t)}function Ed(i){return cg(i,f2)}function Sd(i){return cg(i,d2)}function g2(i){return new RegExp("wss?://localhost(:d{2,5})?").test(i)}function ug(i){return typeof i=="object"&&"id"in i&&"jsonrpc"in i&&i.jsonrpc==="2.0"}function hh(i){return ug(i)&&"method"in i}function _a(i){return ug(i)&&(Ei(i)||kr(i))}function Ei(i){return"result"in i}function kr(i){return"error"in i}class Di extends l2{constructor(e){super(e),this.events=new Dr.EventEmitter,this.hasRegisteredEventListeners=!1,this.connection=this.setConnection(e),this.connection.connected&&this.registerEventListeners()}async connect(e=this.connection){await this.open(e)}async disconnect(){await this.close()}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async request(e,t){return this.requestStrict(Ns(e.method,e.params||[],e.id||ag().toString()),t)}async requestStrict(e,t){return new Promise(async(s,o)=>{if(!this.connection.connected)try{await this.open()}catch(c){o(c)}this.events.on(`${e.id}`,c=>{kr(c)?o(c.error):s(c.result)});try{await this.connection.send(e,t)}catch(c){o(c)}})}setConnection(e=this.connection){return e}onPayload(e){this.events.emit("payload",e),_a(e)?this.events.emit(`${e.id}`,e):this.events.emit("message",{type:e.method,data:e.params})}onClose(e){e&&e.code===3e3&&this.events.emit("error",new Error(`WebSocket connection closed abnormally with code: ${e.code} ${e.reason?`(${e.reason})`:""}`)),this.events.emit("disconnect")}async open(e=this.connection){this.connection===e&&this.connection.connected||(this.connection.connected&&this.close(),typeof e=="string"&&(await this.connection.open(e),e=this.connection),this.connection=this.setConnection(e),await this.connection.open(),this.registerEventListeners(),this.events.emit("connect"))}async close(){await this.connection.close()}registerEventListeners(){this.hasRegisteredEventListeners||(this.connection.on("payload",e=>this.onPayload(e)),this.connection.on("close",e=>this.onClose(e)),this.connection.on("error",e=>this.events.emit("error",e)),this.connection.on("register_error",e=>this.onClose()),this.hasRegisteredEventListeners=!0)}}const v2=()=>typeof WebSocket<"u"?WebSocket:typeof ot.global<"u"&&typeof ot.global.WebSocket<"u"?ot.global.WebSocket:typeof window<"u"&&typeof window.WebSocket<"u"?window.WebSocket:typeof self<"u"&&typeof self.WebSocket<"u"?self.WebSocket:require("ws"),y2=()=>typeof WebSocket<"u"||typeof ot.global<"u"&&typeof ot.global.WebSocket<"u"||typeof window<"u"&&typeof window.WebSocket<"u"||typeof self<"u"&&typeof self.WebSocket<"u",Id=i=>i.split("?")[0],Od=10,_2=v2();class m2{constructor(e){if(this.url=e,this.events=new Dr.EventEmitter,this.registering=!1,!Sd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);this.url=e}get connected(){return typeof this.socket<"u"}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){return new Promise((e,t)=>{if(typeof this.socket>"u"){t(new Error("Connection already closed"));return}this.socket.onclose=s=>{this.onClose(s),e()},this.socket.close()})}async send(e,t){typeof this.socket>"u"&&(this.socket=await this.register());try{this.socket.send(Ts(e))}catch(s){this.onError(e.id,s)}}register(e=this.url){if(!Sd(e))throw new Error(`Provided URL is not compatible with WebSocket connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.socket>"u")return o(new Error("WebSocket connection is missing or invalid"));s(this.socket)})})}return this.url=e,this.registering=!0,new Promise((t,s)=>{const o=og.isReactNative()?void 0:{rejectUnauthorized:!g2(e)},c=new _2(e,[],o);y2()?c.onerror=d=>{const f=d;s(this.emitError(f.error))}:c.on("error",d=>{s(this.emitError(d))}),c.onopen=()=>{this.onOpen(c),t(c)}})}onOpen(e){e.onmessage=t=>this.onPayload(t),e.onclose=t=>this.onClose(t),this.socket=e,this.registering=!1,this.events.emit("open")}onClose(e){this.socket=void 0,this.registering=!1,this.events.emit("close",e)}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?rh(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ya(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return sg(e,Id(t),"WS")}resetMaxListeners(){this.events.getMaxListeners()>Od&&this.events.setMaxListeners(Od)}emitError(e){const t=this.parseError(new Error((e==null?void 0:e.message)||`WebSocket connection failed for host: ${Id(this.url)}`));return this.events.emit("register_error",t),t}}function w2(i,e){if(i.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),s=0;s<t.length;s++)t[s]=255;for(var o=0;o<i.length;o++){var c=i.charAt(o),d=c.charCodeAt(0);if(t[d]!==255)throw new TypeError(c+" is ambiguous");t[d]=o}var f=i.length,g=i.charAt(0),y=Math.log(f)/Math.log(256),b=Math.log(256)/Math.log(f);function x(q){if(q instanceof Uint8Array||(ArrayBuffer.isView(q)?q=new Uint8Array(q.buffer,q.byteOffset,q.byteLength):Array.isArray(q)&&(q=Uint8Array.from(q))),!(q instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(q.length===0)return"";for(var z=0,K=0,oe=0,C=q.length;oe!==C&&q[oe]===0;)oe++,z++;for(var D=(C-oe)*b+1>>>0,I=new Uint8Array(D);oe!==C;){for(var N=q[oe],w=0,h=D-1;(N!==0||w<K)&&h!==-1;h--,w++)N+=256*I[h]>>>0,I[h]=N%f>>>0,N=N/f>>>0;if(N!==0)throw new Error("Non-zero carry");K=w,oe++}for(var m=D-K;m!==D&&I[m]===0;)m++;for(var G=g.repeat(z);m<D;++m)G+=i.charAt(I[m]);return G}function P(q){if(typeof q!="string")throw new TypeError("Expected String");if(q.length===0)return new Uint8Array;var z=0;if(q[z]!==" "){for(var K=0,oe=0;q[z]===g;)K++,z++;for(var C=(q.length-z)*y+1>>>0,D=new Uint8Array(C);q[z];){var I=t[q.charCodeAt(z)];if(I===255)return;for(var N=0,w=C-1;(I!==0||N<oe)&&w!==-1;w--,N++)I+=f*D[w]>>>0,D[w]=I%256>>>0,I=I/256>>>0;if(I!==0)throw new Error("Non-zero carry");oe=N,z++}if(q[z]!==" "){for(var h=C-oe;h!==C&&D[h]===0;)h++;for(var m=new Uint8Array(K+(C-h)),G=K;h!==C;)m[G++]=D[h++];return m}}}function A(q){var z=P(q);if(z)return z;throw new Error(`Non-${e} character`)}return{encode:x,decodeUnsafe:P,decode:A}}var b2=w2,E2=b2;const hg=i=>{if(i instanceof Uint8Array&&i.constructor.name==="Uint8Array")return i;if(i instanceof ArrayBuffer)return new Uint8Array(i);if(ArrayBuffer.isView(i))return new Uint8Array(i.buffer,i.byteOffset,i.byteLength);throw new Error("Unknown type, must be binary type")},S2=i=>new TextEncoder().encode(i),I2=i=>new TextDecoder().decode(i);class O2{constructor(e,t,s){this.name=e,this.prefix=t,this.baseEncode=s}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}}class P2{constructor(e,t,s){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=s}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return lg(this,e)}}class x2{constructor(e){this.decoders=e}or(e){return lg(this,e)}decode(e){const t=e[0],s=this.decoders[t];if(s)return s.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}}const lg=(i,e)=>new x2({...i.decoders||{[i.prefix]:i},...e.decoders||{[e.prefix]:e}});class T2{constructor(e,t,s,o){this.name=e,this.prefix=t,this.baseEncode=s,this.baseDecode=o,this.encoder=new O2(e,t,s),this.decoder=new P2(e,t,o)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}}const ma=({name:i,prefix:e,encode:t,decode:s})=>new T2(i,e,t,s),Ls=({prefix:i,name:e,alphabet:t})=>{const{encode:s,decode:o}=E2(t,e);return ma({prefix:i,name:e,encode:s,decode:c=>hg(o(c))})},N2=(i,e,t,s)=>{const o={};for(let b=0;b<e.length;++b)o[e[b]]=b;let c=i.length;for(;i[c-1]==="=";)--c;const d=new Uint8Array(c*t/8|0);let f=0,g=0,y=0;for(let b=0;b<c;++b){const x=o[i[b]];if(x===void 0)throw new SyntaxError(`Non-${s} character`);g=g<<t|x,f+=t,f>=8&&(f-=8,d[y++]=255&g>>f)}if(f>=t||255&g<<8-f)throw new SyntaxError("Unexpected end of data");return d},A2=(i,e,t)=>{const s=e[e.length-1]==="=",o=(1<<t)-1;let c="",d=0,f=0;for(let g=0;g<i.length;++g)for(f=f<<8|i[g],d+=8;d>t;)d-=t,c+=e[o&f>>d];if(d&&(c+=e[o&f<<t-d]),s)for(;c.length*t&7;)c+="=";return c},Jt=({name:i,prefix:e,bitsPerChar:t,alphabet:s})=>ma({prefix:e,name:i,encode(o){return A2(o,s,t)},decode(o){return N2(o,s,t,i)}}),R2=ma({prefix:"\0",name:"identity",encode:i=>I2(i),decode:i=>S2(i)});var C2=Object.freeze({__proto__:null,identity:R2});const U2=Jt({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var $2=Object.freeze({__proto__:null,base2:U2});const L2=Jt({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var F2=Object.freeze({__proto__:null,base8:L2});const D2=Ls({prefix:"9",name:"base10",alphabet:"0123456789"});var M2=Object.freeze({__proto__:null,base10:D2});const j2=Jt({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),q2=Jt({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var H2=Object.freeze({__proto__:null,base16:j2,base16upper:q2});const B2=Jt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),z2=Jt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),K2=Jt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),V2=Jt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),k2=Jt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),G2=Jt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),W2=Jt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Y2=Jt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),J2=Jt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var Q2=Object.freeze({__proto__:null,base32:B2,base32upper:z2,base32pad:K2,base32padupper:V2,base32hex:k2,base32hexupper:G2,base32hexpad:W2,base32hexpadupper:Y2,base32z:J2});const X2=Ls({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),Z2=Ls({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var eI=Object.freeze({__proto__:null,base36:X2,base36upper:Z2});const tI=Ls({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),rI=Ls({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var iI=Object.freeze({__proto__:null,base58btc:tI,base58flickr:rI});const nI=Jt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),sI=Jt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),oI=Jt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),aI=Jt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var cI=Object.freeze({__proto__:null,base64:nI,base64pad:sI,base64url:oI,base64urlpad:aI});const fg=Array.from("🚀🪐☄🛰🌌🌑🌒🌓🌔🌕🌖🌗🌘🌍🌏🌎🐉☀💻🖥💾💿😂❤😍🤣😊🙏💕😭😘👍😅👏😁🔥🥰💔💖💙😢🤔😆🙄💪😉☺👌🤗💜😔😎😇🌹🤦🎉💞✌✨🤷😱😌🌸🙌😋💗💚😏💛🙂💓🤩😄😀🖤😃💯🙈👇🎶😒🤭❣😜💋👀😪😑💥🙋😞😩😡🤪👊🥳😥🤤👉💃😳✋😚😝😴🌟😬🙃🍀🌷😻😓⭐✅🥺🌈😈🤘💦✔😣🏃💐☹🎊💘😠☝😕🌺🎂🌻😐🖕💝🙊😹🗣💫💀👑🎵🤞😛🔴😤🌼😫⚽🤙☕🏆🤫👈😮🙆🍻🍃🐶💁😲🌿🧡🎁⚡🌞🎈❌✊👋😰🤨😶🤝🚶💰🍓💢🤟🙁🚨💨🤬✈🎀🍺🤓😙💟🌱😖👶🥴▶➡❓💎💸⬇😨🌚🦋😷🕺⚠🙅😟😵👎🤲🤠🤧📌🔵💅🧐🐾🍒😗🤑🌊🤯🐷☎💧😯💆👆🎤🙇🍑❄🌴💣🐸💌📍🥀🤢👅💡💩👐📸👻🤐🤮🎼🥵🚩🍎🍊👼💍📣🥂"),uI=fg.reduce((i,e,t)=>(i[t]=e,i),[]),hI=fg.reduce((i,e,t)=>(i[e.codePointAt(0)]=t,i),[]);function lI(i){return i.reduce((e,t)=>(e+=uI[t],e),"")}function fI(i){const e=[];for(const t of i){const s=hI[t.codePointAt(0)];if(s===void 0)throw new Error(`Non-base256emoji character: ${t}`);e.push(s)}return new Uint8Array(e)}const dI=ma({prefix:"🚀",name:"base256emoji",encode:lI,decode:fI});var pI=Object.freeze({__proto__:null,base256emoji:dI}),gI=dg,Pd=128,vI=127,yI=~vI,_I=Math.pow(2,31);function dg(i,e,t){e=e||[],t=t||0;for(var s=t;i>=_I;)e[t++]=i&255|Pd,i/=128;for(;i&yI;)e[t++]=i&255|Pd,i>>>=7;return e[t]=i|0,dg.bytes=t-s+1,e}var mI=Du,wI=128,xd=127;function Du(i,s){var t=0,s=s||0,o=0,c=s,d,f=i.length;do{if(c>=f)throw Du.bytes=0,new RangeError("Could not decode varint");d=i[c++],t+=o<28?(d&xd)<<o:(d&xd)*Math.pow(2,o),o+=7}while(d>=wI);return Du.bytes=c-s,t}var bI=Math.pow(2,7),EI=Math.pow(2,14),SI=Math.pow(2,21),II=Math.pow(2,28),OI=Math.pow(2,35),PI=Math.pow(2,42),xI=Math.pow(2,49),TI=Math.pow(2,56),NI=Math.pow(2,63),AI=function(i){return i<bI?1:i<EI?2:i<SI?3:i<II?4:i<OI?5:i<PI?6:i<xI?7:i<TI?8:i<NI?9:10},RI={encode:gI,decode:mI,encodingLength:AI},pg=RI;const Td=(i,e,t=0)=>(pg.encode(i,e,t),e),Nd=i=>pg.encodingLength(i),Mu=(i,e)=>{const t=e.byteLength,s=Nd(i),o=s+Nd(t),c=new Uint8Array(o+t);return Td(i,c,0),Td(t,c,s),c.set(e,o),new CI(i,t,e,c)};class CI{constructor(e,t,s,o){this.code=e,this.size=t,this.digest=s,this.bytes=o}}const gg=({name:i,code:e,encode:t})=>new UI(i,e,t);class UI{constructor(e,t,s){this.name=e,this.code=t,this.encode=s}digest(e){if(e instanceof Uint8Array){const t=this.encode(e);return t instanceof Uint8Array?Mu(this.code,t):t.then(s=>Mu(this.code,s))}else throw Error("Unknown type, must be binary type")}}const vg=i=>async e=>new Uint8Array(await crypto.subtle.digest(i,e)),$I=gg({name:"sha2-256",code:18,encode:vg("SHA-256")}),LI=gg({name:"sha2-512",code:19,encode:vg("SHA-512")});var FI=Object.freeze({__proto__:null,sha256:$I,sha512:LI});const yg=0,DI="identity",_g=hg,MI=i=>Mu(yg,_g(i)),jI={code:yg,name:DI,encode:_g,digest:MI};var qI=Object.freeze({__proto__:null,identity:jI});new TextEncoder,new TextDecoder;const Ad={...C2,...$2,...F2,...M2,...H2,...Q2,...eI,...iI,...cI,...pI};({...FI,...qI});function mg(i){return globalThis.Buffer!=null?new Uint8Array(i.buffer,i.byteOffset,i.byteLength):i}function HI(i=0){return globalThis.Buffer!=null&&globalThis.Buffer.allocUnsafe!=null?mg(globalThis.Buffer.allocUnsafe(i)):new Uint8Array(i)}function wg(i,e,t,s){return{name:i,prefix:e,encoder:{name:i,prefix:e,encode:t},decoder:{decode:s}}}const Rd=wg("utf8","u",i=>"u"+new TextDecoder("utf8").decode(i),i=>new TextEncoder().encode(i.substring(1))),cu=wg("ascii","a",i=>{let e="a";for(let t=0;t<i.length;t++)e+=String.fromCharCode(i[t]);return e},i=>{i=i.substring(1);const e=HI(i.length);for(let t=0;t<i.length;t++)e[t]=i.charCodeAt(t);return e}),BI={utf8:Rd,"utf-8":Rd,hex:Ad.base16,latin1:cu,ascii:cu,binary:cu,...Ad};function zI(i,e="utf8"){const t=BI[e];if(!t)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?mg(globalThis.Buffer.from(i,"utf-8")):t.decoder.decode(`${t.prefix}${i}`)}const bg="wc",KI=2,lh="core",Li=`${bg}@2:${lh}:`,VI={name:lh,logger:"error"},kI={database:":memory:"},GI="crypto",Cd="client_ed25519_seed",WI=ye.ONE_DAY,YI="keychain",JI="0.3",QI="messages",XI="0.3",ZI=ye.SIX_HOURS,e3="publisher",Eg="irn",t3="error",Sg="wss://relay.walletconnect.com",Ud="wss://relay.walletconnect.org",r3="relayer",er={message:"relayer_message",message_ack:"relayer_message_ack",connect:"relayer_connect",disconnect:"relayer_disconnect",error:"relayer_error",connection_stalled:"relayer_connection_stalled",transport_closed:"relayer_transport_closed",publish:"relayer_publish"},i3="_subscription",wi={payload:"payload",connect:"connect",disconnect:"disconnect",error:"error"},n3=ye.ONE_SECOND,s3="2.10.0",o3=1e4,a3="0.3",c3="WALLETCONNECT_CLIENT_ID",ni={created:"subscription_created",deleted:"subscription_deleted",expired:"subscription_expired",disabled:"subscription_disabled",sync:"subscription_sync",resubscribed:"subscription_resubscribed"},u3="subscription",h3="0.3",l3=ye.FIVE_SECONDS*1e3,f3="pairing",d3="0.3",vs={wc_pairingDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1e3},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1001}},wc_pairingPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1002},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1003}},unregistered_method:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:0},res:{ttl:ye.ONE_DAY,prompt:!1,tag:0}}},ii={created:"history_created",updated:"history_updated",deleted:"history_deleted",sync:"history_sync"},p3="history",g3="0.3",v3="expirer",Lr={created:"expirer_created",deleted:"expirer_deleted",expired:"expirer_expired",sync:"expirer_sync"},y3="0.3",uu="verify-api",Go="https://verify.walletconnect.com",$d="https://verify.walletconnect.org";class _3{constructor(e,t){this.core=e,this.logger=t,this.keychain=new Map,this.name=YI,this.version=JI,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){const s=await this.getKeyChain();typeof s<"u"&&(this.keychain=s),this.initialized=!0}},this.has=s=>(this.isInitialized(),this.keychain.has(s)),this.set=async(s,o)=>{this.isInitialized(),this.keychain.set(s,o),await this.persist()},this.get=s=>{this.isInitialized();const o=this.keychain.get(s);if(typeof o>"u"){const{message:c}=ue("NO_MATCHING_KEY",`${this.name}: ${s}`);throw new Error(c)}return o},this.del=async s=>{this.isInitialized(),this.keychain.delete(s),await this.persist()},this.core=e,this.logger=et.generateChildLogger(t,this.name)}get context(){return et.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setKeyChain(e){await this.core.storage.setItem(this.storageKey,Cp(e))}async getKeyChain(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Up(e):void 0}async persist(){await this.setKeyChain(this.keychain)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class m3{constructor(e,t,s){this.core=e,this.logger=t,this.name=GI,this.initialized=!1,this.init=async()=>{this.initialized||(await this.keychain.init(),this.initialized=!0)},this.hasKeys=o=>(this.isInitialized(),this.keychain.has(o)),this.getClientId=async()=>{this.isInitialized();const o=await this.getClientSeed(),c=_d(o);return rg(c.publicKey)},this.generateKeyPair=()=>{this.isInitialized();const o=sE();return this.setPrivateKey(o.publicKey,o.privateKey)},this.signJWT=async o=>{this.isInitialized();const c=await this.getClientSeed(),d=_d(c),f=Tu();return await XS(f,o,WI,d)},this.generateSharedKey=(o,c,d)=>{this.isInitialized();const f=this.getPrivateKey(o),g=oE(f,c);return this.setSymKey(g,d)},this.setSymKey=async(o,c)=>{this.isInitialized();const d=c||aE(o);return await this.keychain.set(d,o),d},this.deleteKeyPair=async o=>{this.isInitialized(),await this.keychain.del(o)},this.deleteSymKey=async o=>{this.isInitialized(),await this.keychain.del(o)},this.encode=async(o,c,d)=>{this.isInitialized();const f=Rp(d),g=Ts(c);if(Ff(f)){const P=f.senderPublicKey,A=f.receiverPublicKey;o=await this.generateSharedKey(P,A)}const y=this.getSymKey(o),{type:b,senderPublicKey:x}=f;return uE({type:b,symKey:y,message:g,senderPublicKey:x})},this.decode=async(o,c,d)=>{this.isInitialized();const f=fE(c,d);if(Ff(f)){const g=f.receiverPublicKey,y=f.senderPublicKey;o=await this.generateSharedKey(g,y)}try{const g=this.getSymKey(o),y=hE({symKey:g,encoded:c});return rh(y)}catch(g){this.logger.error(`Failed to decode message from topic: '${o}', clientId: '${await this.getClientId()}'`),this.logger.error(g)}},this.getPayloadType=o=>{const c=Qo(o);return Cs(c.type)},this.getPayloadSenderPublicKey=o=>{const c=Qo(o);return c.senderPublicKey?va(c.senderPublicKey,ur):void 0},this.core=e,this.logger=et.generateChildLogger(t,this.name),this.keychain=s||new _3(this.core,this.logger)}get context(){return et.getLoggerContext(this.logger)}async setPrivateKey(e,t){return await this.keychain.set(e,t),e}getPrivateKey(e){return this.keychain.get(e)}async getClientSeed(){let e="";try{e=this.keychain.get(Cd)}catch{e=Tu(),await this.keychain.set(Cd,e)}return zI(e,"base16")}getSymKey(e){return this.keychain.get(e)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class w3 extends vw{constructor(e,t){super(e,t),this.logger=e,this.core=t,this.messages=new Map,this.name=QI,this.version=XI,this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{if(!this.initialized){this.logger.trace("Initialized");try{const s=await this.getRelayerMessages();typeof s<"u"&&(this.messages=s),this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",size:this.messages.size})}catch(s){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(s)}finally{this.initialized=!0}}},this.set=async(s,o)=>{this.isInitialized();const c=Ln(o);let d=this.messages.get(s);return typeof d>"u"&&(d={}),typeof d[c]<"u"||(d[c]=o,this.messages.set(s,d),await this.persist()),c},this.get=s=>{this.isInitialized();let o=this.messages.get(s);return typeof o>"u"&&(o={}),o},this.has=(s,o)=>{this.isInitialized();const c=this.get(s),d=Ln(o);return typeof c[d]<"u"},this.del=async s=>{this.isInitialized(),this.messages.delete(s),await this.persist()},this.logger=et.generateChildLogger(e,this.name),this.core=t}get context(){return et.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}async setRelayerMessages(e){await this.core.storage.setItem(this.storageKey,Cp(e))}async getRelayerMessages(){const e=await this.core.storage.getItem(this.storageKey);return typeof e<"u"?Up(e):void 0}async persist(){await this.setRelayerMessages(this.messages)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class b3 extends yw{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.events=new Dr.EventEmitter,this.name=e3,this.queue=new Map,this.publishTimeout=ye.toMiliseconds(ye.TEN_SECONDS),this.needsTransportRestart=!1,this.publish=async(s,o,c)=>{var d;this.logger.debug("Publishing Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}});try{const f=(c==null?void 0:c.ttl)||ZI,g=Nu(c),y=(c==null?void 0:c.prompt)||!1,b=(c==null?void 0:c.tag)||0,x=(c==null?void 0:c.id)||ag().toString(),P={topic:s,message:o,opts:{ttl:f,relay:g,prompt:y,tag:b,id:x}},A=setTimeout(()=>this.queue.set(x,P),this.publishTimeout);try{await await Ps(this.rpcPublish(s,o,f,g,y,b,x),this.publishTimeout,"Failed to publish payload, please try again."),this.removeRequestFromQueue(x),this.relayer.events.emit(er.publish,P)}catch(q){if(this.logger.debug("Publishing Payload stalled"),this.needsTransportRestart=!0,(d=c==null?void 0:c.internal)!=null&&d.throwOnFailedPublish)throw this.removeRequestFromQueue(x),q;return}finally{clearTimeout(A)}this.logger.debug("Successfully Published Payload"),this.logger.trace({type:"method",method:"publish",params:{topic:s,message:o,opts:c}})}catch(f){throw this.logger.debug("Failed to Publish Payload"),this.logger.error(f),f}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.relayer=e,this.logger=et.generateChildLogger(t,this.name),this.registerEventListeners()}get context(){return et.getLoggerContext(this.logger)}rpcPublish(e,t,s,o,c,d,f){var g,y,b,x;const P={method:Vo(o.protocol).publish,params:{topic:e,message:t,ttl:s,prompt:c,tag:d},id:f};return cr((g=P.params)==null?void 0:g.prompt)&&((y=P.params)==null||delete y.prompt),cr((b=P.params)==null?void 0:b.tag)&&((x=P.params)==null||delete x.tag),this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"message",direction:"outgoing",request:P}),this.relayer.request(P)}removeRequestFromQueue(e){this.queue.delete(e)}checkQueue(){this.queue.forEach(async e=>{const{topic:t,message:s,opts:o}=e;await this.publish(t,s,o)})}registerEventListeners(){this.relayer.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,()=>{if(this.needsTransportRestart){this.needsTransportRestart=!1,this.relayer.events.emit(er.connection_stalled);return}this.checkQueue()}),this.relayer.on(er.message_ack,e=>{this.removeRequestFromQueue(e.id.toString())})}}class E3{constructor(){this.map=new Map,this.set=(e,t)=>{const s=this.get(e);this.exists(e,t)||this.map.set(e,[...s,t])},this.get=e=>this.map.get(e)||[],this.exists=(e,t)=>this.get(e).includes(t),this.delete=(e,t)=>{if(typeof t>"u"){this.map.delete(e);return}if(!this.map.has(e))return;const s=this.get(e);if(!this.exists(e,t))return;const o=s.filter(c=>c!==t);if(!o.length){this.map.delete(e);return}this.map.set(e,o)},this.clear=()=>{this.map.clear()}}get topics(){return Array.from(this.map.keys())}}var S3=Object.defineProperty,I3=Object.defineProperties,O3=Object.getOwnPropertyDescriptors,Ld=Object.getOwnPropertySymbols,P3=Object.prototype.hasOwnProperty,x3=Object.prototype.propertyIsEnumerable,Fd=(i,e,t)=>e in i?S3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,ys=(i,e)=>{for(var t in e||(e={}))P3.call(e,t)&&Fd(i,t,e[t]);if(Ld)for(var t of Ld(e))x3.call(e,t)&&Fd(i,t,e[t]);return i},hu=(i,e)=>I3(i,O3(e));class T3 extends ww{constructor(e,t){super(e,t),this.relayer=e,this.logger=t,this.subscriptions=new Map,this.topicMap=new E3,this.events=new Dr.EventEmitter,this.name=u3,this.version=h3,this.pending=new Map,this.cached=[],this.initialized=!1,this.pendingSubscriptionWatchLabel="pending_sub_watch_label",this.pollingInterval=20,this.storagePrefix=Li,this.subscribeTimeout=1e4,this.restartInProgress=!1,this.batchSubscribeTopicsLimit=500,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),this.registerEventListeners(),this.clientId=await this.relayer.core.crypto.getClientId())},this.subscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),this.logger.debug("Subscribing Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}});try{const c=Nu(o),d={topic:s,relay:c};this.pending.set(s,d);const f=await this.rpcSubscribe(s,c);return this.onSubscribe(f,d),this.logger.debug("Successfully Subscribed Topic"),this.logger.trace({type:"method",method:"subscribe",params:{topic:s,opts:o}}),f}catch(c){throw this.logger.debug("Failed to Subscribe Topic"),this.logger.error(c),c}},this.unsubscribe=async(s,o)=>{await this.restartToComplete(),this.isInitialized(),typeof(o==null?void 0:o.id)<"u"?await this.unsubscribeById(s,o.id,o):await this.unsubscribeByTopic(s,o)},this.isSubscribed=async s=>this.topics.includes(s)?!0:await new Promise((o,c)=>{const d=new ye.Watch;d.start(this.pendingSubscriptionWatchLabel);const f=setInterval(()=>{!this.pending.has(s)&&this.topics.includes(s)&&(clearInterval(f),d.stop(this.pendingSubscriptionWatchLabel),o(!0)),d.elapsed(this.pendingSubscriptionWatchLabel)>=l3&&(clearInterval(f),d.stop(this.pendingSubscriptionWatchLabel),c(new Error("Subscription resolution timeout")))},this.pollingInterval)}).catch(()=>!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.restart=async()=>{this.restartInProgress=!0,await this.restore(),await this.reset(),this.restartInProgress=!1},this.relayer=e,this.logger=et.generateChildLogger(t,this.name),this.clientId=""}get context(){return et.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.subscriptions.size}get ids(){return Array.from(this.subscriptions.keys())}get values(){return Array.from(this.subscriptions.values())}get topics(){return this.topicMap.topics}hasSubscription(e,t){let s=!1;try{s=this.getSubscription(e).topic===t}catch{}return s}onEnable(){this.cached=[],this.initialized=!0}onDisable(){this.cached=this.values,this.subscriptions.clear(),this.topicMap.clear()}async unsubscribeByTopic(e,t){const s=this.topicMap.get(e);await Promise.all(s.map(async o=>await this.unsubscribeById(e,o,t)))}async unsubscribeById(e,t,s){this.logger.debug("Unsubscribing Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}});try{const o=Nu(s);await this.rpcUnsubscribe(e,t,o);const c=$t("USER_DISCONNECTED",`${this.name}, ${e}`);await this.onUnsubscribe(e,t,c),this.logger.debug("Successfully Unsubscribed Topic"),this.logger.trace({type:"method",method:"unsubscribe",params:{topic:e,id:t,opts:s}})}catch(o){throw this.logger.debug("Failed to Unsubscribe Topic"),this.logger.error(o),o}}async rpcSubscribe(e,t){const s={method:Vo(t.protocol).subscribe,params:{topic:e}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{await await Ps(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Subscribe Payload stalled"),this.relayer.events.emit(er.connection_stalled)}return Ln(e+this.clientId)}async rpcBatchSubscribe(e){if(!e.length)return;const t=e[0].relay,s={method:Vo(t.protocol).batchSubscribe,params:{topics:e.map(o=>o.topic)}};this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:s});try{return await await Ps(this.relayer.request(s),this.subscribeTimeout)}catch{this.logger.debug("Outgoing Relay Payload stalled"),this.relayer.events.emit(er.connection_stalled)}}rpcUnsubscribe(e,t,s){const o={method:Vo(s.protocol).unsubscribe,params:{topic:e,id:t}};return this.logger.debug("Outgoing Relay Payload"),this.logger.trace({type:"payload",direction:"outgoing",request:o}),this.relayer.request(o)}onSubscribe(e,t){this.setSubscription(e,hu(ys({},t),{id:e})),this.pending.delete(t.topic)}onBatchSubscribe(e){e.length&&e.forEach(t=>{this.setSubscription(t.id,ys({},t)),this.pending.delete(t.topic)})}async onUnsubscribe(e,t,s){this.events.removeAllListeners(t),this.hasSubscription(t,e)&&this.deleteSubscription(t,s),await this.relayer.messages.del(e)}async setRelayerSubscriptions(e){await this.relayer.core.storage.setItem(this.storageKey,e)}async getRelayerSubscriptions(){return await this.relayer.core.storage.getItem(this.storageKey)}setSubscription(e,t){this.subscriptions.has(e)||(this.logger.debug("Setting subscription"),this.logger.trace({type:"method",method:"setSubscription",id:e,subscription:t}),this.addSubscription(e,t))}addSubscription(e,t){this.subscriptions.set(e,ys({},t)),this.topicMap.set(t.topic,e),this.events.emit(ni.created,t)}getSubscription(e){this.logger.debug("Getting subscription"),this.logger.trace({type:"method",method:"getSubscription",id:e});const t=this.subscriptions.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}deleteSubscription(e,t){this.logger.debug("Deleting subscription"),this.logger.trace({type:"method",method:"deleteSubscription",id:e,reason:t});const s=this.getSubscription(e);this.subscriptions.delete(e),this.topicMap.delete(s.topic,e),this.events.emit(ni.deleted,hu(ys({},s),{reason:t}))}async persist(){await this.setRelayerSubscriptions(this.values),this.events.emit(ni.sync)}async reset(){if(this.cached.length){const e=Math.ceil(this.cached.length/this.batchSubscribeTopicsLimit);for(let t=0;t<e;t++){const s=this.cached.splice(0,this.batchSubscribeTopicsLimit);await this.batchSubscribe(s)}}this.events.emit(ni.resubscribed)}async restore(){try{const e=await this.getRelayerSubscriptions();if(typeof e>"u"||!e.length)return;if(this.subscriptions.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),this.logger.error(`${this.name}: ${JSON.stringify(this.values)}`),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored subscriptions for ${this.name}`),this.logger.trace({type:"method",method:"restore",subscriptions:this.values})}catch(e){this.logger.debug(`Failed to Restore subscriptions for ${this.name}`),this.logger.error(e)}}async batchSubscribe(e){if(!e.length)return;const t=await this.rpcBatchSubscribe(e);si(t)&&this.onBatchSubscribe(t.map((s,o)=>hu(ys({},e[o]),{id:s})))}async onConnect(){this.restartInProgress||(await this.restart(),this.onEnable())}onDisconnect(){this.onDisable()}async checkPending(){if(!this.initialized||this.relayer.transportExplicitlyClosed)return;const e=[];this.pending.forEach(t=>{e.push(t)}),await this.batchSubscribe(e)}registerEventListeners(){this.relayer.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,async()=>{await this.checkPending()}),this.relayer.on(er.connect,async()=>{await this.onConnect()}),this.relayer.on(er.disconnect,()=>{this.onDisconnect()}),this.events.on(ni.created,async e=>{const t=ni.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()}),this.events.on(ni.deleted,async e=>{const t=ni.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),await this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async restartToComplete(){this.restartInProgress&&await new Promise(e=>{const t=setInterval(()=>{this.restartInProgress||(clearInterval(t),e())},this.pollingInterval)})}}var N3=Object.defineProperty,Dd=Object.getOwnPropertySymbols,A3=Object.prototype.hasOwnProperty,R3=Object.prototype.propertyIsEnumerable,Md=(i,e,t)=>e in i?N3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,C3=(i,e)=>{for(var t in e||(e={}))A3.call(e,t)&&Md(i,t,e[t]);if(Dd)for(var t of Dd(e))R3.call(e,t)&&Md(i,t,e[t]);return i};class U3 extends _w{constructor(e){super(e),this.protocol="wc",this.version=2,this.events=new Dr.EventEmitter,this.name=r3,this.transportExplicitlyClosed=!1,this.initialized=!1,this.connectionAttemptInProgress=!1,this.connectionStatusPollingInterval=20,this.staleConnectionErrors=["socket hang up","socket stalled"],this.hasExperiencedNetworkDisruption=!1,this.request=async t=>{this.logger.debug("Publishing Request Payload");try{return await this.toEstablishConnection(),await this.provider.request(t)}catch(s){throw this.logger.debug("Failed to Publish Request"),this.logger.error(s),s}},this.onPayloadHandler=t=>{this.onProviderPayload(t)},this.onConnectHandler=()=>{this.events.emit(er.connect)},this.onDisconnectHandler=()=>{this.onProviderDisconnect()},this.onProviderErrorHandler=t=>{this.logger.error(t),this.events.emit(er.error,t)},this.registerProviderListeners=()=>{this.provider.on(wi.payload,this.onPayloadHandler),this.provider.on(wi.connect,this.onConnectHandler),this.provider.on(wi.disconnect,this.onDisconnectHandler),this.provider.on(wi.error,this.onProviderErrorHandler)},this.core=e.core,this.logger=typeof e.logger<"u"&&typeof e.logger!="string"?et.generateChildLogger(e.logger,this.name):et.pino(et.getDefaultLoggerOptions({level:e.logger||t3})),this.messages=new w3(this.logger,e.core),this.subscriber=new T3(this,this.logger),this.publisher=new b3(this,this.logger),this.relayUrl=(e==null?void 0:e.relayUrl)||Sg,this.projectId=e.projectId,this.provider={}}async init(){this.logger.trace("Initialized"),this.registerEventListeners(),await this.createProvider(),await Promise.all([this.messages.init(),this.subscriber.init()]);try{await this.transportOpen()}catch{this.logger.warn(`Connection via ${this.relayUrl} failed, attempting to connect via failover domain ${Ud}...`),await this.restartTransport(Ud)}this.initialized=!0,setTimeout(async()=>{this.subscriber.topics.length===0&&(this.logger.info("No topics subscribed to after init, closing transport"),await this.transportClose(),this.transportExplicitlyClosed=!1)},o3)}get context(){return et.getLoggerContext(this.logger)}get connected(){return this.provider.connection.connected}get connecting(){return this.provider.connection.connecting}async publish(e,t,s){this.isInitialized(),await this.publisher.publish(e,t,s),await this.recordMessageEvent({topic:e,message:t,publishedAt:Date.now()})}async subscribe(e,t){var s;this.isInitialized();let o=((s=this.subscriber.topicMap.get(e))==null?void 0:s[0])||"";return o||(await Promise.all([new Promise(c=>{this.subscriber.once(ni.created,d=>{d.topic===e&&c()})}),new Promise(async c=>{o=await this.subscriber.subscribe(e,t),c()})]),o)}async unsubscribe(e,t){this.isInitialized(),await this.subscriber.unsubscribe(e,t)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async transportClose(){this.transportExplicitlyClosed=!0,this.hasExperiencedNetworkDisruption&&this.connected?await Ps(this.provider.disconnect(),1e3,"provider.disconnect()").catch(()=>this.onProviderDisconnect()):this.connected&&await this.provider.disconnect()}async transportOpen(e){if(this.transportExplicitlyClosed=!1,await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress){e&&e!==this.relayUrl&&(this.relayUrl=e,await this.transportClose(),await this.createProvider()),this.connectionAttemptInProgress=!0;try{await Promise.all([new Promise(t=>{if(!this.initialized)return t();this.subscriber.once(ni.resubscribed,()=>{t()})}),new Promise(async(t,s)=>{try{await Ps(this.provider.connect(),1e4,`Socket stalled when trying to connect to ${this.relayUrl}`)}catch(o){s(o);return}t()})])}catch(t){this.logger.error(t);const s=t;if(!this.isConnectionStalled(s.message))throw t;this.provider.events.emit(wi.disconnect)}finally{this.connectionAttemptInProgress=!1,this.hasExperiencedNetworkDisruption=!1}}}async restartTransport(e){await this.confirmOnlineStateOrThrow(),!this.connectionAttemptInProgress&&(this.relayUrl=e||this.relayUrl,await this.transportClose(),await this.createProvider(),await this.transportOpen())}async confirmOnlineStateOrThrow(){if(!await kf())throw new Error("No internet connection detected. Please restart your network and try again.")}isConnectionStalled(e){return this.staleConnectionErrors.some(t=>e.includes(t))}async createProvider(){this.provider.connection&&this.unregisterProviderListeners();const e=await this.core.crypto.signJWT(this.relayUrl);this.provider=new Di(new m2(SE({sdkVersion:s3,protocol:this.protocol,version:this.version,relayUrl:this.relayUrl,projectId:this.projectId,auth:e,useOnCloseEvent:!0}))),this.registerProviderListeners()}async recordMessageEvent(e){const{topic:t,message:s}=e;await this.messages.set(t,s)}async shouldIgnoreMessageEvent(e){const{topic:t,message:s}=e;if(!s||s.length===0)return this.logger.debug(`Ignoring invalid/empty message: ${s}`),!0;if(!await this.subscriber.isSubscribed(t))return this.logger.debug(`Ignoring message for non-subscribed topic ${t}`),!0;const o=this.messages.has(t,s);return o&&this.logger.debug(`Ignoring duplicate message: ${s}`),o}async onProviderPayload(e){if(this.logger.debug("Incoming Relay Payload"),this.logger.trace({type:"payload",direction:"incoming",payload:e}),hh(e)){if(!e.method.endsWith(i3))return;const t=e.params,{topic:s,message:o,publishedAt:c}=t.data,d={topic:s,message:o,publishedAt:c};this.logger.debug("Emitting Relayer Payload"),this.logger.trace(C3({type:"event",event:t.id},d)),this.events.emit(t.id,d),await this.acknowledgePayload(e),await this.onMessageEvent(d)}else _a(e)&&this.events.emit(er.message_ack,e)}async onMessageEvent(e){await this.shouldIgnoreMessageEvent(e)||(this.events.emit(er.message,e),await this.recordMessageEvent(e))}async acknowledgePayload(e){const t=uh(e.id,!0);await this.provider.connection.send(t)}unregisterProviderListeners(){this.provider.off(wi.payload,this.onPayloadHandler),this.provider.off(wi.connect,this.onConnectHandler),this.provider.off(wi.disconnect,this.onDisconnectHandler),this.provider.off(wi.error,this.onProviderErrorHandler)}async registerEventListeners(){this.events.on(er.connection_stalled,()=>{this.restartTransport().catch(t=>this.logger.error(t))});let e=await kf();g6(async t=>{this.initialized&&e!==t&&(e=t,t?await this.restartTransport().catch(s=>this.logger.error(s)):(this.hasExperiencedNetworkDisruption=!0,await this.transportClose().catch(s=>this.logger.error(s))))})}onProviderDisconnect(){this.events.emit(er.disconnect),this.attemptToReconnect()}attemptToReconnect(){this.transportExplicitlyClosed||(this.logger.info("attemptToReconnect called. Connecting..."),setTimeout(async()=>{await this.restartTransport().catch(e=>this.logger.error(e))},ye.toMiliseconds(n3)))}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}async toEstablishConnection(){if(await this.confirmOnlineStateOrThrow(),!this.connected){if(this.connectionAttemptInProgress)return await new Promise(e=>{const t=setInterval(()=>{this.connected&&(clearInterval(t),e())},this.connectionStatusPollingInterval)});await this.restartTransport()}}}var $3=Object.defineProperty,jd=Object.getOwnPropertySymbols,L3=Object.prototype.hasOwnProperty,F3=Object.prototype.propertyIsEnumerable,qd=(i,e,t)=>e in i?$3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Hd=(i,e)=>{for(var t in e||(e={}))L3.call(e,t)&&qd(i,t,e[t]);if(jd)for(var t of jd(e))F3.call(e,t)&&qd(i,t,e[t]);return i};class wa extends mw{constructor(e,t,s,o=Li,c=void 0){super(e,t,s,o),this.core=e,this.logger=t,this.name=s,this.map=new Map,this.version=a3,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(d=>{this.getKey&&d!==null&&!cr(d)?this.map.set(this.getKey(d),d):kE(d)?this.map.set(d.id,d):GE(d)&&this.map.set(d.topic,d)}),this.cached=[],this.initialized=!0)},this.set=async(d,f)=>{this.isInitialized(),this.map.has(d)?await this.update(d,f):(this.logger.debug("Setting value"),this.logger.trace({type:"method",method:"set",key:d,value:f}),this.map.set(d,f),await this.persist())},this.get=d=>(this.isInitialized(),this.logger.debug("Getting value"),this.logger.trace({type:"method",method:"get",key:d}),this.getData(d)),this.getAll=d=>(this.isInitialized(),d?this.values.filter(f=>Object.keys(d).every(g=>m6(f[g],d[g]))):this.values),this.update=async(d,f)=>{this.isInitialized(),this.logger.debug("Updating value"),this.logger.trace({type:"method",method:"update",key:d,update:f});const g=Hd(Hd({},this.getData(d)),f);this.map.set(d,g),await this.persist()},this.delete=async(d,f)=>{this.isInitialized(),this.map.has(d)&&(this.logger.debug("Deleting value"),this.logger.trace({type:"method",method:"delete",key:d,reason:f}),this.map.delete(d),await this.persist())},this.logger=et.generateChildLogger(t,this.name),this.storagePrefix=o,this.getKey=c}get context(){return et.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.map.size}get keys(){return Array.from(this.map.keys())}get values(){return Array.from(this.map.values())}async setDataStore(e){await this.core.storage.setItem(this.storageKey,e)}async getDataStore(){return await this.core.storage.getItem(this.storageKey)}getData(e){const t=this.map.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}async persist(){await this.setDataStore(this.values)}async restore(){try{const e=await this.getDataStore();if(typeof e>"u"||!e.length)return;if(this.map.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored value for ${this.name}`),this.logger.trace({type:"method",method:"restore",value:this.values})}catch(e){this.logger.debug(`Failed to Restore value for ${this.name}`),this.logger.error(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class D3{constructor(e,t){this.core=e,this.logger=t,this.name=f3,this.version=d3,this.events=new Ku,this.initialized=!1,this.storagePrefix=Li,this.ignoredPayloadTypes=[un],this.registeredMethods=[],this.init=async()=>{this.initialized||(await this.pairings.init(),await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.initialized=!0,this.logger.trace("Initialized"))},this.register=({methods:s})=>{this.isInitialized(),this.registeredMethods=[...new Set([...this.registeredMethods,...s])]},this.create=async()=>{this.isInitialized();const s=Tu(),o=await this.core.crypto.setSymKey(s),c=Vr(ye.FIVE_MINUTES),d={protocol:Eg},f={topic:o,expiry:c,relay:d,active:!1},g=FE({protocol:this.core.protocol,version:this.core.version,topic:o,symKey:s,relay:d});return await this.pairings.set(o,f),await this.core.relayer.subscribe(o),this.core.expirer.set(o,c),{topic:o,uri:g}},this.pair=async s=>{this.isInitialized(),this.isValidPair(s);const{topic:o,symKey:c,relay:d}=UE(s.uri);if(this.pairings.keys.includes(o))throw new Error(`Pairing already exists: ${o}`);if(this.core.crypto.hasKeys(o))throw new Error(`Keychain already exists: ${o}`);const f=Vr(ye.FIVE_MINUTES),g={topic:o,relay:d,expiry:f,active:!1};return await this.pairings.set(o,g),await this.core.crypto.setSymKey(c,o),await this.core.relayer.subscribe(o,{relay:d}),this.core.expirer.set(o,f),s.activatePairing&&await this.activate({topic:o}),g},this.activate=async({topic:s})=>{this.isInitialized();const o=Vr(ye.THIRTY_DAYS);await this.pairings.update(s,{active:!0,expiry:o}),this.core.expirer.set(s,o)},this.ping=async s=>{this.isInitialized(),await this.isValidPing(s);const{topic:o}=s;if(this.pairings.keys.includes(o)){const c=await this.sendRequest(o,"wc_pairingPing",{}),{done:d,resolve:f,reject:g}=Un();this.events.once(zt("pairing_ping",c),({error:y})=>{y?g(y):f()}),await d()}},this.updateExpiry=async({topic:s,expiry:o})=>{this.isInitialized(),await this.pairings.update(s,{expiry:o})},this.updateMetadata=async({topic:s,metadata:o})=>{this.isInitialized(),await this.pairings.update(s,{peerMetadata:o})},this.getPairings=()=>(this.isInitialized(),this.pairings.values),this.disconnect=async s=>{this.isInitialized(),await this.isValidDisconnect(s);const{topic:o}=s;this.pairings.keys.includes(o)&&(await this.sendRequest(o,"wc_pairingDelete",$t("USER_DISCONNECTED")),await this.deletePairing(o))},this.sendRequest=async(s,o,c)=>{const d=Ns(o,c),f=await this.core.crypto.encode(s,d),g=vs[o].req;return this.core.history.set(s,d),this.core.relayer.publish(s,f,g),d.id},this.sendResult=async(s,o,c)=>{const d=uh(s,c),f=await this.core.crypto.encode(o,d),g=await this.core.history.get(o,s),y=vs[g.request.method].res;await this.core.relayer.publish(o,f,y),await this.core.history.resolve(d)},this.sendError=async(s,o,c)=>{const d=ya(s,c),f=await this.core.crypto.encode(o,d),g=await this.core.history.get(o,s),y=vs[g.request.method]?vs[g.request.method].res:vs.unregistered_method.res;await this.core.relayer.publish(o,f,y),await this.core.history.resolve(d)},this.deletePairing=async(s,o)=>{await this.core.relayer.unsubscribe(s),await Promise.all([this.pairings.delete(s,$t("USER_DISCONNECTED")),this.core.crypto.deleteSymKey(s),o?Promise.resolve():this.core.expirer.del(s)])},this.cleanup=async()=>{const s=this.pairings.getAll().filter(o=>$i(o.expiry));await Promise.all(s.map(o=>this.deletePairing(o.topic)))},this.onRelayEventRequest=s=>{const{topic:o,payload:c}=s;switch(c.method){case"wc_pairingPing":return this.onPairingPingRequest(o,c);case"wc_pairingDelete":return this.onPairingDeleteRequest(o,c);default:return this.onUnknownRpcMethodRequest(o,c)}},this.onRelayEventResponse=async s=>{const{topic:o,payload:c}=s,d=(await this.core.history.get(o,c.id)).request.method;switch(d){case"wc_pairingPing":return this.onPairingPingResponse(o,c);default:return this.onUnknownRpcMethodResponse(d)}},this.onPairingPingRequest=async(s,o)=>{const{id:c}=o;try{this.isValidPing({topic:s}),await this.sendResult(c,s,!0),this.events.emit("pairing_ping",{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onPairingPingResponse=(s,o)=>{const{id:c}=o;setTimeout(()=>{Ei(o)?this.events.emit(zt("pairing_ping",c),{}):kr(o)&&this.events.emit(zt("pairing_ping",c),{error:o.error})},500)},this.onPairingDeleteRequest=async(s,o)=>{const{id:c}=o;try{this.isValidDisconnect({topic:s}),await this.deletePairing(s),this.events.emit("pairing_delete",{id:c,topic:s})}catch(d){await this.sendError(c,s,d),this.logger.error(d)}},this.onUnknownRpcMethodRequest=async(s,o)=>{const{id:c,method:d}=o;try{if(this.registeredMethods.includes(d))return;const f=$t("WC_METHOD_UNSUPPORTED",d);await this.sendError(c,s,f),this.logger.error(f)}catch(f){await this.sendError(c,s,f),this.logger.error(f)}},this.onUnknownRpcMethodResponse=s=>{this.registeredMethods.includes(s)||this.logger.error($t("WC_METHOD_UNSUPPORTED",s))},this.isValidPair=s=>{if(!yr(s)){const{message:o}=ue("MISSING_OR_INVALID",`pair() params: ${s}`);throw new Error(o)}if(!VE(s.uri)){const{message:o}=ue("MISSING_OR_INVALID",`pair() uri: ${s.uri}`);throw new Error(o)}},this.isValidPing=async s=>{if(!yr(s)){const{message:c}=ue("MISSING_OR_INVALID",`ping() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidDisconnect=async s=>{if(!yr(s)){const{message:c}=ue("MISSING_OR_INVALID",`disconnect() params: ${s}`);throw new Error(c)}const{topic:o}=s;await this.isValidPairingTopic(o)},this.isValidPairingTopic=async s=>{if(!Wt(s,!1)){const{message:o}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${s}`);throw new Error(o)}if(!this.pairings.keys.includes(s)){const{message:o}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${s}`);throw new Error(o)}if($i(this.pairings.get(s).expiry)){await this.deletePairing(s);const{message:o}=ue("EXPIRED",`pairing topic: ${s}`);throw new Error(o)}},this.core=e,this.logger=et.generateChildLogger(t,this.name),this.pairings=new wa(this.core,this.logger,this.name,this.storagePrefix)}get context(){return et.getLoggerContext(this.logger)}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}registerRelayerEvents(){this.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(!this.pairings.keys.includes(t)||this.ignoredPayloadTypes.includes(this.core.crypto.getPayloadType(s)))return;const o=await this.core.crypto.decode(t,s);try{hh(o)?(this.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):_a(o)&&(await this.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.core.history.delete(t,o.id))}catch(c){this.logger.error(c)}})}registerExpirerEvents(){this.core.expirer.on(Lr.expired,async e=>{const{topic:t}=Lp(e.target);t&&this.pairings.keys.includes(t)&&(await this.deletePairing(t,!0),this.events.emit("pairing_expire",{topic:t}))})}}class M3 extends gw{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.records=new Map,this.events=new Dr.EventEmitter,this.name=p3,this.version=g3,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.records.set(s.id,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.set=(s,o,c)=>{if(this.isInitialized(),this.logger.debug("Setting JSON-RPC request history record"),this.logger.trace({type:"method",method:"set",topic:s,request:o,chainId:c}),this.records.has(o.id))return;const d={id:o.id,topic:s,request:{method:o.method,params:o.params||null},chainId:c,expiry:Vr(ye.THIRTY_DAYS)};this.records.set(d.id,d),this.events.emit(ii.created,d)},this.resolve=async s=>{if(this.isInitialized(),this.logger.debug("Updating JSON-RPC response history record"),this.logger.trace({type:"method",method:"update",response:s}),!this.records.has(s.id))return;const o=await this.getRecord(s.id);typeof o.response>"u"&&(o.response=kr(s)?{error:s.error}:{result:s.result},this.records.set(o.id,o),this.events.emit(ii.updated,o))},this.get=async(s,o)=>(this.isInitialized(),this.logger.debug("Getting record"),this.logger.trace({type:"method",method:"get",topic:s,id:o}),await this.getRecord(o)),this.delete=(s,o)=>{this.isInitialized(),this.logger.debug("Deleting record"),this.logger.trace({type:"method",method:"delete",id:o}),this.values.forEach(c=>{if(c.topic===s){if(typeof o<"u"&&c.id!==o)return;this.records.delete(c.id),this.events.emit(ii.deleted,c)}})},this.exists=async(s,o)=>(this.isInitialized(),this.records.has(o)?(await this.getRecord(o)).topic===s:!1),this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=et.generateChildLogger(t,this.name)}get context(){return et.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get size(){return this.records.size}get keys(){return Array.from(this.records.keys())}get values(){return Array.from(this.records.values())}get pending(){const e=[];return this.values.forEach(t=>{if(typeof t.response<"u")return;const s={topic:t.topic,request:Ns(t.request.method,t.request.params,t.id),chainId:t.chainId};return e.push(s)}),e}async setJsonRpcRecords(e){await this.core.storage.setItem(this.storageKey,e)}async getJsonRpcRecords(){return await this.core.storage.getItem(this.storageKey)}getRecord(e){this.isInitialized();const t=this.records.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw new Error(s)}return t}async persist(){await this.setJsonRpcRecords(this.values),this.events.emit(ii.sync)}async restore(){try{const e=await this.getJsonRpcRecords();if(typeof e>"u"||!e.length)return;if(this.records.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored records for ${this.name}`),this.logger.trace({type:"method",method:"restore",records:this.values})}catch(e){this.logger.debug(`Failed to Restore records for ${this.name}`),this.logger.error(e)}}registerEventListeners(){this.events.on(ii.created,e=>{const t=ii.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.updated,e=>{const t=ii.updated;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.events.on(ii.deleted,e=>{const t=ii.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,record:e}),this.persist()}),this.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,()=>{this.cleanup()})}cleanup(){try{this.records.forEach(e=>{ye.toMiliseconds(e.expiry||0)-Date.now()<=0&&(this.logger.info(`Deleting expired history log: ${e.id}`),this.delete(e.topic,e.id))})}catch(e){this.logger.warn(e)}}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class j3 extends bw{constructor(e,t){super(e,t),this.core=e,this.logger=t,this.expirations=new Map,this.events=new Dr.EventEmitter,this.name=v3,this.version=y3,this.cached=[],this.initialized=!1,this.storagePrefix=Li,this.init=async()=>{this.initialized||(this.logger.trace("Initialized"),await this.restore(),this.cached.forEach(s=>this.expirations.set(s.target,s)),this.cached=[],this.registerEventListeners(),this.initialized=!0)},this.has=s=>{try{const o=this.formatTarget(s);return typeof this.getExpiration(o)<"u"}catch{return!1}},this.set=(s,o)=>{this.isInitialized();const c=this.formatTarget(s),d={target:c,expiry:o};this.expirations.set(c,d),this.checkExpiry(c,d),this.events.emit(Lr.created,{target:c,expiration:d})},this.get=s=>{this.isInitialized();const o=this.formatTarget(s);return this.getExpiration(o)},this.del=s=>{if(this.isInitialized(),this.has(s)){const o=this.formatTarget(s),c=this.getExpiration(o);this.expirations.delete(o),this.events.emit(Lr.deleted,{target:o,expiration:c})}},this.on=(s,o)=>{this.events.on(s,o)},this.once=(s,o)=>{this.events.once(s,o)},this.off=(s,o)=>{this.events.off(s,o)},this.removeListener=(s,o)=>{this.events.removeListener(s,o)},this.logger=et.generateChildLogger(t,this.name)}get context(){return et.getLoggerContext(this.logger)}get storageKey(){return this.storagePrefix+this.version+"//"+this.name}get length(){return this.expirations.size}get keys(){return Array.from(this.expirations.keys())}get values(){return Array.from(this.expirations.values())}formatTarget(e){if(typeof e=="string")return IE(e);if(typeof e=="number")return OE(e);const{message:t}=ue("UNKNOWN_TYPE",`Target type: ${typeof e}`);throw new Error(t)}async setExpirations(e){await this.core.storage.setItem(this.storageKey,e)}async getExpirations(){return await this.core.storage.getItem(this.storageKey)}async persist(){await this.setExpirations(this.values),this.events.emit(Lr.sync)}async restore(){try{const e=await this.getExpirations();if(typeof e>"u"||!e.length)return;if(this.expirations.size){const{message:t}=ue("RESTORE_WILL_OVERRIDE",this.name);throw this.logger.error(t),new Error(t)}this.cached=e,this.logger.debug(`Successfully Restored expirations for ${this.name}`),this.logger.trace({type:"method",method:"restore",expirations:this.values})}catch(e){this.logger.debug(`Failed to Restore expirations for ${this.name}`),this.logger.error(e)}}getExpiration(e){const t=this.expirations.get(e);if(!t){const{message:s}=ue("NO_MATCHING_KEY",`${this.name}: ${e}`);throw this.logger.error(s),new Error(s)}return t}checkExpiry(e,t){const{expiry:s}=t;ye.toMiliseconds(s)-Date.now()<=0&&this.expire(e,t)}expire(e,t){this.expirations.delete(e),this.events.emit(Lr.expired,{target:e,expiration:t})}checkExpirations(){this.core.relayer.connected&&this.expirations.forEach((e,t)=>this.checkExpiry(t,e))}registerEventListeners(){this.core.heartbeat.on(qn.HEARTBEAT_EVENTS.pulse,()=>this.checkExpirations()),this.events.on(Lr.created,e=>{const t=Lr.created;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Lr.expired,e=>{const t=Lr.expired;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()}),this.events.on(Lr.deleted,e=>{const t=Lr.deleted;this.logger.info(`Emitting ${t}`),this.logger.debug({type:"event",event:t,data:e}),this.persist()})}isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}}}class q3 extends Ew{constructor(e,t){super(e,t),this.projectId=e,this.logger=t,this.name=uu,this.initialized=!1,this.queue=[],this.verifyDisabled=!1,this.init=async s=>{if(this.verifyDisabled||la()||!Us())return;const o=(s==null?void 0:s.verifyUrl)||Go;this.verifyUrl!==o&&this.removeIframe(),this.verifyUrl=o;try{await this.createIframe()}catch(c){this.logger.warn(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.warn(c)}if(!this.initialized){this.removeIframe(),this.verifyUrl=$d;try{await this.createIframe()}catch(c){this.logger.error(`Verify iframe failed to load: ${this.verifyUrl}`),this.logger.error(c),this.verifyDisabled=!0}}},this.register=async s=>{this.initialized?this.sendPost(s.attestationId):(this.addToQueue(s.attestationId),await this.init())},this.resolve=async s=>{if(this.isDevEnv)return"";const o=(s==null?void 0:s.verifyUrl)||Go;let c="";try{c=await this.fetchAttestation(s.attestationId,o)}catch(d){this.logger.warn(`failed to resolve attestation: ${s.attestationId} from url: ${o}`),this.logger.warn(d),c=await this.fetchAttestation(s.attestationId,$d)}return c},this.fetchAttestation=async(s,o)=>{var c;this.logger.info(`resolving attestation: ${s} from url: ${o}`);const d=this.startAbortTimer(ye.ONE_SECOND*2),f=await fetch(`${o}/attestation/${s}`,{signal:this.abortController.signal});return clearTimeout(d),f.status===200?(c=await f.json())==null?void 0:c.origin:""},this.addToQueue=s=>{this.queue.push(s)},this.processQueue=()=>{this.queue.length!==0&&(this.queue.forEach(s=>this.sendPost(s)),this.queue=[])},this.sendPost=s=>{var o;try{if(!this.iframe)return;(o=this.iframe.contentWindow)==null||o.postMessage(s,"*"),this.logger.info(`postMessage sent: ${s} ${this.verifyUrl}`)}catch{}},this.createIframe=async()=>{let s;const o=c=>{c.data==="verify_ready"&&(this.initialized=!0,this.processQueue(),window.removeEventListener("message",o),s())};await Promise.race([new Promise(c=>{if(document.getElementById(uu))return c();window.addEventListener("message",o);const d=document.createElement("iframe");d.id=uu,d.src=`${this.verifyUrl}/${this.projectId}`,d.style.display="none",document.body.append(d),this.iframe=d,s=c}),new Promise((c,d)=>setTimeout(()=>{window.removeEventListener("message",o),d("verify iframe load timeout")},ye.toMiliseconds(ye.FIVE_SECONDS)))])},this.removeIframe=()=>{this.iframe&&(this.iframe.remove(),this.iframe=void 0,this.initialized=!1)},this.logger=et.generateChildLogger(t,this.name),this.verifyUrl=Go,this.abortController=new AbortController,this.isDevEnv=Zu()&&{}.IS_VITEST}get context(){return et.getLoggerContext(this.logger)}startAbortTimer(e){return this.abortController=new AbortController,setTimeout(()=>this.abortController.abort(),ye.toMiliseconds(e))}}var H3=Object.defineProperty,Bd=Object.getOwnPropertySymbols,B3=Object.prototype.hasOwnProperty,z3=Object.prototype.propertyIsEnumerable,zd=(i,e,t)=>e in i?H3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Kd=(i,e)=>{for(var t in e||(e={}))B3.call(e,t)&&zd(i,t,e[t]);if(Bd)for(var t of Bd(e))z3.call(e,t)&&zd(i,t,e[t]);return i};class fh extends pw{constructor(e){super(e),this.protocol=bg,this.version=KI,this.name=lh,this.events=new Dr.EventEmitter,this.initialized=!1,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.projectId=e==null?void 0:e.projectId,this.relayUrl=(e==null?void 0:e.relayUrl)||Sg;const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:et.pino(et.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||VI.logger}));this.logger=et.generateChildLogger(t,this.name),this.heartbeat=new qn.HeartBeat,this.crypto=new m3(this,this.logger,e==null?void 0:e.keychain),this.history=new M3(this,this.logger),this.expirer=new j3(this,this.logger),this.storage=e!=null&&e.storage?e.storage:new k6(Kd(Kd({},kI),e==null?void 0:e.storageOptions)),this.relayer=new U3({core:this,logger:this.logger,relayUrl:this.relayUrl,projectId:this.projectId}),this.pairing=new D3(this,this.logger),this.verify=new q3(this.projectId||"",this.logger)}static async init(e){const t=new fh(e);await t.initialize();const s=await t.crypto.getClientId();return await t.storage.setItem(c3,s),t}get context(){return et.getLoggerContext(this.logger)}async start(){this.initialized||await this.initialize()}async initialize(){this.logger.trace("Initialized");try{await this.crypto.init(),await this.history.init(),await this.expirer.init(),await this.relayer.init(),await this.heartbeat.init(),await this.pairing.init(),this.initialized=!0,this.logger.info("Core Initialization Success")}catch(e){throw this.logger.warn(`Core Initialization Failure at epoch ${Date.now()}`,e),this.logger.error(e.message),e}}}const K3=fh,Ig="wc",Og=2,Pg="client",dh=`${Ig}@${Og}:${Pg}:`,lu={name:Pg,logger:"error",controller:!1,relayUrl:"wss://relay.walletconnect.com"},Vd="WALLETCONNECT_DEEPLINK_CHOICE",V3="proposal",xg="Proposal expired",k3="session",Bo=ye.SEVEN_DAYS,G3="engine",_s={wc_sessionPropose:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1100},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1101}},wc_sessionSettle:{req:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1102},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1103}},wc_sessionUpdate:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1104},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1105}},wc_sessionExtend:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1106},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1107}},wc_sessionRequest:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1108},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1109}},wc_sessionEvent:{req:{ttl:ye.FIVE_MINUTES,prompt:!0,tag:1110},res:{ttl:ye.FIVE_MINUTES,prompt:!1,tag:1111}},wc_sessionDelete:{req:{ttl:ye.ONE_DAY,prompt:!1,tag:1112},res:{ttl:ye.ONE_DAY,prompt:!1,tag:1113}},wc_sessionPing:{req:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1114},res:{ttl:ye.THIRTY_SECONDS,prompt:!1,tag:1115}}},fu={min:ye.FIVE_MINUTES,max:ye.SEVEN_DAYS},bi={idle:"IDLE",active:"ACTIVE"},W3="request",Y3=["wc_sessionPropose","wc_sessionRequest","wc_authRequest"];var J3=Object.defineProperty,Q3=Object.defineProperties,X3=Object.getOwnPropertyDescriptors,kd=Object.getOwnPropertySymbols,Z3=Object.prototype.hasOwnProperty,e5=Object.prototype.propertyIsEnumerable,Gd=(i,e,t)=>e in i?J3(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,vr=(i,e)=>{for(var t in e||(e={}))Z3.call(e,t)&&Gd(i,t,e[t]);if(kd)for(var t of kd(e))e5.call(e,t)&&Gd(i,t,e[t]);return i},ms=(i,e)=>Q3(i,X3(e));class t5 extends Iw{constructor(e){super(e),this.name=G3,this.events=new Ku,this.initialized=!1,this.ignoredPayloadTypes=[un],this.requestQueue={state:bi.idle,queue:[]},this.sessionRequestQueue={state:bi.idle,queue:[]},this.requestQueueDelay=ye.ONE_SECOND,this.init=async()=>{this.initialized||(await this.cleanup(),this.registerRelayerEvents(),this.registerExpirerEvents(),this.client.core.pairing.register({methods:Object.keys(_s)}),this.initialized=!0,setTimeout(()=>{this.sessionRequestQueue.queue=this.getPendingSessionRequests(),this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay)))},this.connect=async t=>{await this.isInitialized();const s=ms(vr({},t),{requiredNamespaces:t.requiredNamespaces||{},optionalNamespaces:t.optionalNamespaces||{}});await this.isValidConnect(s);const{pairingTopic:o,requiredNamespaces:c,optionalNamespaces:d,sessionProperties:f,relays:g}=s;let y=o,b,x=!1;if(y&&(x=this.client.core.pairing.pairings.get(y).active),!y||!x){const{topic:D,uri:I}=await this.client.core.pairing.create();y=D,b=I}const P=await this.client.core.crypto.generateKeyPair(),A=vr({requiredNamespaces:c,optionalNamespaces:d,relays:g??[{protocol:Eg}],proposer:{publicKey:P,metadata:this.client.metadata}},f&&{sessionProperties:f}),{reject:q,resolve:z,done:K}=Un(ye.FIVE_MINUTES,xg);if(this.events.once(zt("session_connect"),async({error:D,session:I})=>{if(D)q(D);else if(I){I.self.publicKey=P;const N=ms(vr({},I),{requiredNamespaces:I.requiredNamespaces,optionalNamespaces:I.optionalNamespaces});await this.client.session.set(I.topic,N),await this.setExpiry(I.topic,I.expiry),y&&await this.client.core.pairing.updateMetadata({topic:y,metadata:I.peer.metadata}),z(N)}}),!y){const{message:D}=ue("NO_MATCHING_KEY",`connect() pairing topic: ${y}`);throw new Error(D)}const oe=await this.sendRequest({topic:y,method:"wc_sessionPropose",params:A}),C=Vr(ye.FIVE_MINUTES);return await this.setProposal(oe,vr({id:oe,expiry:C},A)),{uri:b,approval:K}},this.pair=async t=>(await this.isInitialized(),await this.client.core.pairing.pair(t)),this.approve=async t=>{await this.isInitialized(),await this.isValidApprove(t);const{id:s,relayProtocol:o,namespaces:c,sessionProperties:d}=t,f=this.client.proposal.get(s);let{pairingTopic:g,proposer:y,requiredNamespaces:b,optionalNamespaces:x}=f;g=g||"",Fn(b)||(b=qE(c,"approve()"));const P=await this.client.core.crypto.generateKeyPair(),A=y.publicKey,q=await this.client.core.crypto.generateSharedKey(P,A);g&&s&&(await this.client.core.pairing.updateMetadata({topic:g,metadata:y.metadata}),await this.sendResult({id:s,topic:g,result:{relay:{protocol:o??"irn"},responderPublicKey:P}}),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")),await this.client.core.pairing.activate({topic:g}));const z=vr({relay:{protocol:o??"irn"},namespaces:c,requiredNamespaces:b,optionalNamespaces:x,pairingTopic:g,controller:{publicKey:P,metadata:this.client.metadata},expiry:Vr(Bo)},d&&{sessionProperties:d});await this.client.core.relayer.subscribe(q),await this.sendRequest({topic:q,method:"wc_sessionSettle",params:z,throwOnFailedPublish:!0});const K=ms(vr({},z),{topic:q,pairingTopic:g,acknowledged:!1,self:z.controller,peer:{publicKey:y.publicKey,metadata:y.metadata},controller:P});return await this.client.session.set(q,K),await this.setExpiry(q,Vr(Bo)),{topic:q,acknowledged:()=>new Promise(oe=>setTimeout(()=>oe(this.client.session.get(q)),500))}},this.reject=async t=>{await this.isInitialized(),await this.isValidReject(t);const{id:s,reason:o}=t,{pairingTopic:c}=this.client.proposal.get(s);c&&(await this.sendError(s,c,o),await this.client.proposal.delete(s,$t("USER_DISCONNECTED")))},this.update=async t=>{await this.isInitialized(),await this.isValidUpdate(t);const{topic:s,namespaces:o}=t,c=await this.sendRequest({topic:s,method:"wc_sessionUpdate",params:{namespaces:o}}),{done:d,resolve:f,reject:g}=Un();return this.events.once(zt("session_update",c),({error:y})=>{y?g(y):f()}),await this.client.session.update(s,{namespaces:o}),{acknowledged:d}},this.extend=async t=>{await this.isInitialized(),await this.isValidExtend(t);const{topic:s}=t,o=await this.sendRequest({topic:s,method:"wc_sessionExtend",params:{}}),{done:c,resolve:d,reject:f}=Un();return this.events.once(zt("session_extend",o),({error:g})=>{g?f(g):d()}),await this.setExpiry(s,Vr(Bo)),{acknowledged:c}},this.request=async t=>{await this.isInitialized(),await this.isValidRequest(t);const{chainId:s,request:o,topic:c,expiry:d}=t,f=ch(),{done:g,resolve:y,reject:b}=Un(d);return this.events.once(zt("session_request",f),({error:x,result:P})=>{x?b(x):y(P)}),await Promise.all([new Promise(async x=>{await this.sendRequest({clientRpcId:f,topic:c,method:"wc_sessionRequest",params:{request:o,chainId:s},expiry:d,throwOnFailedPublish:!0}).catch(P=>b(P)),this.client.events.emit("session_request_sent",{topic:c,request:o,chainId:s,id:f}),x()}),new Promise(async x=>{const P=await this.client.core.storage.getItem(Vd);PE({id:f,topic:c,wcDeepLink:P}),x()}),g()]).then(x=>x[2])},this.respond=async t=>{await this.isInitialized(),await this.isValidRespond(t);const{topic:s,response:o}=t,{id:c}=o;Ei(o)?await this.sendResult({id:c,topic:s,result:o.result,throwOnFailedPublish:!0}):kr(o)&&await this.sendError(c,s,o.error),this.cleanupAfterResponse(t)},this.ping=async t=>{await this.isInitialized(),await this.isValidPing(t);const{topic:s}=t;if(this.client.session.keys.includes(s)){const o=await this.sendRequest({topic:s,method:"wc_sessionPing",params:{}}),{done:c,resolve:d,reject:f}=Un();this.events.once(zt("session_ping",o),({error:g})=>{g?f(g):d()}),await c()}else this.client.core.pairing.pairings.keys.includes(s)&&await this.client.core.pairing.ping({topic:s})},this.emit=async t=>{await this.isInitialized(),await this.isValidEmit(t);const{topic:s,event:o,chainId:c}=t;await this.sendRequest({topic:s,method:"wc_sessionEvent",params:{event:o,chainId:c}})},this.disconnect=async t=>{await this.isInitialized(),await this.isValidDisconnect(t);const{topic:s}=t;this.client.session.keys.includes(s)?(await this.sendRequest({topic:s,method:"wc_sessionDelete",params:$t("USER_DISCONNECTED"),throwOnFailedPublish:!0}),await this.deleteSession(s)):await this.client.core.pairing.disconnect({topic:s})},this.find=t=>(this.isInitialized(),this.client.session.getAll().filter(s=>zE(s,t))),this.getPendingSessionRequests=()=>(this.isInitialized(),this.client.pendingRequest.getAll()),this.cleanupDuplicatePairings=async t=>{if(t.pairingTopic)try{const s=this.client.core.pairing.pairings.get(t.pairingTopic),o=this.client.core.pairing.pairings.getAll().filter(c=>{var d,f;return((d=c.peerMetadata)==null?void 0:d.url)&&((f=c.peerMetadata)==null?void 0:f.url)===t.peer.metadata.url&&c.topic&&c.topic!==s.topic});if(o.length===0)return;this.client.logger.info(`Cleaning up ${o.length} duplicate pairing(s)`),await Promise.all(o.map(c=>this.client.core.pairing.disconnect({topic:c.topic}))),this.client.logger.info("Duplicate pairings clean up finished")}catch(s){this.client.logger.error(s)}},this.deleteSession=async(t,s)=>{const{self:o}=this.client.session.get(t);await this.client.core.relayer.unsubscribe(t),this.client.session.delete(t,$t("USER_DISCONNECTED")),this.client.core.crypto.keychain.has(o.publicKey)&&await this.client.core.crypto.deleteKeyPair(o.publicKey),this.client.core.crypto.keychain.has(t)&&await this.client.core.crypto.deleteSymKey(t),s||this.client.core.expirer.del(t),this.client.core.storage.removeItem(Vd).catch(c=>this.client.logger.warn(c))},this.deleteProposal=async(t,s)=>{await Promise.all([this.client.proposal.delete(t,$t("USER_DISCONNECTED")),s?Promise.resolve():this.client.core.expirer.del(t)])},this.deletePendingSessionRequest=async(t,s,o=!1)=>{await Promise.all([this.client.pendingRequest.delete(t,s),o?Promise.resolve():this.client.core.expirer.del(t)]),this.sessionRequestQueue.queue=this.sessionRequestQueue.queue.filter(c=>c.id!==t),o&&(this.sessionRequestQueue.state=bi.idle)},this.setExpiry=async(t,s)=>{this.client.session.keys.includes(t)&&await this.client.session.update(t,{expiry:s}),this.client.core.expirer.set(t,s)},this.setProposal=async(t,s)=>{await this.client.proposal.set(t,s),this.client.core.expirer.set(t,s.expiry)},this.setPendingSessionRequest=async t=>{const s=_s.wc_sessionRequest.req.ttl,{id:o,topic:c,params:d}=t;await this.client.pendingRequest.set(o,{id:o,topic:c,params:d}),s&&this.client.core.expirer.set(o,Vr(s))},this.sendRequest=async t=>{const{topic:s,method:o,params:c,expiry:d,relayRpcId:f,clientRpcId:g,throwOnFailedPublish:y}=t,b=Ns(o,c,g);if(Us()&&Y3.includes(o)){const A=Ln(JSON.stringify(b));this.client.core.verify.register({attestationId:A})}const x=await this.client.core.crypto.encode(s,b),P=_s[o].req;return d&&(P.ttl=d),f&&(P.id=f),this.client.core.history.set(s,b),y?(P.internal=ms(vr({},P.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(s,x,P)):this.client.core.relayer.publish(s,x,P).catch(A=>this.client.logger.error(A)),b.id},this.sendResult=async t=>{const{id:s,topic:o,result:c,throwOnFailedPublish:d}=t,f=uh(s,c),g=await this.client.core.crypto.encode(o,f),y=await this.client.core.history.get(o,s),b=_s[y.request.method].res;d?(b.internal=ms(vr({},b.internal),{throwOnFailedPublish:!0}),await this.client.core.relayer.publish(o,g,b)):this.client.core.relayer.publish(o,g,b).catch(x=>this.client.logger.error(x)),await this.client.core.history.resolve(f)},this.sendError=async(t,s,o)=>{const c=ya(t,o),d=await this.client.core.crypto.encode(s,c),f=await this.client.core.history.get(s,t),g=_s[f.request.method].res;this.client.core.relayer.publish(s,d,g),await this.client.core.history.resolve(c)},this.cleanup=async()=>{const t=[],s=[];this.client.session.getAll().forEach(o=>{$i(o.expiry)&&t.push(o.topic)}),this.client.proposal.getAll().forEach(o=>{$i(o.expiry)&&s.push(o.id)}),await Promise.all([...t.map(o=>this.deleteSession(o)),...s.map(o=>this.deleteProposal(o))])},this.onRelayEventRequest=async t=>{this.requestQueue.queue.push(t),await this.processRequestsQueue()},this.processRequestsQueue=async()=>{if(this.requestQueue.state===bi.active){this.client.logger.info("Request queue already active, skipping...");return}for(this.client.logger.info(`Request queue starting with ${this.requestQueue.queue.length} requests`);this.requestQueue.queue.length>0;){this.requestQueue.state=bi.active;const t=this.requestQueue.queue.shift();if(t)try{this.processRequest(t),await new Promise(s=>setTimeout(s,300))}catch(s){this.client.logger.warn(s)}}this.requestQueue.state=bi.idle},this.processRequest=t=>{const{topic:s,payload:o}=t,c=o.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeRequest(s,o);case"wc_sessionSettle":return this.onSessionSettleRequest(s,o);case"wc_sessionUpdate":return this.onSessionUpdateRequest(s,o);case"wc_sessionExtend":return this.onSessionExtendRequest(s,o);case"wc_sessionPing":return this.onSessionPingRequest(s,o);case"wc_sessionDelete":return this.onSessionDeleteRequest(s,o);case"wc_sessionRequest":return this.onSessionRequest(s,o);case"wc_sessionEvent":return this.onSessionEventRequest(s,o);default:return this.client.logger.info(`Unsupported request method ${c}`)}},this.onRelayEventResponse=async t=>{const{topic:s,payload:o}=t,c=(await this.client.core.history.get(s,o.id)).request.method;switch(c){case"wc_sessionPropose":return this.onSessionProposeResponse(s,o);case"wc_sessionSettle":return this.onSessionSettleResponse(s,o);case"wc_sessionUpdate":return this.onSessionUpdateResponse(s,o);case"wc_sessionExtend":return this.onSessionExtendResponse(s,o);case"wc_sessionPing":return this.onSessionPingResponse(s,o);case"wc_sessionRequest":return this.onSessionRequestResponse(s,o);default:return this.client.logger.info(`Unsupported response method ${c}`)}},this.onRelayEventUnknownPayload=t=>{const{topic:s}=t,{message:o}=ue("MISSING_OR_INVALID",`Decoded payload on topic ${s} is not identifiable as a JSON-RPC request or a response.`);throw new Error(o)},this.onSessionProposeRequest=async(t,s)=>{const{params:o,id:c}=s;try{this.isValidConnect(vr({},s.params));const d=Vr(ye.FIVE_MINUTES),f=vr({id:c,pairingTopic:t,expiry:d},o);await this.setProposal(c,f);const g=Ln(JSON.stringify(s)),y=await this.getVerifyContext(g,f.proposer.metadata);this.client.events.emit("session_proposal",{id:c,params:f,verifyContext:y})}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.onSessionProposeResponse=async(t,s)=>{const{id:o}=s;if(Ei(s)){const{result:c}=s;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",result:c});const d=this.client.proposal.get(o);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",proposal:d});const f=d.proposer.publicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",selfPublicKey:f});const g=c.responderPublicKey;this.client.logger.trace({type:"method",method:"onSessionProposeResponse",peerPublicKey:g});const y=await this.client.core.crypto.generateSharedKey(f,g);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",sessionTopic:y});const b=await this.client.core.relayer.subscribe(y);this.client.logger.trace({type:"method",method:"onSessionProposeResponse",subscriptionId:b}),await this.client.core.pairing.activate({topic:t})}else kr(s)&&(await this.client.proposal.delete(o,$t("USER_DISCONNECTED")),this.events.emit(zt("session_connect"),{error:s.error}))},this.onSessionSettleRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidSessionSettleRequest(c);const{relay:d,controller:f,expiry:g,namespaces:y,requiredNamespaces:b,optionalNamespaces:x,sessionProperties:P,pairingTopic:A}=s.params,q=vr({topic:t,relay:d,expiry:g,namespaces:y,acknowledged:!0,pairingTopic:A,requiredNamespaces:b,optionalNamespaces:x,controller:f.publicKey,self:{publicKey:"",metadata:this.client.metadata},peer:{publicKey:f.publicKey,metadata:f.metadata}},P&&{sessionProperties:P});await this.sendResult({id:s.id,topic:t,result:!0}),this.events.emit(zt("session_connect"),{session:q}),this.cleanupDuplicatePairings(q)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionSettleResponse=async(t,s)=>{const{id:o}=s;Ei(s)?(await this.client.session.update(t,{acknowledged:!0}),this.events.emit(zt("session_approve",o),{})):kr(s)&&(await this.client.session.delete(t,$t("USER_DISCONNECTED")),this.events.emit(zt("session_approve",o),{error:s.error}))},this.onSessionUpdateRequest=async(t,s)=>{const{params:o,id:c}=s;try{const d=`${t}_session_update`,f=Ho.get(d);if(f&&this.isRequestOutOfSync(f,c)){this.client.logger.info(`Discarding out of sync request - ${c}`);return}this.isValidUpdate(vr({topic:t},o)),await this.client.session.update(t,{namespaces:o.namespaces}),await this.sendResult({id:c,topic:t,result:!0}),this.client.events.emit("session_update",{id:c,topic:t,params:o}),Ho.set(d,c)}catch(d){await this.sendError(c,t,d),this.client.logger.error(d)}},this.isRequestOutOfSync=(t,s)=>parseInt(s.toString().slice(0,-3))<=parseInt(t.toString().slice(0,-3)),this.onSessionUpdateResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit(zt("session_update",o),{}):kr(s)&&this.events.emit(zt("session_update",o),{error:s.error})},this.onSessionExtendRequest=async(t,s)=>{const{id:o}=s;try{this.isValidExtend({topic:t}),await this.setExpiry(t,Vr(Bo)),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_extend",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionExtendResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit(zt("session_extend",o),{}):kr(s)&&this.events.emit(zt("session_extend",o),{error:s.error})},this.onSessionPingRequest=async(t,s)=>{const{id:o}=s;try{this.isValidPing({topic:t}),await this.sendResult({id:o,topic:t,result:!0}),this.client.events.emit("session_ping",{id:o,topic:t})}catch(c){await this.sendError(o,t,c),this.client.logger.error(c)}},this.onSessionPingResponse=(t,s)=>{const{id:o}=s;setTimeout(()=>{Ei(s)?this.events.emit(zt("session_ping",o),{}):kr(s)&&this.events.emit(zt("session_ping",o),{error:s.error})},500)},this.onSessionDeleteRequest=async(t,s)=>{const{id:o}=s;try{this.isValidDisconnect({topic:t,reason:s.params}),await Promise.all([new Promise(c=>{this.client.core.relayer.once(er.publish,async()=>{c(await this.deleteSession(t))})}),this.sendResult({id:o,topic:t,result:!0})]),this.client.events.emit("session_delete",{id:o,topic:t})}catch(c){this.client.logger.error(c)}},this.onSessionRequest=async(t,s)=>{const{id:o,params:c}=s;try{this.isValidRequest(vr({topic:t},c)),await this.setPendingSessionRequest({id:o,topic:t,params:c}),this.addSessionRequestToSessionRequestQueue({id:o,topic:t,params:c}),await this.processSessionRequestQueue()}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.onSessionRequestResponse=(t,s)=>{const{id:o}=s;Ei(s)?this.events.emit(zt("session_request",o),{result:s.result}):kr(s)&&this.events.emit(zt("session_request",o),{error:s.error})},this.onSessionEventRequest=async(t,s)=>{const{id:o,params:c}=s;try{const d=`${t}_session_event_${c.event.name}`,f=Ho.get(d);if(f&&this.isRequestOutOfSync(f,o)){this.client.logger.info(`Discarding out of sync request - ${o}`);return}this.isValidEmit(vr({topic:t},c)),this.client.events.emit("session_event",{id:o,topic:t,params:c}),Ho.set(d,o)}catch(d){await this.sendError(o,t,d),this.client.logger.error(d)}},this.addSessionRequestToSessionRequestQueue=t=>{this.sessionRequestQueue.queue.push(t)},this.cleanupAfterResponse=t=>{this.deletePendingSessionRequest(t.response.id,{message:"fulfilled",code:0}),setTimeout(()=>{this.sessionRequestQueue.state=bi.idle,this.processSessionRequestQueue()},ye.toMiliseconds(this.requestQueueDelay))},this.processSessionRequestQueue=async()=>{if(this.sessionRequestQueue.state===bi.active){this.client.logger.info("session request queue is already active.");return}const t=this.sessionRequestQueue.queue[0];if(!t){this.client.logger.info("session request queue is empty.");return}try{const{id:s,topic:o,params:c}=t,d=Ln(JSON.stringify(Ns("wc_sessionRequest",c,s))),f=this.client.session.get(o),g=await this.getVerifyContext(d,f.peer.metadata);this.sessionRequestQueue.state=bi.active,this.client.events.emit("session_request",{id:s,topic:o,params:c,verifyContext:g})}catch(s){this.client.logger.error(s)}},this.isValidConnect=async t=>{if(!yr(t)){const{message:g}=ue("MISSING_OR_INVALID",`connect() params: ${JSON.stringify(t)}`);throw new Error(g)}const{pairingTopic:s,requiredNamespaces:o,optionalNamespaces:c,sessionProperties:d,relays:f}=t;if(cr(s)||await this.isValidPairingTopic(s),!t6(f,!0)){const{message:g}=ue("MISSING_OR_INVALID",`connect() relays: ${f}`);throw new Error(g)}!cr(o)&&Fn(o)!==0&&this.validateNamespaces(o,"requiredNamespaces"),!cr(c)&&Fn(c)!==0&&this.validateNamespaces(c,"optionalNamespaces"),cr(d)||this.validateSessionProps(d,"sessionProperties")},this.validateNamespaces=(t,s)=>{const o=e6(t,"connect()",s);if(o)throw new Error(o.message)},this.isValidApprove=async t=>{if(!yr(t))throw new Error(ue("MISSING_OR_INVALID",`approve() params: ${t}`).message);const{id:s,namespaces:o,relayProtocol:c,sessionProperties:d}=t;await this.isValidProposalId(s);const f=this.client.proposal.get(s),g=ko(o,"approve()");if(g)throw new Error(g.message);const y=Kf(f.requiredNamespaces,o,"approve()");if(y)throw new Error(y.message);if(!Wt(c,!0)){const{message:b}=ue("MISSING_OR_INVALID",`approve() relayProtocol: ${c}`);throw new Error(b)}cr(d)||this.validateSessionProps(d,"sessionProperties")},this.isValidReject=async t=>{if(!yr(t)){const{message:c}=ue("MISSING_OR_INVALID",`reject() params: ${t}`);throw new Error(c)}const{id:s,reason:o}=t;if(await this.isValidProposalId(s),!i6(o)){const{message:c}=ue("MISSING_OR_INVALID",`reject() reason: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidSessionSettleRequest=t=>{if(!yr(t)){const{message:y}=ue("MISSING_OR_INVALID",`onSessionSettleRequest() params: ${t}`);throw new Error(y)}const{relay:s,controller:o,namespaces:c,expiry:d}=t;if(!Dp(s)){const{message:y}=ue("MISSING_OR_INVALID","onSessionSettleRequest() relay protocol should be a string");throw new Error(y)}const f=WE(o,"onSessionSettleRequest()");if(f)throw new Error(f.message);const g=ko(c,"onSessionSettleRequest()");if(g)throw new Error(g.message);if($i(d)){const{message:y}=ue("EXPIRED","onSessionSettleRequest()");throw new Error(y)}},this.isValidUpdate=async t=>{if(!yr(t)){const{message:g}=ue("MISSING_OR_INVALID",`update() params: ${t}`);throw new Error(g)}const{topic:s,namespaces:o}=t;await this.isValidSessionTopic(s);const c=this.client.session.get(s),d=ko(o,"update()");if(d)throw new Error(d.message);const f=Kf(c.requiredNamespaces,o,"update()");if(f)throw new Error(f.message)},this.isValidExtend=async t=>{if(!yr(t)){const{message:o}=ue("MISSING_OR_INVALID",`extend() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionTopic(s)},this.isValidRequest=async t=>{if(!yr(t)){const{message:g}=ue("MISSING_OR_INVALID",`request() params: ${t}`);throw new Error(g)}const{topic:s,request:o,chainId:c,expiry:d}=t;await this.isValidSessionTopic(s);const{namespaces:f}=this.client.session.get(s);if(!zf(f,c)){const{message:g}=ue("MISSING_OR_INVALID",`request() chainId: ${c}`);throw new Error(g)}if(!n6(o)){const{message:g}=ue("MISSING_OR_INVALID",`request() ${JSON.stringify(o)}`);throw new Error(g)}if(!a6(f,c,o.method)){const{message:g}=ue("MISSING_OR_INVALID",`request() method: ${o.method}`);throw new Error(g)}if(d&&!l6(d,fu)){const{message:g}=ue("MISSING_OR_INVALID",`request() expiry: ${d}. Expiry must be a number (in seconds) between ${fu.min} and ${fu.max}`);throw new Error(g)}},this.isValidRespond=async t=>{if(!yr(t)){const{message:c}=ue("MISSING_OR_INVALID",`respond() params: ${t}`);throw new Error(c)}const{topic:s,response:o}=t;if(await this.isValidSessionTopic(s),!s6(o)){const{message:c}=ue("MISSING_OR_INVALID",`respond() response: ${JSON.stringify(o)}`);throw new Error(c)}},this.isValidPing=async t=>{if(!yr(t)){const{message:o}=ue("MISSING_OR_INVALID",`ping() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.isValidEmit=async t=>{if(!yr(t)){const{message:f}=ue("MISSING_OR_INVALID",`emit() params: ${t}`);throw new Error(f)}const{topic:s,event:o,chainId:c}=t;await this.isValidSessionTopic(s);const{namespaces:d}=this.client.session.get(s);if(!zf(d,c)){const{message:f}=ue("MISSING_OR_INVALID",`emit() chainId: ${c}`);throw new Error(f)}if(!o6(o)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}if(!c6(d,c,o.name)){const{message:f}=ue("MISSING_OR_INVALID",`emit() event: ${JSON.stringify(o)}`);throw new Error(f)}},this.isValidDisconnect=async t=>{if(!yr(t)){const{message:o}=ue("MISSING_OR_INVALID",`disconnect() params: ${t}`);throw new Error(o)}const{topic:s}=t;await this.isValidSessionOrPairingTopic(s)},this.getVerifyContext=async(t,s)=>{const o={verified:{verifyUrl:s.verifyUrl||Go,validation:"UNKNOWN",origin:s.url||""}};try{const c=await this.client.core.verify.resolve({attestationId:t,verifyUrl:s.verifyUrl});c&&(o.verified.origin=c,o.verified.validation=c===new URL(s.url).origin?"VALID":"INVALID")}catch(c){this.client.logger.error(c)}return this.client.logger.info(`Verify context: ${JSON.stringify(o)}`),o},this.validateSessionProps=(t,s)=>{Object.values(t).forEach(o=>{if(!Wt(o,!1)){const{message:c}=ue("MISSING_OR_INVALID",`${s} must be in Record<string, string> format. Received: ${JSON.stringify(o)}`);throw new Error(c)}})}}async isInitialized(){if(!this.initialized){const{message:e}=ue("NOT_INITIALIZED",this.name);throw new Error(e)}await this.client.core.relayer.confirmOnlineStateOrThrow()}registerRelayerEvents(){this.client.core.relayer.on(er.message,async e=>{const{topic:t,message:s}=e;if(this.ignoredPayloadTypes.includes(this.client.core.crypto.getPayloadType(s)))return;const o=await this.client.core.crypto.decode(t,s);try{hh(o)?(this.client.core.history.set(t,o),this.onRelayEventRequest({topic:t,payload:o})):_a(o)?(await this.client.core.history.resolve(o),await this.onRelayEventResponse({topic:t,payload:o}),this.client.core.history.delete(t,o.id)):this.onRelayEventUnknownPayload({topic:t,payload:o})}catch(c){this.client.logger.error(c)}})}registerExpirerEvents(){this.client.core.expirer.on(Lr.expired,async e=>{const{topic:t,id:s}=Lp(e.target);if(s&&this.client.pendingRequest.keys.includes(s))return await this.deletePendingSessionRequest(s,ue("EXPIRED"),!0);t?this.client.session.keys.includes(t)&&(await this.deleteSession(t,!0),this.client.events.emit("session_expire",{topic:t})):s&&(await this.deleteProposal(s,!0),this.client.events.emit("proposal_expire",{id:s}))})}isValidPairingTopic(e){if(!Wt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`pairing topic should be a string: ${e}`);throw new Error(t)}if(!this.client.core.pairing.pairings.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`pairing topic doesn't exist: ${e}`);throw new Error(t)}if($i(this.client.core.pairing.pairings.get(e).expiry)){const{message:t}=ue("EXPIRED",`pairing topic: ${e}`);throw new Error(t)}}async isValidSessionTopic(e){if(!Wt(e,!1)){const{message:t}=ue("MISSING_OR_INVALID",`session topic should be a string: ${e}`);throw new Error(t)}if(!this.client.session.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`session topic doesn't exist: ${e}`);throw new Error(t)}if($i(this.client.session.get(e).expiry)){await this.deleteSession(e);const{message:t}=ue("EXPIRED",`session topic: ${e}`);throw new Error(t)}}async isValidSessionOrPairingTopic(e){if(this.client.session.keys.includes(e))await this.isValidSessionTopic(e);else if(this.client.core.pairing.pairings.keys.includes(e))this.isValidPairingTopic(e);else if(Wt(e,!1)){const{message:t}=ue("NO_MATCHING_KEY",`session or pairing topic doesn't exist: ${e}`);throw new Error(t)}else{const{message:t}=ue("MISSING_OR_INVALID",`session or pairing topic should be a string: ${e}`);throw new Error(t)}}async isValidProposalId(e){if(!r6(e)){const{message:t}=ue("MISSING_OR_INVALID",`proposal id should be a number: ${e}`);throw new Error(t)}if(!this.client.proposal.keys.includes(e)){const{message:t}=ue("NO_MATCHING_KEY",`proposal id doesn't exist: ${e}`);throw new Error(t)}if($i(this.client.proposal.get(e).expiry)){await this.deleteProposal(e);const{message:t}=ue("EXPIRED",`proposal id: ${e}`);throw new Error(t)}}}class r5 extends wa{constructor(e,t){super(e,t,V3,dh),this.core=e,this.logger=t}}class i5 extends wa{constructor(e,t){super(e,t,k3,dh),this.core=e,this.logger=t}}class n5 extends wa{constructor(e,t){super(e,t,W3,dh,s=>s.id),this.core=e,this.logger=t}}let s5=class Tg extends Sw{constructor(e){super(e),this.protocol=Ig,this.version=Og,this.name=lu.name,this.events=new Dr.EventEmitter,this.on=(s,o)=>this.events.on(s,o),this.once=(s,o)=>this.events.once(s,o),this.off=(s,o)=>this.events.off(s,o),this.removeListener=(s,o)=>this.events.removeListener(s,o),this.removeAllListeners=s=>this.events.removeAllListeners(s),this.connect=async s=>{try{return await this.engine.connect(s)}catch(o){throw this.logger.error(o.message),o}},this.pair=async s=>{try{return await this.engine.pair(s)}catch(o){throw this.logger.error(o.message),o}},this.approve=async s=>{try{return await this.engine.approve(s)}catch(o){throw this.logger.error(o.message),o}},this.reject=async s=>{try{return await this.engine.reject(s)}catch(o){throw this.logger.error(o.message),o}},this.update=async s=>{try{return await this.engine.update(s)}catch(o){throw this.logger.error(o.message),o}},this.extend=async s=>{try{return await this.engine.extend(s)}catch(o){throw this.logger.error(o.message),o}},this.request=async s=>{try{return await this.engine.request(s)}catch(o){throw this.logger.error(o.message),o}},this.respond=async s=>{try{return await this.engine.respond(s)}catch(o){throw this.logger.error(o.message),o}},this.ping=async s=>{try{return await this.engine.ping(s)}catch(o){throw this.logger.error(o.message),o}},this.emit=async s=>{try{return await this.engine.emit(s)}catch(o){throw this.logger.error(o.message),o}},this.disconnect=async s=>{try{return await this.engine.disconnect(s)}catch(o){throw this.logger.error(o.message),o}},this.find=s=>{try{return this.engine.find(s)}catch(o){throw this.logger.error(o.message),o}},this.getPendingSessionRequests=()=>{try{return this.engine.getPendingSessionRequests()}catch(s){throw this.logger.error(s.message),s}},this.name=(e==null?void 0:e.name)||lu.name,this.metadata=(e==null?void 0:e.metadata)||mE();const t=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:et.pino(et.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||lu.logger}));this.core=(e==null?void 0:e.core)||new K3(e),this.logger=et.generateChildLogger(t,this.name),this.session=new i5(this.core,this.logger),this.proposal=new r5(this.core,this.logger),this.pendingRequest=new n5(this.core,this.logger),this.engine=new t5(this)}static async init(e){const t=new Tg(e);return await t.initialize(),t}get context(){return et.getLoggerContext(this.logger)}get pairing(){return this.core.pairing.pairings}async initialize(){this.logger.trace("Initialized");try{await this.core.start(),await this.session.init(),await this.proposal.init(),await this.pendingRequest.init(),await this.engine.init(),this.core.verify.init({verifyUrl:this.metadata.verifyUrl}),this.logger.info("SignClient Initialization Success")}catch(e){throw this.logger.info("SignClient Initialization Failure"),this.logger.error(e.message),e}}};const o5={Accept:"application/json","Content-Type":"application/json"},a5="POST",Wd={headers:o5,method:a5},Yd=10;class hn{constructor(e,t=!1){if(this.url=e,this.disableProviderPing=t,this.events=new Dr.EventEmitter,this.isAvailable=!1,this.registering=!1,!Ed(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);this.url=e,this.disableProviderPing=t}get connected(){return this.isAvailable}get connecting(){return this.registering}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}off(e,t){this.events.off(e,t)}removeListener(e,t){this.events.removeListener(e,t)}async open(e=this.url){await this.register(e)}async close(){if(!this.isAvailable)throw new Error("Connection already closed");this.onClose()}async send(e,t){this.isAvailable||await this.register();try{const s=Ts(e),c=await(await vf(this.url,Object.assign(Object.assign({},Wd),{body:s}))).json();this.onPayload({data:c})}catch(s){this.onError(e.id,s)}}async register(e=this.url){if(!Ed(e))throw new Error(`Provided URL is not compatible with HTTP connection: ${e}`);if(this.registering){const t=this.events.getMaxListeners();return(this.events.listenerCount("register_error")>=t||this.events.listenerCount("open")>=t)&&this.events.setMaxListeners(t+1),new Promise((s,o)=>{this.events.once("register_error",c=>{this.resetMaxListeners(),o(c)}),this.events.once("open",()=>{if(this.resetMaxListeners(),typeof this.isAvailable>"u")return o(new Error("HTTP connection is missing or invalid"));s()})})}this.url=e,this.registering=!0;try{if(!this.disableProviderPing){const t=Ts({id:1,jsonrpc:"2.0",method:"test",params:[]});await vf(e,Object.assign(Object.assign({},Wd),{body:t}))}this.onOpen()}catch(t){const s=this.parseError(t);throw this.events.emit("register_error",s),this.onClose(),s}}onOpen(){this.isAvailable=!0,this.registering=!1,this.events.emit("open")}onClose(){this.isAvailable=!1,this.registering=!1,this.events.emit("close")}onPayload(e){if(typeof e.data>"u")return;const t=typeof e.data=="string"?rh(e.data):e.data;this.events.emit("payload",t)}onError(e,t){const s=this.parseError(t),o=s.message||s.toString(),c=ya(e,o);this.events.emit("payload",c)}parseError(e,t=this.url){return sg(e,t,"HTTP")}resetMaxListeners(){this.events.getMaxListeners()>Yd&&this.events.setMaxListeners(Yd)}}const Jd="error",c5="wss://relay.walletconnect.com",u5="wc",h5="universal_provider",Qd=`${u5}@2:${h5}:`,l5="https://rpc.walletconnect.com/v1",Mi={DEFAULT_CHAIN_CHANGED:"default_chain_changed"};var ws=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof ot.global<"u"?ot.global:typeof self<"u"?self:{},ju={exports:{}};/**
* @license
* Lodash <https://lodash.com/>
* Copyright OpenJS Foundation and other contributors <https://openjsf.org/>
* Released under MIT license <https://lodash.com/license>
* Based on Underscore.js 1.8.3 <http://underscorejs.org/LICENSE>
* Copyright Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
*/(function(i,e){(function(){var t,s="4.17.21",o=200,c="Unsupported core-js use. Try https://npms.io/search?q=ponyfill.",d="Expected a function",f="Invalid `variable` option passed into `_.template`",g="__lodash_hash_undefined__",y=500,b="__lodash_placeholder__",x=1,P=2,A=4,q=1,z=2,K=1,oe=2,C=4,D=8,I=16,N=32,w=64,h=128,m=256,G=512,k=30,se="...",ce=800,ge=16,U=1,H=2,le=3,te=1/0,W=9007199254740991,ee=17976931348623157e292,Y=0/0,re=4294967295,Pe=re-1,ie=re>>>1,we=[["ary",h],["bind",K],["bindKey",oe],["curry",D],["curryRight",I],["flip",G],["partial",N],["partialRight",w],["rearg",m]],he="[object Arguments]",_e="[object Array]",j="[object AsyncFunction]",M="[object Boolean]",R="[object Date]",l="[object DOMException]",O="[object Error]",ne="[object Function]",fe="[object GeneratorFunction]",Ie="[object Map]",Be="[object Number]",ke="[object Null]",Fe="[object Object]",vt="[object Promise]",yt="[object Proxy]",je="[object RegExp]",Oe="[object Set]",Ue="[object String]",$e="[object Symbol]",qe="[object Undefined]",Te="[object WeakMap]",Le="[object WeakSet]",Se="[object ArrayBuffer]",Ne="[object DataView]",ze="[object Float32Array]",xe="[object Float64Array]",Ge="[object Int8Array]",Ye="[object Int16Array]",tt="[object Int32Array]",rt="[object Uint8Array]",Qe="[object Uint8ClampedArray]",tr="[object Uint16Array]",hr="[object Uint32Array]",Jr=/\b__p \+= '';/g,rr=/\b(__p \+=) '' \+/g,oi=/(__e\(.*?\)|\b__t\)) \+\n'';/g,Si=/&(?:amp|lt|gt|quot|#39);/g,ji=/[&<>"']/g,St=RegExp(Si.source),_t=RegExp(ji.source),It=/<%-([\s\S]+?)%>/g,Ot=/<%([\s\S]+?)%>/g,bt=/<%=([\s\S]+?)%>/g,mt=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,Ft=/^\w*$/,Dt=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,Pt=/[\\^$.*+?()[\]{}|]/g,Mt=RegExp(Pt.source),xt=/^\s+/,At=/\s/,Tt=/\{(?:\n\/\* \[wrapped with .+\] \*\/)?\n?/,ft=/\{\n\/\* \[wrapped with (.+)\] \*/,jt=/,? & /,qt=/[^\x00-\x2f\x3a-\x40\x5b-\x60\x7b-\x7f]+/g,ba=/[()=,{}\[\]\/\s]/,Ea=/\\(\\)?/g,Sa=/\$\{([^\\}]*(?:\\.[^\\}]*)*)\}/g,Pr=/\w*$/,Ia=/^[-+]0x[0-9a-f]+$/i,Oa=/^0b[01]+$/i,Pa=/^\[object .+?Constructor\]$/,xa=/^0o[0-7]+$/i,Ta=/^(?:0|[1-9]\d*)$/,ai=/[\xc0-\xd6\xd8-\xf6\xf8-\xff\u0100-\u017f]/g,ln=/($^)/,Na=/['\n\r\u2028\u2029\\]/g,fn="\\ud800-\\udfff",Aa="\\u0300-\\u036f",Ra="\\ufe20-\\ufe2f",dn="\\u20d0-\\u20ff",Fs=Aa+Ra+dn,Ds="\\u2700-\\u27bf",jr="a-z\\xdf-\\xf6\\xf8-\\xff",Ca="\\xac\\xb1\\xd7\\xf7",Ua="\\x00-\\x2f\\x3a-\\x40\\x5b-\\x60\\x7b-\\xbf",$a="\\u2000-\\u206f",La=" \\t\\x0b\\f\\xa0\\ufeff\\n\\r\\u2028\\u2029\\u1680\\u180e\\u2000\\u2001\\u2002\\u2003\\u2004\\u2005\\u2006\\u2007\\u2008\\u2009\\u200a\\u202f\\u205f\\u3000",Ms="A-Z\\xc0-\\xd6\\xd8-\\xde",js="\\ufe0e\\ufe0f",qi=Ca+Ua+$a+La,Bn="['’]",Hi="["+fn+"]",zn="["+qi+"]",Bi="["+Fs+"]",qs="\\d+",Fa="["+Ds+"]",Hs="["+jr+"]",Bs="[^"+fn+qi+qs+Ds+jr+Ms+"]",pn="\\ud83c[\\udffb-\\udfff]",Da="(?:"+Bi+"|"+pn+")",zs="[^"+fn+"]",gn="(?:\\ud83c[\\udde6-\\uddff]){2}",Ii="[\\ud800-\\udbff][\\udc00-\\udfff]",_r="["+Ms+"]",Ks="\\u200d",Vs="(?:"+Hs+"|"+Bs+")",Qr="(?:"+_r+"|"+Bs+")",ks="(?:"+Bn+"(?:d|ll|m|re|s|t|ve))?",Gs="(?:"+Bn+"(?:D|LL|M|RE|S|T|VE))?",Ws=Da+"?",Ys="["+js+"]?",Ma="(?:"+Ks+"(?:"+[zs,gn,Ii].join("|")+")"+Ys+Ws+")*",ci="\\d*(?:1st|2nd|3rd|(?![123])\\dth)(?=\\b|[A-Z_])",Js="\\d*(?:1ST|2ND|3RD|(?![123])\\dTH)(?=\\b|[a-z_])",Qs=Ys+Ws+Ma,vn="(?:"+[Fa,gn,Ii].join("|")+")"+Qs,ja="(?:"+[zs+Bi+"?",Bi,gn,Ii,Hi].join("|")+")",Kn=RegExp(Bn,"g"),qa=RegExp(Bi,"g"),yn=RegExp(pn+"(?="+pn+")|"+ja+Qs,"g"),Xs=RegExp([_r+"?"+Hs+"+"+ks+"(?="+[zn,_r,"$"].join("|")+")",Qr+"+"+Gs+"(?="+[zn,_r+Vs,"$"].join("|")+")",_r+"?"+Vs+"+"+ks,_r+"+"+Gs,Js,ci,qs,vn].join("|"),"g"),Zs=RegExp("["+Ks+fn+Fs+js+"]"),zi=/[a-z][A-Z]|[A-Z]{2}[a-z]|[0-9][a-zA-Z]|[a-zA-Z][0-9]|[^a-zA-Z0-9 ]/,eo=["Array","Buffer","DataView","Date","Error","Float32Array","Float64Array","Function","Int8Array","Int16Array","Int32Array","Map","Math","Object","Promise","RegExp","Set","String","Symbol","TypeError","Uint8Array","Uint8ClampedArray","Uint16Array","Uint32Array","WeakMap","_","clearTimeout","isFinite","parseInt","setTimeout"],Ha=-1,ct={};ct[ze]=ct[xe]=ct[Ge]=ct[Ye]=ct[tt]=ct[rt]=ct[Qe]=ct[tr]=ct[hr]=!0,ct[he]=ct[_e]=ct[Se]=ct[M]=ct[Ne]=ct[R]=ct[O]=ct[ne]=ct[Ie]=ct[Be]=ct[Fe]=ct[je]=ct[Oe]=ct[Ue]=ct[Te]=!1;var at={};at[he]=at[_e]=at[Se]=at[Ne]=at[M]=at[R]=at[ze]=at[xe]=at[Ge]=at[Ye]=at[tt]=at[Ie]=at[Be]=at[Fe]=at[je]=at[Oe]=at[Ue]=at[$e]=at[rt]=at[Qe]=at[tr]=at[hr]=!0,at[O]=at[ne]=at[Te]=!1;var E={À:"A",Á:"A",Â:"A",Ã:"A",Ä:"A",Å:"A",à:"a",á:"a",â:"a",ã:"a",ä:"a",å:"a",Ç:"C",ç:"c",Ð:"D",ð:"d",È:"E",É:"E",Ê:"E",Ë:"E",è:"e",é:"e",ê:"e",ë:"e",Ì:"I",Í:"I",Î:"I",Ï:"I",ì:"i",í:"i",î:"i",ï:"i",Ñ:"N",ñ:"n",Ò:"O",Ó:"O",Ô:"O",Õ:"O",Ö:"O",Ø:"O",ò:"o",ó:"o",ô:"o",õ:"o",ö:"o",ø:"o",Ù:"U",Ú:"U",Û:"U",Ü:"U",ù:"u",ú:"u",û:"u",ü:"u",Ý:"Y",ý:"y",ÿ:"y",Æ:"Ae",æ:"ae",Þ:"Th",þ:"th",ß:"ss",Ā:"A",Ă:"A",Ą:"A",ā:"a",ă:"a",ą:"a",Ć:"C",Ĉ:"C",Ċ:"C",Č:"C",ć:"c",ĉ:"c",ċ:"c",č:"c",Ď:"D",Đ:"D",ď:"d",đ:"d",Ē:"E",Ĕ:"E",Ė:"E",Ę:"E",Ě:"E",ē:"e",ĕ:"e",ė:"e",ę:"e",ě:"e",Ĝ:"G",Ğ:"G",Ġ:"G",Ģ:"G",ĝ:"g",ğ:"g",ġ:"g",ģ:"g",Ĥ:"H",Ħ:"H",ĥ:"h",ħ:"h",Ĩ:"I",Ī:"I",Ĭ:"I",Į:"I",İ:"I",ĩ:"i",ī:"i",ĭ:"i",į:"i",ı:"i",Ĵ:"J",ĵ:"j",Ķ:"K",ķ:"k",ĸ:"k",Ĺ:"L",Ļ:"L",Ľ:"L",Ŀ:"L",Ł:"L",ĺ:"l",ļ:"l",ľ:"l",ŀ:"l",ł:"l",Ń:"N",Ņ:"N",Ň:"N",Ŋ:"N",ń:"n",ņ:"n",ň:"n",ŋ:"n",Ō:"O",Ŏ:"O",Ő:"O",ō:"o",ŏ:"o",ő:"o",Ŕ:"R",Ŗ:"R",Ř:"R",ŕ:"r",ŗ:"r",ř:"r",Ś:"S",Ŝ:"S",Ş:"S",Š:"S",ś:"s",ŝ:"s",ş:"s",š:"s",Ţ:"T",Ť:"T",Ŧ:"T",ţ:"t",ť:"t",ŧ:"t",Ũ:"U",Ū:"U",Ŭ:"U",Ů:"U",Ű:"U",Ų:"U",ũ:"u",ū:"u",ŭ:"u",ů:"u",ű:"u",ų:"u",Ŵ:"W",ŵ:"w",Ŷ:"Y",ŷ:"y",Ÿ:"Y",Ź:"Z",Ż:"Z",Ž:"Z",ź:"z",ż:"z",ž:"z",Ĳ:"IJ",ĳ:"ij",Œ:"Oe",œ:"oe",ŉ:"'n",ſ:"s"},$={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},X={"&amp;":"&","&lt;":"<","&gt;":">","&quot;":'"',"&#39;":"'"},de={"\\":"\\","'":"'","\n":"n","\r":"r","\u2028":"u2028","\u2029":"u2029"},ut=parseFloat,Re=parseInt,pt=typeof ws=="object"&&ws&&ws.Object===Object&&ws,Ht=typeof self=="object"&&self&&self.Object===Object&&self,Xe=pt||Ht||Function("return this")(),ht=e&&!e.nodeType&&e,Rt=ht&&!0&&i&&!i.nodeType&&i,lr=Rt&&Rt.exports===ht,Bt=lr&&pt.process,gt=function(){try{var L=Rt&&Rt.require&&Rt.require("util").types;return L||Bt&&Bt.binding&&Bt.binding("util")}catch{}}(),ir=gt&&gt.isArrayBuffer,qr=gt&&gt.isDate,xr=gt&&gt.isMap,Xr=gt&&gt.isRegExp,Vn=gt&&gt.isSet,Ki=gt&&gt.isTypedArray;function kt(L,V,B){switch(B.length){case 0:return L.call(V);case 1:return L.call(V,B[0]);case 2:return L.call(V,B[0],B[1]);case 3:return L.call(V,B[0],B[1],B[2])}return L.apply(V,B)}function Rg(L,V,B,pe){for(var Ae=-1,it=L==null?0:L.length;++Ae<it;){var Kt=L[Ae];V(pe,Kt,B(Kt),L)}return pe}function Tr(L,V){for(var B=-1,pe=L==null?0:L.length;++B<pe&&V(L[B],B,L)!==!1;);return L}function Cg(L,V){for(var B=L==null?0:L.length;B--&&V(L[B],B,L)!==!1;);return L}function vh(L,V){for(var B=-1,pe=L==null?0:L.length;++B<pe;)if(!V(L[B],B,L))return!1;return!0}function Oi(L,V){for(var B=-1,pe=L==null?0:L.length,Ae=0,it=[];++B<pe;){var Kt=L[B];V(Kt,B,L)&&(it[Ae++]=Kt)}return it}function to(L,V){var B=L==null?0:L.length;return!!B&&_n(L,V,0)>-1}function Ba(L,V,B){for(var pe=-1,Ae=L==null?0:L.length;++pe<Ae;)if(B(V,L[pe]))return!0;return!1}function wt(L,V){for(var B=-1,pe=L==null?0:L.length,Ae=Array(pe);++B<pe;)Ae[B]=V(L[B],B,L);return Ae}function Pi(L,V){for(var B=-1,pe=V.length,Ae=L.length;++B<pe;)L[Ae+B]=V[B];return L}function za(L,V,B,pe){var Ae=-1,it=L==null?0:L.length;for(pe&&it&&(B=L[++Ae]);++Ae<it;)B=V(B,L[Ae],Ae,L);return B}function Ug(L,V,B,pe){var Ae=L==null?0:L.length;for(pe&&Ae&&(B=L[--Ae]);Ae--;)B=V(B,L[Ae],Ae,L);return B}function Ka(L,V){for(var B=-1,pe=L==null?0:L.length;++B<pe;)if(V(L[B],B,L))return!0;return!1}var $g=Va("length");function Lg(L){return L.split("")}function Fg(L){return L.match(qt)||[]}function yh(L,V,B){var pe;return B(L,function(Ae,it,Kt){if(V(Ae,it,Kt))return pe=it,!1}),pe}function ro(L,V,B,pe){for(var Ae=L.length,it=B+(pe?1:-1);pe?it--:++it<Ae;)if(V(L[it],it,L))return it;return-1}function _n(L,V,B){return V===V?Wg(L,V,B):ro(L,_h,B)}function Dg(L,V,B,pe){for(var Ae=B-1,it=L.length;++Ae<it;)if(pe(L[Ae],V))return Ae;return-1}function _h(L){return L!==L}function mh(L,V){var B=L==null?0:L.length;return B?Ga(L,V)/B:Y}function Va(L){return function(V){return V==null?t:V[L]}}function ka(L){return function(V){return L==null?t:L[V]}}function wh(L,V,B,pe,Ae){return Ae(L,function(it,Kt,lt){B=pe?(pe=!1,it):V(B,it,Kt,lt)}),B}function Mg(L,V){var B=L.length;for(L.sort(V);B--;)L[B]=L[B].value;return L}function Ga(L,V){for(var B,pe=-1,Ae=L.length;++pe<Ae;){var it=V(L[pe]);it!==t&&(B=B===t?it:B+it)}return B}function Wa(L,V){for(var B=-1,pe=Array(L);++B<L;)pe[B]=V(B);return pe}function jg(L,V){return wt(V,function(B){return[B,L[B]]})}function bh(L){return L&&L.slice(0,Oh(L)+1).replace(xt,"")}function mr(L){return function(V){return L(V)}}function Ya(L,V){return wt(V,function(B){return L[B]})}function kn(L,V){return L.has(V)}function Eh(L,V){for(var B=-1,pe=L.length;++B<pe&&_n(V,L[B],0)>-1;);return B}function Sh(L,V){for(var B=L.length;B--&&_n(V,L[B],0)>-1;);return B}function qg(L,V){for(var B=L.length,pe=0;B--;)L[B]===V&&++pe;return pe}var Hg=ka(E),Bg=ka($);function zg(L){return"\\"+de[L]}function Kg(L,V){return L==null?t:L[V]}function mn(L){return Zs.test(L)}function Vg(L){return zi.test(L)}function kg(L){for(var V,B=[];!(V=L.next()).done;)B.push(V.value);return B}function Ja(L){var V=-1,B=Array(L.size);return L.forEach(function(pe,Ae){B[++V]=[Ae,pe]}),B}function Ih(L,V){return function(B){return L(V(B))}}function xi(L,V){for(var B=-1,pe=L.length,Ae=0,it=[];++B<pe;){var Kt=L[B];(Kt===V||Kt===b)&&(L[B]=b,it[Ae++]=B)}return it}function io(L){var V=-1,B=Array(L.size);return L.forEach(function(pe){B[++V]=pe}),B}function Gg(L){var V=-1,B=Array(L.size);return L.forEach(function(pe){B[++V]=[pe,pe]}),B}function Wg(L,V,B){for(var pe=B-1,Ae=L.length;++pe<Ae;)if(L[pe]===V)return pe;return-1}function Yg(L,V,B){for(var pe=B+1;pe--;)if(L[pe]===V)return pe;return pe}function wn(L){return mn(L)?Qg(L):$g(L)}function Hr(L){return mn(L)?Xg(L):Lg(L)}function Oh(L){for(var V=L.length;V--&&At.test(L.charAt(V)););return V}var Jg=ka(X);function Qg(L){for(var V=yn.lastIndex=0;yn.test(L);)++V;return V}function Xg(L){return L.match(yn)||[]}function Zg(L){return L.match(Xs)||[]}var e0=function L(V){V=V==null?Xe:bn.defaults(Xe.Object(),V,bn.pick(Xe,eo));var B=V.Array,pe=V.Date,Ae=V.Error,it=V.Function,Kt=V.Math,lt=V.Object,Qa=V.RegExp,t0=V.String,Nr=V.TypeError,no=B.prototype,r0=it.prototype,En=lt.prototype,so=V["__core-js_shared__"],oo=r0.toString,st=En.hasOwnProperty,i0=0,Ph=function(){var r=/[^.]+$/.exec(so&&so.keys&&so.keys.IE_PROTO||"");return r?"Symbol(src)_1."+r:""}(),ao=En.toString,n0=oo.call(lt),s0=Xe._,o0=Qa("^"+oo.call(st).replace(Pt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$"),co=lr?V.Buffer:t,Ti=V.Symbol,uo=V.Uint8Array,xh=co?co.allocUnsafe:t,ho=Ih(lt.getPrototypeOf,lt),Th=lt.create,Nh=En.propertyIsEnumerable,lo=no.splice,Ah=Ti?Ti.isConcatSpreadable:t,Gn=Ti?Ti.iterator:t,Vi=Ti?Ti.toStringTag:t,fo=function(){try{var r=Ji(lt,"defineProperty");return r({},"",{}),r}catch{}}(),a0=V.clearTimeout!==Xe.clearTimeout&&V.clearTimeout,c0=pe&&pe.now!==Xe.Date.now&&pe.now,u0=V.setTimeout!==Xe.setTimeout&&V.setTimeout,po=Kt.ceil,go=Kt.floor,Xa=lt.getOwnPropertySymbols,h0=co?co.isBuffer:t,Rh=V.isFinite,l0=no.join,f0=Ih(lt.keys,lt),Vt=Kt.max,Qt=Kt.min,d0=pe.now,p0=V.parseInt,Ch=Kt.random,g0=no.reverse,Za=Ji(V,"DataView"),Wn=Ji(V,"Map"),ec=Ji(V,"Promise"),Sn=Ji(V,"Set"),Yn=Ji(V,"WeakMap"),Jn=Ji(lt,"create"),vo=Yn&&new Yn,In={},v0=Qi(Za),y0=Qi(Wn),_0=Qi(ec),m0=Qi(Sn),w0=Qi(Yn),yo=Ti?Ti.prototype:t,Qn=yo?yo.valueOf:t,Uh=yo?yo.toString:t;function v(r){if(Nt(r)&&!Ce(r)&&!(r instanceof Je)){if(r instanceof Ar)return r;if(st.call(r,"__wrapped__"))return $l(r)}return new Ar(r)}var On=function(){function r(){}return function(n){if(!Et(n))return{};if(Th)return Th(n);r.prototype=n;var a=new r;return r.prototype=t,a}}();function _o(){}function Ar(r,n){this.__wrapped__=r,this.__actions__=[],this.__chain__=!!n,this.__index__=0,this.__values__=t}v.templateSettings={escape:It,evaluate:Ot,interpolate:bt,variable:"",imports:{_:v}},v.prototype=_o.prototype,v.prototype.constructor=v,Ar.prototype=On(_o.prototype),Ar.prototype.constructor=Ar;function Je(r){this.__wrapped__=r,this.__actions__=[],this.__dir__=1,this.__filtered__=!1,this.__iteratees__=[],this.__takeCount__=re,this.__views__=[]}function b0(){var r=new Je(this.__wrapped__);return r.__actions__=fr(this.__actions__),r.__dir__=this.__dir__,r.__filtered__=this.__filtered__,r.__iteratees__=fr(this.__iteratees__),r.__takeCount__=this.__takeCount__,r.__views__=fr(this.__views__),r}function E0(){if(this.__filtered__){var r=new Je(this);r.__dir__=-1,r.__filtered__=!0}else r=this.clone(),r.__dir__*=-1;return r}function S0(){var r=this.__wrapped__.value(),n=this.__dir__,a=Ce(r),u=n<0,p=a?r.length:0,_=L1(0,p,this.__views__),S=_.start,T=_.end,F=T-S,J=u?T:S-1,Q=this.__iteratees__,Z=Q.length,ae=0,ve=Qt(F,this.__takeCount__);if(!a||!u&&p==F&&ve==F)return il(r,this.__actions__);var be=[];e:for(;F--&&ae<ve;){J+=n;for(var He=-1,Ee=r[J];++He<Z;){var We=Q[He],Ze=We.iteratee,Er=We.type,or=Ze(Ee);if(Er==H)Ee=or;else if(!or){if(Er==U)continue e;break e}}be[ae++]=Ee}return be}Je.prototype=On(_o.prototype),Je.prototype.constructor=Je;function ki(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function I0(){this.__data__=Jn?Jn(null):{},this.size=0}function O0(r){var n=this.has(r)&&delete this.__data__[r];return this.size-=n?1:0,n}function P0(r){var n=this.__data__;if(Jn){var a=n[r];return a===g?t:a}return st.call(n,r)?n[r]:t}function x0(r){var n=this.__data__;return Jn?n[r]!==t:st.call(n,r)}function T0(r,n){var a=this.__data__;return this.size+=this.has(r)?0:1,a[r]=Jn&&n===t?g:n,this}ki.prototype.clear=I0,ki.prototype.delete=O0,ki.prototype.get=P0,ki.prototype.has=x0,ki.prototype.set=T0;function ui(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function N0(){this.__data__=[],this.size=0}function A0(r){var n=this.__data__,a=mo(n,r);if(a<0)return!1;var u=n.length-1;return a==u?n.pop():lo.call(n,a,1),--this.size,!0}function R0(r){var n=this.__data__,a=mo(n,r);return a<0?t:n[a][1]}function C0(r){return mo(this.__data__,r)>-1}function U0(r,n){var a=this.__data__,u=mo(a,r);return u<0?(++this.size,a.push([r,n])):a[u][1]=n,this}ui.prototype.clear=N0,ui.prototype.delete=A0,ui.prototype.get=R0,ui.prototype.has=C0,ui.prototype.set=U0;function hi(r){var n=-1,a=r==null?0:r.length;for(this.clear();++n<a;){var u=r[n];this.set(u[0],u[1])}}function $0(){this.size=0,this.__data__={hash:new ki,map:new(Wn||ui),string:new ki}}function L0(r){var n=Ro(this,r).delete(r);return this.size-=n?1:0,n}function F0(r){return Ro(this,r).get(r)}function D0(r){return Ro(this,r).has(r)}function M0(r,n){var a=Ro(this,r),u=a.size;return a.set(r,n),this.size+=a.size==u?0:1,this}hi.prototype.clear=$0,hi.prototype.delete=L0,hi.prototype.get=F0,hi.prototype.has=D0,hi.prototype.set=M0;function Gi(r){var n=-1,a=r==null?0:r.length;for(this.__data__=new hi;++n<a;)this.add(r[n])}function j0(r){return this.__data__.set(r,g),this}function q0(r){return this.__data__.has(r)}Gi.prototype.add=Gi.prototype.push=j0,Gi.prototype.has=q0;function Br(r){var n=this.__data__=new ui(r);this.size=n.size}function H0(){this.__data__=new ui,this.size=0}function B0(r){var n=this.__data__,a=n.delete(r);return this.size=n.size,a}function z0(r){return this.__data__.get(r)}function K0(r){return this.__data__.has(r)}function V0(r,n){var a=this.__data__;if(a instanceof ui){var u=a.__data__;if(!Wn||u.length<o-1)return u.push([r,n]),this.size=++a.size,this;a=this.__data__=new hi(u)}return a.set(r,n),this.size=a.size,this}Br.prototype.clear=H0,Br.prototype.delete=B0,Br.prototype.get=z0,Br.prototype.has=K0,Br.prototype.set=V0;function $h(r,n){var a=Ce(r),u=!a&&Xi(r),p=!a&&!u&&Ui(r),_=!a&&!u&&!p&&Nn(r),S=a||u||p||_,T=S?Wa(r.length,t0):[],F=T.length;for(var J in r)(n||st.call(r,J))&&!(S&&(J=="length"||p&&(J=="offset"||J=="parent")||_&&(J=="buffer"||J=="byteLength"||J=="byteOffset")||pi(J,F)))&&T.push(J);return T}function Lh(r){var n=r.length;return n?r[lc(0,n-1)]:t}function k0(r,n){return Co(fr(r),Wi(n,0,r.length))}function G0(r){return Co(fr(r))}function tc(r,n,a){(a!==t&&!zr(r[n],a)||a===t&&!(n in r))&&li(r,n,a)}function Xn(r,n,a){var u=r[n];(!(st.call(r,n)&&zr(u,a))||a===t&&!(n in r))&&li(r,n,a)}function mo(r,n){for(var a=r.length;a--;)if(zr(r[a][0],n))return a;return-1}function W0(r,n,a,u){return Ni(r,function(p,_,S){n(u,p,a(p),S)}),u}function Fh(r,n){return r&&ei(n,Gt(n),r)}function Y0(r,n){return r&&ei(n,pr(n),r)}function li(r,n,a){n=="__proto__"&&fo?fo(r,n,{configurable:!0,enumerable:!0,value:a,writable:!0}):r[n]=a}function rc(r,n){for(var a=-1,u=n.length,p=B(u),_=r==null;++a<u;)p[a]=_?t:Fc(r,n[a]);return p}function Wi(r,n,a){return r===r&&(a!==t&&(r=r<=a?r:a),n!==t&&(r=r>=n?r:n)),r}function Rr(r,n,a,u,p,_){var S,T=n&x,F=n&P,J=n&A;if(a&&(S=p?a(r,u,p,_):a(r)),S!==t)return S;if(!Et(r))return r;var Q=Ce(r);if(Q){if(S=D1(r),!T)return fr(r,S)}else{var Z=Xt(r),ae=Z==ne||Z==fe;if(Ui(r))return ol(r,T);if(Z==Fe||Z==he||ae&&!p){if(S=F||ae?{}:Ol(r),!T)return F?P1(r,Y0(S,r)):O1(r,Fh(S,r))}else{if(!at[Z])return p?r:{};S=M1(r,Z,T)}}_||(_=new Br);var ve=_.get(r);if(ve)return ve;_.set(r,S),ef(r)?r.forEach(function(Ee){S.add(Rr(Ee,n,a,Ee,r,_))}):Xl(r)&&r.forEach(function(Ee,We){S.set(We,Rr(Ee,n,a,We,r,_))});var be=J?F?Ec:bc:F?pr:Gt,He=Q?t:be(r);return Tr(He||r,function(Ee,We){He&&(We=Ee,Ee=r[We]),Xn(S,We,Rr(Ee,n,a,We,r,_))}),S}function J0(r){var n=Gt(r);return function(a){return Dh(a,r,n)}}function Dh(r,n,a){var u=a.length;if(r==null)return!u;for(r=lt(r);u--;){var p=a[u],_=n[p],S=r[p];if(S===t&&!(p in r)||!_(S))return!1}return!0}function Mh(r,n,a){if(typeof r!="function")throw new Nr(d);return ss(function(){r.apply(t,a)},n)}function Zn(r,n,a,u){var p=-1,_=to,S=!0,T=r.length,F=[],J=n.length;if(!T)return F;a&&(n=wt(n,mr(a))),u?(_=Ba,S=!1):n.length>=o&&(_=kn,S=!1,n=new Gi(n));e:for(;++p<T;){var Q=r[p],Z=a==null?Q:a(Q);if(Q=u||Q!==0?Q:0,S&&Z===Z){for(var ae=J;ae--;)if(n[ae]===Z)continue e;F.push(Q)}else _(n,Z,u)||F.push(Q)}return F}var Ni=ll(Zr),jh=ll(nc,!0);function Q0(r,n){var a=!0;return Ni(r,function(u,p,_){return a=!!n(u,p,_),a}),a}function wo(r,n,a){for(var u=-1,p=r.length;++u<p;){var _=r[u],S=n(_);if(S!=null&&(T===t?S===S&&!br(S):a(S,T)))var T=S,F=_}return F}function X0(r,n,a,u){var p=r.length;for(a=De(a),a<0&&(a=-a>p?0:p+a),u=u===t||u>p?p:De(u),u<0&&(u+=p),u=a>u?0:rf(u);a<u;)r[a++]=n;return r}function qh(r,n){var a=[];return Ni(r,function(u,p,_){n(u,p,_)&&a.push(u)}),a}function Yt(r,n,a,u,p){var _=-1,S=r.length;for(a||(a=q1),p||(p=[]);++_<S;){var T=r[_];n>0&&a(T)?n>1?Yt(T,n-1,a,u,p):Pi(p,T):u||(p[p.length]=T)}return p}var ic=fl(),Hh=fl(!0);function Zr(r,n){return r&&ic(r,n,Gt)}function nc(r,n){return r&&Hh(r,n,Gt)}function bo(r,n){return Oi(n,function(a){return gi(r[a])})}function Yi(r,n){n=Ri(n,r);for(var a=0,u=n.length;r!=null&&a<u;)r=r[ti(n[a++])];return a&&a==u?r:t}function Bh(r,n,a){var u=n(r);return Ce(r)?u:Pi(u,a(r))}function nr(r){return r==null?r===t?qe:ke:Vi&&Vi in lt(r)?$1(r):G1(r)}function sc(r,n){return r>n}function Z0(r,n){return r!=null&&st.call(r,n)}function e1(r,n){return r!=null&&n in lt(r)}function t1(r,n,a){return r>=Qt(n,a)&&r<Vt(n,a)}function oc(r,n,a){for(var u=a?Ba:to,p=r[0].length,_=r.length,S=_,T=B(_),F=1/0,J=[];S--;){var Q=r[S];S&&n&&(Q=wt(Q,mr(n))),F=Qt(Q.length,F),T[S]=!a&&(n||p>=120&&Q.length>=120)?new Gi(S&&Q):t}Q=r[0];var Z=-1,ae=T[0];e:for(;++Z<p&&J.length<F;){var ve=Q[Z],be=n?n(ve):ve;if(ve=a||ve!==0?ve:0,!(ae?kn(ae,be):u(J,be,a))){for(S=_;--S;){var He=T[S];if(!(He?kn(He,be):u(r[S],be,a)))continue e}ae&&ae.push(be),J.push(ve)}}return J}function r1(r,n,a,u){return Zr(r,function(p,_,S){n(u,a(p),_,S)}),u}function es(r,n,a){n=Ri(n,r),r=Nl(r,n);var u=r==null?r:r[ti(Ur(n))];return u==null?t:kt(u,r,a)}function zh(r){return Nt(r)&&nr(r)==he}function i1(r){return Nt(r)&&nr(r)==Se}function n1(r){return Nt(r)&&nr(r)==R}function ts(r,n,a,u,p){return r===n?!0:r==null||n==null||!Nt(r)&&!Nt(n)?r!==r&&n!==n:s1(r,n,a,u,ts,p)}function s1(r,n,a,u,p,_){var S=Ce(r),T=Ce(n),F=S?_e:Xt(r),J=T?_e:Xt(n);F=F==he?Fe:F,J=J==he?Fe:J;var Q=F==Fe,Z=J==Fe,ae=F==J;if(ae&&Ui(r)){if(!Ui(n))return!1;S=!0,Q=!1}if(ae&&!Q)return _||(_=new Br),S||Nn(r)?El(r,n,a,u,p,_):C1(r,n,F,a,u,p,_);if(!(a&q)){var ve=Q&&st.call(r,"__wrapped__"),be=Z&&st.call(n,"__wrapped__");if(ve||be){var He=ve?r.value():r,Ee=be?n.value():n;return _||(_=new Br),p(He,Ee,a,u,_)}}return ae?(_||(_=new Br),U1(r,n,a,u,p,_)):!1}function o1(r){return Nt(r)&&Xt(r)==Ie}function ac(r,n,a,u){var p=a.length,_=p,S=!u;if(r==null)return!_;for(r=lt(r);p--;){var T=a[p];if(S&&T[2]?T[1]!==r[T[0]]:!(T[0]in r))return!1}for(;++p<_;){T=a[p];var F=T[0],J=r[F],Q=T[1];if(S&&T[2]){if(J===t&&!(F in r))return!1}else{var Z=new Br;if(u)var ae=u(J,Q,F,r,n,Z);if(!(ae===t?ts(Q,J,q|z,u,Z):ae))return!1}}return!0}function Kh(r){if(!Et(r)||B1(r))return!1;var n=gi(r)?o0:Pa;return n.test(Qi(r))}function a1(r){return Nt(r)&&nr(r)==je}function c1(r){return Nt(r)&&Xt(r)==Oe}function u1(r){return Nt(r)&&Mo(r.length)&&!!ct[nr(r)]}function Vh(r){return typeof r=="function"?r:r==null?gr:typeof r=="object"?Ce(r)?Wh(r[0],r[1]):Gh(r):pf(r)}function cc(r){if(!ns(r))return f0(r);var n=[];for(var a in lt(r))st.call(r,a)&&a!="constructor"&&n.push(a);return n}function h1(r){if(!Et(r))return k1(r);var n=ns(r),a=[];for(var u in r)u=="constructor"&&(n||!st.call(r,u))||a.push(u);return a}function uc(r,n){return r<n}function kh(r,n){var a=-1,u=dr(r)?B(r.length):[];return Ni(r,function(p,_,S){u[++a]=n(p,_,S)}),u}function Gh(r){var n=Ic(r);return n.length==1&&n[0][2]?xl(n[0][0],n[0][1]):function(a){return a===r||ac(a,r,n)}}function Wh(r,n){return Pc(r)&&Pl(n)?xl(ti(r),n):function(a){var u=Fc(a,r);return u===t&&u===n?Dc(a,r):ts(n,u,q|z)}}function Eo(r,n,a,u,p){r!==n&&ic(n,function(_,S){if(p||(p=new Br),Et(_))l1(r,n,S,a,Eo,u,p);else{var T=u?u(Tc(r,S),_,S+"",r,n,p):t;T===t&&(T=_),tc(r,S,T)}},pr)}function l1(r,n,a,u,p,_,S){var T=Tc(r,a),F=Tc(n,a),J=S.get(F);if(J){tc(r,a,J);return}var Q=_?_(T,F,a+"",r,n,S):t,Z=Q===t;if(Z){var ae=Ce(F),ve=!ae&&Ui(F),be=!ae&&!ve&&Nn(F);Q=F,ae||ve||be?Ce(T)?Q=T:Ct(T)?Q=fr(T):ve?(Z=!1,Q=ol(F,!0)):be?(Z=!1,Q=al(F,!0)):Q=[]:os(F)||Xi(F)?(Q=T,Xi(T)?Q=nf(T):(!Et(T)||gi(T))&&(Q=Ol(F))):Z=!1}Z&&(S.set(F,Q),p(Q,F,u,_,S),S.delete(F)),tc(r,a,Q)}function Yh(r,n){var a=r.length;if(a)return n+=n<0?a:0,pi(n,a)?r[n]:t}function Jh(r,n,a){n.length?n=wt(n,function(_){return Ce(_)?function(S){return Yi(S,_.length===1?_[0]:_)}:_}):n=[gr];var u=-1;n=wt(n,mr(me()));var p=kh(r,function(_,S,T){var F=wt(n,function(J){return J(_)});return{criteria:F,index:++u,value:_}});return Mg(p,function(_,S){return I1(_,S,a)})}function f1(r,n){return Qh(r,n,function(a,u){return Dc(r,u)})}function Qh(r,n,a){for(var u=-1,p=n.length,_={};++u<p;){var S=n[u],T=Yi(r,S);a(T,S)&&rs(_,Ri(S,r),T)}return _}function d1(r){return function(n){return Yi(n,r)}}function hc(r,n,a,u){var p=u?Dg:_n,_=-1,S=n.length,T=r;for(r===n&&(n=fr(n)),a&&(T=wt(r,mr(a)));++_<S;)for(var F=0,J=n[_],Q=a?a(J):J;(F=p(T,Q,F,u))>-1;)T!==r&&lo.call(T,F,1),lo.call(r,F,1);return r}function Xh(r,n){for(var a=r?n.length:0,u=a-1;a--;){var p=n[a];if(a==u||p!==_){var _=p;pi(p)?lo.call(r,p,1):pc(r,p)}}return r}function lc(r,n){return r+go(Ch()*(n-r+1))}function p1(r,n,a,u){for(var p=-1,_=Vt(po((n-r)/(a||1)),0),S=B(_);_--;)S[u?_:++p]=r,r+=a;return S}function fc(r,n){var a="";if(!r||n<1||n>W)return a;do n%2&&(a+=r),n=go(n/2),n&&(r+=r);while(n);return a}function Ke(r,n){return Nc(Tl(r,n,gr),r+"")}function g1(r){return Lh(An(r))}function v1(r,n){var a=An(r);return Co(a,Wi(n,0,a.length))}function rs(r,n,a,u){if(!Et(r))return r;n=Ri(n,r);for(var p=-1,_=n.length,S=_-1,T=r;T!=null&&++p<_;){var F=ti(n[p]),J=a;if(F==="__proto__"||F==="constructor"||F==="prototype")return r;if(p!=S){var Q=T[F];J=u?u(Q,F,T):t,J===t&&(J=Et(Q)?Q:pi(n[p+1])?[]:{})}Xn(T,F,J),T=T[F]}return r}var Zh=vo?function(r,n){return vo.set(r,n),r}:gr,y1=fo?function(r,n){return fo(r,"toString",{configurable:!0,enumerable:!1,value:jc(n),writable:!0})}:gr;function _1(r){return Co(An(r))}function Cr(r,n,a){var u=-1,p=r.length;n<0&&(n=-n>p?0:p+n),a=a>p?p:a,a<0&&(a+=p),p=n>a?0:a-n>>>0,n>>>=0;for(var _=B(p);++u<p;)_[u]=r[u+n];return _}function m1(r,n){var a;return Ni(r,function(u,p,_){return a=n(u,p,_),!a}),!!a}function So(r,n,a){var u=0,p=r==null?u:r.length;if(typeof n=="number"&&n===n&&p<=ie){for(;u<p;){var _=u+p>>>1,S=r[_];S!==null&&!br(S)&&(a?S<=n:S<n)?u=_+1:p=_}return p}return dc(r,n,gr,a)}function dc(r,n,a,u){var p=0,_=r==null?0:r.length;if(_===0)return 0;n=a(n);for(var S=n!==n,T=n===null,F=br(n),J=n===t;p<_;){var Q=go((p+_)/2),Z=a(r[Q]),ae=Z!==t,ve=Z===null,be=Z===Z,He=br(Z);if(S)var Ee=u||be;else J?Ee=be&&(u||ae):T?Ee=be&&ae&&(u||!ve):F?Ee=be&&ae&&!ve&&(u||!He):ve||He?Ee=!1:Ee=u?Z<=n:Z<n;Ee?p=Q+1:_=Q}return Qt(_,Pe)}function el(r,n){for(var a=-1,u=r.length,p=0,_=[];++a<u;){var S=r[a],T=n?n(S):S;if(!a||!zr(T,F)){var F=T;_[p++]=S===0?0:S}}return _}function tl(r){return typeof r=="number"?r:br(r)?Y:+r}function wr(r){if(typeof r=="string")return r;if(Ce(r))return wt(r,wr)+"";if(br(r))return Uh?Uh.call(r):"";var n=r+"";return n=="0"&&1/r==-te?"-0":n}function Ai(r,n,a){var u=-1,p=to,_=r.length,S=!0,T=[],F=T;if(a)S=!1,p=Ba;else if(_>=o){var J=n?null:A1(r);if(J)return io(J);S=!1,p=kn,F=new Gi}else F=n?[]:T;e:for(;++u<_;){var Q=r[u],Z=n?n(Q):Q;if(Q=a||Q!==0?Q:0,S&&Z===Z){for(var ae=F.length;ae--;)if(F[ae]===Z)continue e;n&&F.push(Z),T.push(Q)}else p(F,Z,a)||(F!==T&&F.push(Z),T.push(Q))}return T}function pc(r,n){return n=Ri(n,r),r=Nl(r,n),r==null||delete r[ti(Ur(n))]}function rl(r,n,a,u){return rs(r,n,a(Yi(r,n)),u)}function Io(r,n,a,u){for(var p=r.length,_=u?p:-1;(u?_--:++_<p)&&n(r[_],_,r););return a?Cr(r,u?0:_,u?_+1:p):Cr(r,u?_+1:0,u?p:_)}function il(r,n){var a=r;return a instanceof Je&&(a=a.value()),za(n,function(u,p){return p.func.apply(p.thisArg,Pi([u],p.args))},a)}function gc(r,n,a){var u=r.length;if(u<2)return u?Ai(r[0]):[];for(var p=-1,_=B(u);++p<u;)for(var S=r[p],T=-1;++T<u;)T!=p&&(_[p]=Zn(_[p]||S,r[T],n,a));return Ai(Yt(_,1),n,a)}function nl(r,n,a){for(var u=-1,p=r.length,_=n.length,S={};++u<p;){var T=u<_?n[u]:t;a(S,r[u],T)}return S}function vc(r){return Ct(r)?r:[]}function yc(r){return typeof r=="function"?r:gr}function Ri(r,n){return Ce(r)?r:Pc(r,n)?[r]:Ul(nt(r))}var w1=Ke;function Ci(r,n,a){var u=r.length;return a=a===t?u:a,!n&&a>=u?r:Cr(r,n,a)}var sl=a0||function(r){return Xe.clearTimeout(r)};function ol(r,n){if(n)return r.slice();var a=r.length,u=xh?xh(a):new r.constructor(a);return r.copy(u),u}function _c(r){var n=new r.constructor(r.byteLength);return new uo(n).set(new uo(r)),n}function b1(r,n){var a=n?_c(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.byteLength)}function E1(r){var n=new r.constructor(r.source,Pr.exec(r));return n.lastIndex=r.lastIndex,n}function S1(r){return Qn?lt(Qn.call(r)):{}}function al(r,n){var a=n?_c(r.buffer):r.buffer;return new r.constructor(a,r.byteOffset,r.length)}function cl(r,n){if(r!==n){var a=r!==t,u=r===null,p=r===r,_=br(r),S=n!==t,T=n===null,F=n===n,J=br(n);if(!T&&!J&&!_&&r>n||_&&S&&F&&!T&&!J||u&&S&&F||!a&&F||!p)return 1;if(!u&&!_&&!J&&r<n||J&&a&&p&&!u&&!_||T&&a&&p||!S&&p||!F)return-1}return 0}function I1(r,n,a){for(var u=-1,p=r.criteria,_=n.criteria,S=p.length,T=a.length;++u<S;){var F=cl(p[u],_[u]);if(F){if(u>=T)return F;var J=a[u];return F*(J=="desc"?-1:1)}}return r.index-n.index}function ul(r,n,a,u){for(var p=-1,_=r.length,S=a.length,T=-1,F=n.length,J=Vt(_-S,0),Q=B(F+J),Z=!u;++T<F;)Q[T]=n[T];for(;++p<S;)(Z||p<_)&&(Q[a[p]]=r[p]);for(;J--;)Q[T++]=r[p++];return Q}function hl(r,n,a,u){for(var p=-1,_=r.length,S=-1,T=a.length,F=-1,J=n.length,Q=Vt(_-T,0),Z=B(Q+J),ae=!u;++p<Q;)Z[p]=r[p];for(var ve=p;++F<J;)Z[ve+F]=n[F];for(;++S<T;)(ae||p<_)&&(Z[ve+a[S]]=r[p++]);return Z}function fr(r,n){var a=-1,u=r.length;for(n||(n=B(u));++a<u;)n[a]=r[a];return n}function ei(r,n,a,u){var p=!a;a||(a={});for(var _=-1,S=n.length;++_<S;){var T=n[_],F=u?u(a[T],r[T],T,a,r):t;F===t&&(F=r[T]),p?li(a,T,F):Xn(a,T,F)}return a}function O1(r,n){return ei(r,Oc(r),n)}function P1(r,n){return ei(r,Sl(r),n)}function Oo(r,n){return function(a,u){var p=Ce(a)?Rg:W0,_=n?n():{};return p(a,r,me(u,2),_)}}function Pn(r){return Ke(function(n,a){var u=-1,p=a.length,_=p>1?a[p-1]:t,S=p>2?a[2]:t;for(_=r.length>3&&typeof _=="function"?(p--,_):t,S&&sr(a[0],a[1],S)&&(_=p<3?t:_,p=1),n=lt(n);++u<p;){var T=a[u];T&&r(n,T,u,_)}return n})}function ll(r,n){return function(a,u){if(a==null)return a;if(!dr(a))return r(a,u);for(var p=a.length,_=n?p:-1,S=lt(a);(n?_--:++_<p)&&u(S[_],_,S)!==!1;);return a}}function fl(r){return function(n,a,u){for(var p=-1,_=lt(n),S=u(n),T=S.length;T--;){var F=S[r?T:++p];if(a(_[F],F,_)===!1)break}return n}}function x1(r,n,a){var u=n&K,p=is(r);function _(){var S=this&&this!==Xe&&this instanceof _?p:r;return S.apply(u?a:this,arguments)}return _}function dl(r){return function(n){n=nt(n);var a=mn(n)?Hr(n):t,u=a?a[0]:n.charAt(0),p=a?Ci(a,1).join(""):n.slice(1);return u[r]()+p}}function xn(r){return function(n){return za(ff(lf(n).replace(Kn,"")),r,"")}}function is(r){return function(){var n=arguments;switch(n.length){case 0:return new r;case 1:return new r(n[0]);case 2:return new r(n[0],n[1]);case 3:return new r(n[0],n[1],n[2]);case 4:return new r(n[0],n[1],n[2],n[3]);case 5:return new r(n[0],n[1],n[2],n[3],n[4]);case 6:return new r(n[0],n[1],n[2],n[3],n[4],n[5]);case 7:return new r(n[0],n[1],n[2],n[3],n[4],n[5],n[6])}var a=On(r.prototype),u=r.apply(a,n);return Et(u)?u:a}}function T1(r,n,a){var u=is(r);function p(){for(var _=arguments.length,S=B(_),T=_,F=Tn(p);T--;)S[T]=arguments[T];var J=_<3&&S[0]!==F&&S[_-1]!==F?[]:xi(S,F);if(_-=J.length,_<a)return _l(r,n,Po,p.placeholder,t,S,J,t,t,a-_);var Q=this&&this!==Xe&&this instanceof p?u:r;return kt(Q,this,S)}return p}function pl(r){return function(n,a,u){var p=lt(n);if(!dr(n)){var _=me(a,3);n=Gt(n),a=function(T){return _(p[T],T,p)}}var S=r(n,a,u);return S>-1?p[_?n[S]:S]:t}}function gl(r){return di(function(n){var a=n.length,u=a,p=Ar.prototype.thru;for(r&&n.reverse();u--;){var _=n[u];if(typeof _!="function")throw new Nr(d);if(p&&!S&&Ao(_)=="wrapper")var S=new Ar([],!0)}for(u=S?u:a;++u<a;){_=n[u];var T=Ao(_),F=T=="wrapper"?Sc(_):t;F&&xc(F[0])&&F[1]==(h|D|N|m)&&!F[4].length&&F[9]==1?S=S[Ao(F[0])].apply(S,F[3]):S=_.length==1&&xc(_)?S[T]():S.thru(_)}return function(){var J=arguments,Q=J[0];if(S&&J.length==1&&Ce(Q))return S.plant(Q).value();for(var Z=0,ae=a?n[Z].apply(this,J):Q;++Z<a;)ae=n[Z].call(this,ae);return ae}})}function Po(r,n,a,u,p,_,S,T,F,J){var Q=n&h,Z=n&K,ae=n&oe,ve=n&(D|I),be=n&G,He=ae?t:is(r);function Ee(){for(var We=arguments.length,Ze=B(We),Er=We;Er--;)Ze[Er]=arguments[Er];if(ve)var or=Tn(Ee),Sr=qg(Ze,or);if(u&&(Ze=ul(Ze,u,p,ve)),_&&(Ze=hl(Ze,_,S,ve)),We-=Sr,ve&&We<J){var Ut=xi(Ze,or);return _l(r,n,Po,Ee.placeholder,a,Ze,Ut,T,F,J-We)}var Kr=Z?a:this,yi=ae?Kr[r]:r;return We=Ze.length,T?Ze=W1(Ze,T):be&&We>1&&Ze.reverse(),Q&&F<We&&(Ze.length=F),this&&this!==Xe&&this instanceof Ee&&(yi=He||is(yi)),yi.apply(Kr,Ze)}return Ee}function vl(r,n){return function(a,u){return r1(a,r,n(u),{})}}function xo(r,n){return function(a,u){var p;if(a===t&&u===t)return n;if(a!==t&&(p=a),u!==t){if(p===t)return u;typeof a=="string"||typeof u=="string"?(a=wr(a),u=wr(u)):(a=tl(a),u=tl(u)),p=r(a,u)}return p}}function mc(r){return di(function(n){return n=wt(n,mr(me())),Ke(function(a){var u=this;return r(n,function(p){return kt(p,u,a)})})})}function To(r,n){n=n===t?" ":wr(n);var a=n.length;if(a<2)return a?fc(n,r):n;var u=fc(n,po(r/wn(n)));return mn(n)?Ci(Hr(u),0,r).join(""):u.slice(0,r)}function N1(r,n,a,u){var p=n&K,_=is(r);function S(){for(var T=-1,F=arguments.length,J=-1,Q=u.length,Z=B(Q+F),ae=this&&this!==Xe&&this instanceof S?_:r;++J<Q;)Z[J]=u[J];for(;F--;)Z[J++]=arguments[++T];return kt(ae,p?a:this,Z)}return S}function yl(r){return function(n,a,u){return u&&typeof u!="number"&&sr(n,a,u)&&(a=u=t),n=vi(n),a===t?(a=n,n=0):a=vi(a),u=u===t?n<a?1:-1:vi(u),p1(n,a,u,r)}}function No(r){return function(n,a){return typeof n=="string"&&typeof a=="string"||(n=$r(n),a=$r(a)),r(n,a)}}function _l(r,n,a,u,p,_,S,T,F,J){var Q=n&D,Z=Q?S:t,ae=Q?t:S,ve=Q?_:t,be=Q?t:_;n|=Q?N:w,n&=~(Q?w:N),n&C||(n&=~(K|oe));var He=[r,n,p,ve,Z,be,ae,T,F,J],Ee=a.apply(t,He);return xc(r)&&Al(Ee,He),Ee.placeholder=u,Rl(Ee,r,n)}function wc(r){var n=Kt[r];return function(a,u){if(a=$r(a),u=u==null?0:Qt(De(u),292),u&&Rh(a)){var p=(nt(a)+"e").split("e"),_=n(p[0]+"e"+(+p[1]+u));return p=(nt(_)+"e").split("e"),+(p[0]+"e"+(+p[1]-u))}return n(a)}}var A1=Sn&&1/io(new Sn([,-0]))[1]==te?function(r){return new Sn(r)}:Bc;function ml(r){return function(n){var a=Xt(n);return a==Ie?Ja(n):a==Oe?Gg(n):jg(n,r(n))}}function fi(r,n,a,u,p,_,S,T){var F=n&oe;if(!F&&typeof r!="function")throw new Nr(d);var J=u?u.length:0;if(J||(n&=~(N|w),u=p=t),S=S===t?S:Vt(De(S),0),T=T===t?T:De(T),J-=p?p.length:0,n&w){var Q=u,Z=p;u=p=t}var ae=F?t:Sc(r),ve=[r,n,a,u,p,Q,Z,_,S,T];if(ae&&V1(ve,ae),r=ve[0],n=ve[1],a=ve[2],u=ve[3],p=ve[4],T=ve[9]=ve[9]===t?F?0:r.length:Vt(ve[9]-J,0),!T&&n&(D|I)&&(n&=~(D|I)),!n||n==K)var be=x1(r,n,a);else n==D||n==I?be=T1(r,n,T):(n==N||n==(K|N))&&!p.length?be=N1(r,n,a,u):be=Po.apply(t,ve);var He=ae?Zh:Al;return Rl(He(be,ve),r,n)}function wl(r,n,a,u){return r===t||zr(r,En[a])&&!st.call(u,a)?n:r}function bl(r,n,a,u,p,_){return Et(r)&&Et(n)&&(_.set(n,r),Eo(r,n,t,bl,_),_.delete(n)),r}function R1(r){return os(r)?t:r}function El(r,n,a,u,p,_){var S=a&q,T=r.length,F=n.length;if(T!=F&&!(S&&F>T))return!1;var J=_.get(r),Q=_.get(n);if(J&&Q)return J==n&&Q==r;var Z=-1,ae=!0,ve=a&z?new Gi:t;for(_.set(r,n),_.set(n,r);++Z<T;){var be=r[Z],He=n[Z];if(u)var Ee=S?u(He,be,Z,n,r,_):u(be,He,Z,r,n,_);if(Ee!==t){if(Ee)continue;ae=!1;break}if(ve){if(!Ka(n,function(We,Ze){if(!kn(ve,Ze)&&(be===We||p(be,We,a,u,_)))return ve.push(Ze)})){ae=!1;break}}else if(!(be===He||p(be,He,a,u,_))){ae=!1;break}}return _.delete(r),_.delete(n),ae}function C1(r,n,a,u,p,_,S){switch(a){case Ne:if(r.byteLength!=n.byteLength||r.byteOffset!=n.byteOffset)return!1;r=r.buffer,n=n.buffer;case Se:return!(r.byteLength!=n.byteLength||!_(new uo(r),new uo(n)));case M:case R:case Be:return zr(+r,+n);case O:return r.name==n.name&&r.message==n.message;case je:case Ue:return r==n+"";case Ie:var T=Ja;case Oe:var F=u&q;if(T||(T=io),r.size!=n.size&&!F)return!1;var J=S.get(r);if(J)return J==n;u|=z,S.set(r,n);var Q=El(T(r),T(n),u,p,_,S);return S.delete(r),Q;case $e:if(Qn)return Qn.call(r)==Qn.call(n)}return!1}function U1(r,n,a,u,p,_){var S=a&q,T=bc(r),F=T.length,J=bc(n),Q=J.length;if(F!=Q&&!S)return!1;for(var Z=F;Z--;){var ae=T[Z];if(!(S?ae in n:st.call(n,ae)))return!1}var ve=_.get(r),be=_.get(n);if(ve&&be)return ve==n&&be==r;var He=!0;_.set(r,n),_.set(n,r);for(var Ee=S;++Z<F;){ae=T[Z];var We=r[ae],Ze=n[ae];if(u)var Er=S?u(Ze,We,ae,n,r,_):u(We,Ze,ae,r,n,_);if(!(Er===t?We===Ze||p(We,Ze,a,u,_):Er)){He=!1;break}Ee||(Ee=ae=="constructor")}if(He&&!Ee){var or=r.constructor,Sr=n.constructor;or!=Sr&&"constructor"in r&&"constructor"in n&&!(typeof or=="function"&&or instanceof or&&typeof Sr=="function"&&Sr instanceof Sr)&&(He=!1)}return _.delete(r),_.delete(n),He}function di(r){return Nc(Tl(r,t,Dl),r+"")}function bc(r){return Bh(r,Gt,Oc)}function Ec(r){return Bh(r,pr,Sl)}var Sc=vo?function(r){return vo.get(r)}:Bc;function Ao(r){for(var n=r.name+"",a=In[n],u=st.call(In,n)?a.length:0;u--;){var p=a[u],_=p.func;if(_==null||_==r)return p.name}return n}function Tn(r){var n=st.call(v,"placeholder")?v:r;return n.placeholder}function me(){var r=v.iteratee||qc;return r=r===qc?Vh:r,arguments.length?r(arguments[0],arguments[1]):r}function Ro(r,n){var a=r.__data__;return H1(n)?a[typeof n=="string"?"string":"hash"]:a.map}function Ic(r){for(var n=Gt(r),a=n.length;a--;){var u=n[a],p=r[u];n[a]=[u,p,Pl(p)]}return n}function Ji(r,n){var a=Kg(r,n);return Kh(a)?a:t}function $1(r){var n=st.call(r,Vi),a=r[Vi];try{r[Vi]=t;var u=!0}catch{}var p=ao.call(r);return u&&(n?r[Vi]=a:delete r[Vi]),p}var Oc=Xa?function(r){return r==null?[]:(r=lt(r),Oi(Xa(r),function(n){return Nh.call(r,n)}))}:zc,Sl=Xa?function(r){for(var n=[];r;)Pi(n,Oc(r)),r=ho(r);return n}:zc,Xt=nr;(Za&&Xt(new Za(new ArrayBuffer(1)))!=Ne||Wn&&Xt(new Wn)!=Ie||ec&&Xt(ec.resolve())!=vt||Sn&&Xt(new Sn)!=Oe||Yn&&Xt(new Yn)!=Te)&&(Xt=function(r){var n=nr(r),a=n==Fe?r.constructor:t,u=a?Qi(a):"";if(u)switch(u){case v0:return Ne;case y0:return Ie;case _0:return vt;case m0:return Oe;case w0:return Te}return n});function L1(r,n,a){for(var u=-1,p=a.length;++u<p;){var _=a[u],S=_.size;switch(_.type){case"drop":r+=S;break;case"dropRight":n-=S;break;case"take":n=Qt(n,r+S);break;case"takeRight":r=Vt(r,n-S);break}}return{start:r,end:n}}function F1(r){var n=r.match(ft);return n?n[1].split(jt):[]}function Il(r,n,a){n=Ri(n,r);for(var u=-1,p=n.length,_=!1;++u<p;){var S=ti(n[u]);if(!(_=r!=null&&a(r,S)))break;r=r[S]}return _||++u!=p?_:(p=r==null?0:r.length,!!p&&Mo(p)&&pi(S,p)&&(Ce(r)||Xi(r)))}function D1(r){var n=r.length,a=new r.constructor(n);return n&&typeof r[0]=="string"&&st.call(r,"index")&&(a.index=r.index,a.input=r.input),a}function Ol(r){return typeof r.constructor=="function"&&!ns(r)?On(ho(r)):{}}function M1(r,n,a){var u=r.constructor;switch(n){case Se:return _c(r);case M:case R:return new u(+r);case Ne:return b1(r,a);case ze:case xe:case Ge:case Ye:case tt:case rt:case Qe:case tr:case hr:return al(r,a);case Ie:return new u;case Be:case Ue:return new u(r);case je:return E1(r);case Oe:return new u;case $e:return S1(r)}}function j1(r,n){var a=n.length;if(!a)return r;var u=a-1;return n[u]=(a>1?"& ":"")+n[u],n=n.join(a>2?", ":" "),r.replace(Tt,`{
/* [wrapped with `+n+`] */
`)}function q1(r){return Ce(r)||Xi(r)||!!(Ah&&r&&r[Ah])}function pi(r,n){var a=typeof r;return n=n??W,!!n&&(a=="number"||a!="symbol"&&Ta.test(r))&&r>-1&&r%1==0&&r<n}function sr(r,n,a){if(!Et(a))return!1;var u=typeof n;return(u=="number"?dr(a)&&pi(n,a.length):u=="string"&&n in a)?zr(a[n],r):!1}function Pc(r,n){if(Ce(r))return!1;var a=typeof r;return a=="number"||a=="symbol"||a=="boolean"||r==null||br(r)?!0:Ft.test(r)||!mt.test(r)||n!=null&&r in lt(n)}function H1(r){var n=typeof r;return n=="string"||n=="number"||n=="symbol"||n=="boolean"?r!=="__proto__":r===null}function xc(r){var n=Ao(r),a=v[n];if(typeof a!="function"||!(n in Je.prototype))return!1;if(r===a)return!0;var u=Sc(a);return!!u&&r===u[0]}function B1(r){return!!Ph&&Ph in r}var z1=so?gi:Kc;function ns(r){var n=r&&r.constructor,a=typeof n=="function"&&n.prototype||En;return r===a}function Pl(r){return r===r&&!Et(r)}function xl(r,n){return function(a){return a==null?!1:a[r]===n&&(n!==t||r in lt(a))}}function K1(r){var n=Fo(r,function(u){return a.size===y&&a.clear(),u}),a=n.cache;return n}function V1(r,n){var a=r[1],u=n[1],p=a|u,_=p<(K|oe|h),S=u==h&&a==D||u==h&&a==m&&r[7].length<=n[8]||u==(h|m)&&n[7].length<=n[8]&&a==D;if(!(_||S))return r;u&K&&(r[2]=n[2],p|=a&K?0:C);var T=n[3];if(T){var F=r[3];r[3]=F?ul(F,T,n[4]):T,r[4]=F?xi(r[3],b):n[4]}return T=n[5],T&&(F=r[5],r[5]=F?hl(F,T,n[6]):T,r[6]=F?xi(r[5],b):n[6]),T=n[7],T&&(r[7]=T),u&h&&(r[8]=r[8]==null?n[8]:Qt(r[8],n[8])),r[9]==null&&(r[9]=n[9]),r[0]=n[0],r[1]=p,r}function k1(r){var n=[];if(r!=null)for(var a in lt(r))n.push(a);return n}function G1(r){return ao.call(r)}function Tl(r,n,a){return n=Vt(n===t?r.length-1:n,0),function(){for(var u=arguments,p=-1,_=Vt(u.length-n,0),S=B(_);++p<_;)S[p]=u[n+p];p=-1;for(var T=B(n+1);++p<n;)T[p]=u[p];return T[n]=a(S),kt(r,this,T)}}function Nl(r,n){return n.length<2?r:Yi(r,Cr(n,0,-1))}function W1(r,n){for(var a=r.length,u=Qt(n.length,a),p=fr(r);u--;){var _=n[u];r[u]=pi(_,a)?p[_]:t}return r}function Tc(r,n){if(!(n==="constructor"&&typeof r[n]=="function")&&n!="__proto__")return r[n]}var Al=Cl(Zh),ss=u0||function(r,n){return Xe.setTimeout(r,n)},Nc=Cl(y1);function Rl(r,n,a){var u=n+"";return Nc(r,j1(u,Y1(F1(u),a)))}function Cl(r){var n=0,a=0;return function(){var u=d0(),p=ge-(u-a);if(a=u,p>0){if(++n>=ce)return arguments[0]}else n=0;return r.apply(t,arguments)}}function Co(r,n){var a=-1,u=r.length,p=u-1;for(n=n===t?u:n;++a<n;){var _=lc(a,p),S=r[_];r[_]=r[a],r[a]=S}return r.length=n,r}var Ul=K1(function(r){var n=[];return r.charCodeAt(0)===46&&n.push(""),r.replace(Dt,function(a,u,p,_){n.push(p?_.replace(Ea,"$1"):u||a)}),n});function ti(r){if(typeof r=="string"||br(r))return r;var n=r+"";return n=="0"&&1/r==-te?"-0":n}function Qi(r){if(r!=null){try{return oo.call(r)}catch{}try{return r+""}catch{}}return""}function Y1(r,n){return Tr(we,function(a){var u="_."+a[0];n&a[1]&&!to(r,u)&&r.push(u)}),r.sort()}function $l(r){if(r instanceof Je)return r.clone();var n=new Ar(r.__wrapped__,r.__chain__);return n.__actions__=fr(r.__actions__),n.__index__=r.__index__,n.__values__=r.__values__,n}function J1(r,n,a){(a?sr(r,n,a):n===t)?n=1:n=Vt(De(n),0);var u=r==null?0:r.length;if(!u||n<1)return[];for(var p=0,_=0,S=B(po(u/n));p<u;)S[_++]=Cr(r,p,p+=n);return S}function Q1(r){for(var n=-1,a=r==null?0:r.length,u=0,p=[];++n<a;){var _=r[n];_&&(p[u++]=_)}return p}function X1(){var r=arguments.length;if(!r)return[];for(var n=B(r-1),a=arguments[0],u=r;u--;)n[u-1]=arguments[u];return Pi(Ce(a)?fr(a):[a],Yt(n,1))}var Z1=Ke(function(r,n){return Ct(r)?Zn(r,Yt(n,1,Ct,!0)):[]}),ev=Ke(function(r,n){var a=Ur(n);return Ct(a)&&(a=t),Ct(r)?Zn(r,Yt(n,1,Ct,!0),me(a,2)):[]}),tv=Ke(function(r,n){var a=Ur(n);return Ct(a)&&(a=t),Ct(r)?Zn(r,Yt(n,1,Ct,!0),t,a):[]});function rv(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:De(n),Cr(r,n<0?0:n,u)):[]}function iv(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:De(n),n=u-n,Cr(r,0,n<0?0:n)):[]}function nv(r,n){return r&&r.length?Io(r,me(n,3),!0,!0):[]}function sv(r,n){return r&&r.length?Io(r,me(n,3),!0):[]}function ov(r,n,a,u){var p=r==null?0:r.length;return p?(a&&typeof a!="number"&&sr(r,n,a)&&(a=0,u=p),X0(r,n,a,u)):[]}function Ll(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=a==null?0:De(a);return p<0&&(p=Vt(u+p,0)),ro(r,me(n,3),p)}function Fl(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=u-1;return a!==t&&(p=De(a),p=a<0?Vt(u+p,0):Qt(p,u-1)),ro(r,me(n,3),p,!0)}function Dl(r){var n=r==null?0:r.length;return n?Yt(r,1):[]}function av(r){var n=r==null?0:r.length;return n?Yt(r,te):[]}function cv(r,n){var a=r==null?0:r.length;return a?(n=n===t?1:De(n),Yt(r,n)):[]}function uv(r){for(var n=-1,a=r==null?0:r.length,u={};++n<a;){var p=r[n];u[p[0]]=p[1]}return u}function Ml(r){return r&&r.length?r[0]:t}function hv(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=a==null?0:De(a);return p<0&&(p=Vt(u+p,0)),_n(r,n,p)}function lv(r){var n=r==null?0:r.length;return n?Cr(r,0,-1):[]}var fv=Ke(function(r){var n=wt(r,vc);return n.length&&n[0]===r[0]?oc(n):[]}),dv=Ke(function(r){var n=Ur(r),a=wt(r,vc);return n===Ur(a)?n=t:a.pop(),a.length&&a[0]===r[0]?oc(a,me(n,2)):[]}),pv=Ke(function(r){var n=Ur(r),a=wt(r,vc);return n=typeof n=="function"?n:t,n&&a.pop(),a.length&&a[0]===r[0]?oc(a,t,n):[]});function gv(r,n){return r==null?"":l0.call(r,n)}function Ur(r){var n=r==null?0:r.length;return n?r[n-1]:t}function vv(r,n,a){var u=r==null?0:r.length;if(!u)return-1;var p=u;return a!==t&&(p=De(a),p=p<0?Vt(u+p,0):Qt(p,u-1)),n===n?Yg(r,n,p):ro(r,_h,p,!0)}function yv(r,n){return r&&r.length?Yh(r,De(n)):t}var _v=Ke(jl);function jl(r,n){return r&&r.length&&n&&n.length?hc(r,n):r}function mv(r,n,a){return r&&r.length&&n&&n.length?hc(r,n,me(a,2)):r}function wv(r,n,a){return r&&r.length&&n&&n.length?hc(r,n,t,a):r}var bv=di(function(r,n){var a=r==null?0:r.length,u=rc(r,n);return Xh(r,wt(n,function(p){return pi(p,a)?+p:p}).sort(cl)),u});function Ev(r,n){var a=[];if(!(r&&r.length))return a;var u=-1,p=[],_=r.length;for(n=me(n,3);++u<_;){var S=r[u];n(S,u,r)&&(a.push(S),p.push(u))}return Xh(r,p),a}function Ac(r){return r==null?r:g0.call(r)}function Sv(r,n,a){var u=r==null?0:r.length;return u?(a&&typeof a!="number"&&sr(r,n,a)?(n=0,a=u):(n=n==null?0:De(n),a=a===t?u:De(a)),Cr(r,n,a)):[]}function Iv(r,n){return So(r,n)}function Ov(r,n,a){return dc(r,n,me(a,2))}function Pv(r,n){var a=r==null?0:r.length;if(a){var u=So(r,n);if(u<a&&zr(r[u],n))return u}return-1}function xv(r,n){return So(r,n,!0)}function Tv(r,n,a){return dc(r,n,me(a,2),!0)}function Nv(r,n){var a=r==null?0:r.length;if(a){var u=So(r,n,!0)-1;if(zr(r[u],n))return u}return-1}function Av(r){return r&&r.length?el(r):[]}function Rv(r,n){return r&&r.length?el(r,me(n,2)):[]}function Cv(r){var n=r==null?0:r.length;return n?Cr(r,1,n):[]}function Uv(r,n,a){return r&&r.length?(n=a||n===t?1:De(n),Cr(r,0,n<0?0:n)):[]}function $v(r,n,a){var u=r==null?0:r.length;return u?(n=a||n===t?1:De(n),n=u-n,Cr(r,n<0?0:n,u)):[]}function Lv(r,n){return r&&r.length?Io(r,me(n,3),!1,!0):[]}function Fv(r,n){return r&&r.length?Io(r,me(n,3)):[]}var Dv=Ke(function(r){return Ai(Yt(r,1,Ct,!0))}),Mv=Ke(function(r){var n=Ur(r);return Ct(n)&&(n=t),Ai(Yt(r,1,Ct,!0),me(n,2))}),jv=Ke(function(r){var n=Ur(r);return n=typeof n=="function"?n:t,Ai(Yt(r,1,Ct,!0),t,n)});function qv(r){return r&&r.length?Ai(r):[]}function Hv(r,n){return r&&r.length?Ai(r,me(n,2)):[]}function Bv(r,n){return n=typeof n=="function"?n:t,r&&r.length?Ai(r,t,n):[]}function Rc(r){if(!(r&&r.length))return[];var n=0;return r=Oi(r,function(a){if(Ct(a))return n=Vt(a.length,n),!0}),Wa(n,function(a){return wt(r,Va(a))})}function ql(r,n){if(!(r&&r.length))return[];var a=Rc(r);return n==null?a:wt(a,function(u){return kt(n,t,u)})}var zv=Ke(function(r,n){return Ct(r)?Zn(r,n):[]}),Kv=Ke(function(r){return gc(Oi(r,Ct))}),Vv=Ke(function(r){var n=Ur(r);return Ct(n)&&(n=t),gc(Oi(r,Ct),me(n,2))}),kv=Ke(function(r){var n=Ur(r);return n=typeof n=="function"?n:t,gc(Oi(r,Ct),t,n)}),Gv=Ke(Rc);function Wv(r,n){return nl(r||[],n||[],Xn)}function Yv(r,n){return nl(r||[],n||[],rs)}var Jv=Ke(function(r){var n=r.length,a=n>1?r[n-1]:t;return a=typeof a=="function"?(r.pop(),a):t,ql(r,a)});function Hl(r){var n=v(r);return n.__chain__=!0,n}function Qv(r,n){return n(r),r}function Uo(r,n){return n(r)}var Xv=di(function(r){var n=r.length,a=n?r[0]:0,u=this.__wrapped__,p=function(_){return rc(_,r)};return n>1||this.__actions__.length||!(u instanceof Je)||!pi(a)?this.thru(p):(u=u.slice(a,+a+(n?1:0)),u.__actions__.push({func:Uo,args:[p],thisArg:t}),new Ar(u,this.__chain__).thru(function(_){return n&&!_.length&&_.push(t),_}))});function Zv(){return Hl(this)}function ey(){return new Ar(this.value(),this.__chain__)}function ty(){this.__values__===t&&(this.__values__=tf(this.value()));var r=this.__index__>=this.__values__.length,n=r?t:this.__values__[this.__index__++];return{done:r,value:n}}function ry(){return this}function iy(r){for(var n,a=this;a instanceof _o;){var u=$l(a);u.__index__=0,u.__values__=t,n?p.__wrapped__=u:n=u;var p=u;a=a.__wrapped__}return p.__wrapped__=r,n}function ny(){var r=this.__wrapped__;if(r instanceof Je){var n=r;return this.__actions__.length&&(n=new Je(this)),n=n.reverse(),n.__actions__.push({func:Uo,args:[Ac],thisArg:t}),new Ar(n,this.__chain__)}return this.thru(Ac)}function sy(){return il(this.__wrapped__,this.__actions__)}var oy=Oo(function(r,n,a){st.call(r,a)?++r[a]:li(r,a,1)});function ay(r,n,a){var u=Ce(r)?vh:Q0;return a&&sr(r,n,a)&&(n=t),u(r,me(n,3))}function cy(r,n){var a=Ce(r)?Oi:qh;return a(r,me(n,3))}var uy=pl(Ll),hy=pl(Fl);function ly(r,n){return Yt($o(r,n),1)}function fy(r,n){return Yt($o(r,n),te)}function dy(r,n,a){return a=a===t?1:De(a),Yt($o(r,n),a)}function Bl(r,n){var a=Ce(r)?Tr:Ni;return a(r,me(n,3))}function zl(r,n){var a=Ce(r)?Cg:jh;return a(r,me(n,3))}var py=Oo(function(r,n,a){st.call(r,a)?r[a].push(n):li(r,a,[n])});function gy(r,n,a,u){r=dr(r)?r:An(r),a=a&&!u?De(a):0;var p=r.length;return a<0&&(a=Vt(p+a,0)),jo(r)?a<=p&&r.indexOf(n,a)>-1:!!p&&_n(r,n,a)>-1}var vy=Ke(function(r,n,a){var u=-1,p=typeof n=="function",_=dr(r)?B(r.length):[];return Ni(r,function(S){_[++u]=p?kt(n,S,a):es(S,n,a)}),_}),yy=Oo(function(r,n,a){li(r,a,n)});function $o(r,n){var a=Ce(r)?wt:kh;return a(r,me(n,3))}function _y(r,n,a,u){return r==null?[]:(Ce(n)||(n=n==null?[]:[n]),a=u?t:a,Ce(a)||(a=a==null?[]:[a]),Jh(r,n,a))}var my=Oo(function(r,n,a){r[a?0:1].push(n)},function(){return[[],[]]});function wy(r,n,a){var u=Ce(r)?za:wh,p=arguments.length<3;return u(r,me(n,4),a,p,Ni)}function by(r,n,a){var u=Ce(r)?Ug:wh,p=arguments.length<3;return u(r,me(n,4),a,p,jh)}function Ey(r,n){var a=Ce(r)?Oi:qh;return a(r,Do(me(n,3)))}function Sy(r){var n=Ce(r)?Lh:g1;return n(r)}function Iy(r,n,a){(a?sr(r,n,a):n===t)?n=1:n=De(n);var u=Ce(r)?k0:v1;return u(r,n)}function Oy(r){var n=Ce(r)?G0:_1;return n(r)}function Py(r){if(r==null)return 0;if(dr(r))return jo(r)?wn(r):r.length;var n=Xt(r);return n==Ie||n==Oe?r.size:cc(r).length}function xy(r,n,a){var u=Ce(r)?Ka:m1;return a&&sr(r,n,a)&&(n=t),u(r,me(n,3))}var Ty=Ke(function(r,n){if(r==null)return[];var a=n.length;return a>1&&sr(r,n[0],n[1])?n=[]:a>2&&sr(n[0],n[1],n[2])&&(n=[n[0]]),Jh(r,Yt(n,1),[])}),Lo=c0||function(){return Xe.Date.now()};function Ny(r,n){if(typeof n!="function")throw new Nr(d);return r=De(r),function(){if(--r<1)return n.apply(this,arguments)}}function Kl(r,n,a){return n=a?t:n,n=r&&n==null?r.length:n,fi(r,h,t,t,t,t,n)}function Vl(r,n){var a;if(typeof n!="function")throw new Nr(d);return r=De(r),function(){return--r>0&&(a=n.apply(this,arguments)),r<=1&&(n=t),a}}var Cc=Ke(function(r,n,a){var u=K;if(a.length){var p=xi(a,Tn(Cc));u|=N}return fi(r,u,n,a,p)}),kl=Ke(function(r,n,a){var u=K|oe;if(a.length){var p=xi(a,Tn(kl));u|=N}return fi(n,u,r,a,p)});function Gl(r,n,a){n=a?t:n;var u=fi(r,D,t,t,t,t,t,n);return u.placeholder=Gl.placeholder,u}function Wl(r,n,a){n=a?t:n;var u=fi(r,I,t,t,t,t,t,n);return u.placeholder=Wl.placeholder,u}function Yl(r,n,a){var u,p,_,S,T,F,J=0,Q=!1,Z=!1,ae=!0;if(typeof r!="function")throw new Nr(d);n=$r(n)||0,Et(a)&&(Q=!!a.leading,Z="maxWait"in a,_=Z?Vt($r(a.maxWait)||0,n):_,ae="trailing"in a?!!a.trailing:ae);function ve(Ut){var Kr=u,yi=p;return u=p=t,J=Ut,S=r.apply(yi,Kr),S}function be(Ut){return J=Ut,T=ss(We,n),Q?ve(Ut):S}function He(Ut){var Kr=Ut-F,yi=Ut-J,gf=n-Kr;return Z?Qt(gf,_-yi):gf}function Ee(Ut){var Kr=Ut-F,yi=Ut-J;return F===t||Kr>=n||Kr<0||Z&&yi>=_}function We(){var Ut=Lo();if(Ee(Ut))return Ze(Ut);T=ss(We,He(Ut))}function Ze(Ut){return T=t,ae&&u?ve(Ut):(u=p=t,S)}function Er(){T!==t&&sl(T),J=0,u=F=p=T=t}function or(){return T===t?S:Ze(Lo())}function Sr(){var Ut=Lo(),Kr=Ee(Ut);if(u=arguments,p=this,F=Ut,Kr){if(T===t)return be(F);if(Z)return sl(T),T=ss(We,n),ve(F)}return T===t&&(T=ss(We,n)),S}return Sr.cancel=Er,Sr.flush=or,Sr}var Ay=Ke(function(r,n){return Mh(r,1,n)}),Ry=Ke(function(r,n,a){return Mh(r,$r(n)||0,a)});function Cy(r){return fi(r,G)}function Fo(r,n){if(typeof r!="function"||n!=null&&typeof n!="function")throw new Nr(d);var a=function(){var u=arguments,p=n?n.apply(this,u):u[0],_=a.cache;if(_.has(p))return _.get(p);var S=r.apply(this,u);return a.cache=_.set(p,S)||_,S};return a.cache=new(Fo.Cache||hi),a}Fo.Cache=hi;function Do(r){if(typeof r!="function")throw new Nr(d);return function(){var n=arguments;switch(n.length){case 0:return!r.call(this);case 1:return!r.call(this,n[0]);case 2:return!r.call(this,n[0],n[1]);case 3:return!r.call(this,n[0],n[1],n[2])}return!r.apply(this,n)}}function Uy(r){return Vl(2,r)}var $y=w1(function(r,n){n=n.length==1&&Ce(n[0])?wt(n[0],mr(me())):wt(Yt(n,1),mr(me()));var a=n.length;return Ke(function(u){for(var p=-1,_=Qt(u.length,a);++p<_;)u[p]=n[p].call(this,u[p]);return kt(r,this,u)})}),Uc=Ke(function(r,n){var a=xi(n,Tn(Uc));return fi(r,N,t,n,a)}),Jl=Ke(function(r,n){var a=xi(n,Tn(Jl));return fi(r,w,t,n,a)}),Ly=di(function(r,n){return fi(r,m,t,t,t,n)});function Fy(r,n){if(typeof r!="function")throw new Nr(d);return n=n===t?n:De(n),Ke(r,n)}function Dy(r,n){if(typeof r!="function")throw new Nr(d);return n=n==null?0:Vt(De(n),0),Ke(function(a){var u=a[n],p=Ci(a,0,n);return u&&Pi(p,u),kt(r,this,p)})}function My(r,n,a){var u=!0,p=!0;if(typeof r!="function")throw new Nr(d);return Et(a)&&(u="leading"in a?!!a.leading:u,p="trailing"in a?!!a.trailing:p),Yl(r,n,{leading:u,maxWait:n,trailing:p})}function jy(r){return Kl(r,1)}function qy(r,n){return Uc(yc(n),r)}function Hy(){if(!arguments.length)return[];var r=arguments[0];return Ce(r)?r:[r]}function By(r){return Rr(r,A)}function zy(r,n){return n=typeof n=="function"?n:t,Rr(r,A,n)}function Ky(r){return Rr(r,x|A)}function Vy(r,n){return n=typeof n=="function"?n:t,Rr(r,x|A,n)}function ky(r,n){return n==null||Dh(r,n,Gt(n))}function zr(r,n){return r===n||r!==r&&n!==n}var Gy=No(sc),Wy=No(function(r,n){return r>=n}),Xi=zh(function(){return arguments}())?zh:function(r){return Nt(r)&&st.call(r,"callee")&&!Nh.call(r,"callee")},Ce=B.isArray,Yy=ir?mr(ir):i1;function dr(r){return r!=null&&Mo(r.length)&&!gi(r)}function Ct(r){return Nt(r)&&dr(r)}function Jy(r){return r===!0||r===!1||Nt(r)&&nr(r)==M}var Ui=h0||Kc,Qy=qr?mr(qr):n1;function Xy(r){return Nt(r)&&r.nodeType===1&&!os(r)}function Zy(r){if(r==null)return!0;if(dr(r)&&(Ce(r)||typeof r=="string"||typeof r.splice=="function"||Ui(r)||Nn(r)||Xi(r)))return!r.length;var n=Xt(r);if(n==Ie||n==Oe)return!r.size;if(ns(r))return!cc(r).length;for(var a in r)if(st.call(r,a))return!1;return!0}function e_(r,n){return ts(r,n)}function t_(r,n,a){a=typeof a=="function"?a:t;var u=a?a(r,n):t;return u===t?ts(r,n,t,a):!!u}function $c(r){if(!Nt(r))return!1;var n=nr(r);return n==O||n==l||typeof r.message=="string"&&typeof r.name=="string"&&!os(r)}function r_(r){return typeof r=="number"&&Rh(r)}function gi(r){if(!Et(r))return!1;var n=nr(r);return n==ne||n==fe||n==j||n==yt}function Ql(r){return typeof r=="number"&&r==De(r)}function Mo(r){return typeof r=="number"&&r>-1&&r%1==0&&r<=W}function Et(r){var n=typeof r;return r!=null&&(n=="object"||n=="function")}function Nt(r){return r!=null&&typeof r=="object"}var Xl=xr?mr(xr):o1;function i_(r,n){return r===n||ac(r,n,Ic(n))}function n_(r,n,a){return a=typeof a=="function"?a:t,ac(r,n,Ic(n),a)}function s_(r){return Zl(r)&&r!=+r}function o_(r){if(z1(r))throw new Ae(c);return Kh(r)}function a_(r){return r===null}function c_(r){return r==null}function Zl(r){return typeof r=="number"||Nt(r)&&nr(r)==Be}function os(r){if(!Nt(r)||nr(r)!=Fe)return!1;var n=ho(r);if(n===null)return!0;var a=st.call(n,"constructor")&&n.constructor;return typeof a=="function"&&a instanceof a&&oo.call(a)==n0}var Lc=Xr?mr(Xr):a1;function u_(r){return Ql(r)&&r>=-W&&r<=W}var ef=Vn?mr(Vn):c1;function jo(r){return typeof r=="string"||!Ce(r)&&Nt(r)&&nr(r)==Ue}function br(r){return typeof r=="symbol"||Nt(r)&&nr(r)==$e}var Nn=Ki?mr(Ki):u1;function h_(r){return r===t}function l_(r){return Nt(r)&&Xt(r)==Te}function f_(r){return Nt(r)&&nr(r)==Le}var d_=No(uc),p_=No(function(r,n){return r<=n});function tf(r){if(!r)return[];if(dr(r))return jo(r)?Hr(r):fr(r);if(Gn&&r[Gn])return kg(r[Gn]());var n=Xt(r),a=n==Ie?Ja:n==Oe?io:An;return a(r)}function vi(r){if(!r)return r===0?r:0;if(r=$r(r),r===te||r===-te){var n=r<0?-1:1;return n*ee}return r===r?r:0}function De(r){var n=vi(r),a=n%1;return n===n?a?n-a:n:0}function rf(r){return r?Wi(De(r),0,re):0}function $r(r){if(typeof r=="number")return r;if(br(r))return Y;if(Et(r)){var n=typeof r.valueOf=="function"?r.valueOf():r;r=Et(n)?n+"":n}if(typeof r!="string")return r===0?r:+r;r=bh(r);var a=Oa.test(r);return a||xa.test(r)?Re(r.slice(2),a?2:8):Ia.test(r)?Y:+r}function nf(r){return ei(r,pr(r))}function g_(r){return r?Wi(De(r),-W,W):r===0?r:0}function nt(r){return r==null?"":wr(r)}var v_=Pn(function(r,n){if(ns(n)||dr(n)){ei(n,Gt(n),r);return}for(var a in n)st.call(n,a)&&Xn(r,a,n[a])}),sf=Pn(function(r,n){ei(n,pr(n),r)}),qo=Pn(function(r,n,a,u){ei(n,pr(n),r,u)}),y_=Pn(function(r,n,a,u){ei(n,Gt(n),r,u)}),__=di(rc);function m_(r,n){var a=On(r);return n==null?a:Fh(a,n)}var w_=Ke(function(r,n){r=lt(r);var a=-1,u=n.length,p=u>2?n[2]:t;for(p&&sr(n[0],n[1],p)&&(u=1);++a<u;)for(var _=n[a],S=pr(_),T=-1,F=S.length;++T<F;){var J=S[T],Q=r[J];(Q===t||zr(Q,En[J])&&!st.call(r,J))&&(r[J]=_[J])}return r}),b_=Ke(function(r){return r.push(t,bl),kt(of,t,r)});function E_(r,n){return yh(r,me(n,3),Zr)}function S_(r,n){return yh(r,me(n,3),nc)}function I_(r,n){return r==null?r:ic(r,me(n,3),pr)}function O_(r,n){return r==null?r:Hh(r,me(n,3),pr)}function P_(r,n){return r&&Zr(r,me(n,3))}function x_(r,n){return r&&nc(r,me(n,3))}function T_(r){return r==null?[]:bo(r,Gt(r))}function N_(r){return r==null?[]:bo(r,pr(r))}function Fc(r,n,a){var u=r==null?t:Yi(r,n);return u===t?a:u}function A_(r,n){return r!=null&&Il(r,n,Z0)}function Dc(r,n){return r!=null&&Il(r,n,e1)}var R_=vl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),r[n]=a},jc(gr)),C_=vl(function(r,n,a){n!=null&&typeof n.toString!="function"&&(n=ao.call(n)),st.call(r,n)?r[n].push(a):r[n]=[a]},me),U_=Ke(es);function Gt(r){return dr(r)?$h(r):cc(r)}function pr(r){return dr(r)?$h(r,!0):h1(r)}function $_(r,n){var a={};return n=me(n,3),Zr(r,function(u,p,_){li(a,n(u,p,_),u)}),a}function L_(r,n){var a={};return n=me(n,3),Zr(r,function(u,p,_){li(a,p,n(u,p,_))}),a}var F_=Pn(function(r,n,a){Eo(r,n,a)}),of=Pn(function(r,n,a,u){Eo(r,n,a,u)}),D_=di(function(r,n){var a={};if(r==null)return a;var u=!1;n=wt(n,function(_){return _=Ri(_,r),u||(u=_.length>1),_}),ei(r,Ec(r),a),u&&(a=Rr(a,x|P|A,R1));for(var p=n.length;p--;)pc(a,n[p]);return a});function M_(r,n){return af(r,Do(me(n)))}var j_=di(function(r,n){return r==null?{}:f1(r,n)});function af(r,n){if(r==null)return{};var a=wt(Ec(r),function(u){return[u]});return n=me(n),Qh(r,a,function(u,p){return n(u,p[0])})}function q_(r,n,a){n=Ri(n,r);var u=-1,p=n.length;for(p||(p=1,r=t);++u<p;){var _=r==null?t:r[ti(n[u])];_===t&&(u=p,_=a),r=gi(_)?_.call(r):_}return r}function H_(r,n,a){return r==null?r:rs(r,n,a)}function B_(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:rs(r,n,a,u)}var cf=ml(Gt),uf=ml(pr);function z_(r,n,a){var u=Ce(r),p=u||Ui(r)||Nn(r);if(n=me(n,4),a==null){var _=r&&r.constructor;p?a=u?new _:[]:Et(r)?a=gi(_)?On(ho(r)):{}:a={}}return(p?Tr:Zr)(r,function(S,T,F){return n(a,S,T,F)}),a}function K_(r,n){return r==null?!0:pc(r,n)}function V_(r,n,a){return r==null?r:rl(r,n,yc(a))}function k_(r,n,a,u){return u=typeof u=="function"?u:t,r==null?r:rl(r,n,yc(a),u)}function An(r){return r==null?[]:Ya(r,Gt(r))}function G_(r){return r==null?[]:Ya(r,pr(r))}function W_(r,n,a){return a===t&&(a=n,n=t),a!==t&&(a=$r(a),a=a===a?a:0),n!==t&&(n=$r(n),n=n===n?n:0),Wi($r(r),n,a)}function Y_(r,n,a){return n=vi(n),a===t?(a=n,n=0):a=vi(a),r=$r(r),t1(r,n,a)}function J_(r,n,a){if(a&&typeof a!="boolean"&&sr(r,n,a)&&(n=a=t),a===t&&(typeof n=="boolean"?(a=n,n=t):typeof r=="boolean"&&(a=r,r=t)),r===t&&n===t?(r=0,n=1):(r=vi(r),n===t?(n=r,r=0):n=vi(n)),r>n){var u=r;r=n,n=u}if(a||r%1||n%1){var p=Ch();return Qt(r+p*(n-r+ut("1e-"+((p+"").length-1))),n)}return lc(r,n)}var Q_=xn(function(r,n,a){return n=n.toLowerCase(),r+(a?hf(n):n)});function hf(r){return Mc(nt(r).toLowerCase())}function lf(r){return r=nt(r),r&&r.replace(ai,Hg).replace(qa,"")}function X_(r,n,a){r=nt(r),n=wr(n);var u=r.length;a=a===t?u:Wi(De(a),0,u);var p=a;return a-=n.length,a>=0&&r.slice(a,p)==n}function Z_(r){return r=nt(r),r&&_t.test(r)?r.replace(ji,Bg):r}function em(r){return r=nt(r),r&&Mt.test(r)?r.replace(Pt,"\\$&"):r}var tm=xn(function(r,n,a){return r+(a?"-":"")+n.toLowerCase()}),rm=xn(function(r,n,a){return r+(a?" ":"")+n.toLowerCase()}),im=dl("toLowerCase");function nm(r,n,a){r=nt(r),n=De(n);var u=n?wn(r):0;if(!n||u>=n)return r;var p=(n-u)/2;return To(go(p),a)+r+To(po(p),a)}function sm(r,n,a){r=nt(r),n=De(n);var u=n?wn(r):0;return n&&u<n?r+To(n-u,a):r}function om(r,n,a){r=nt(r),n=De(n);var u=n?wn(r):0;return n&&u<n?To(n-u,a)+r:r}function am(r,n,a){return a||n==null?n=0:n&&(n=+n),p0(nt(r).replace(xt,""),n||0)}function cm(r,n,a){return(a?sr(r,n,a):n===t)?n=1:n=De(n),fc(nt(r),n)}function um(){var r=arguments,n=nt(r[0]);return r.length<3?n:n.replace(r[1],r[2])}var hm=xn(function(r,n,a){return r+(a?"_":"")+n.toLowerCase()});function lm(r,n,a){return a&&typeof a!="number"&&sr(r,n,a)&&(n=a=t),a=a===t?re:a>>>0,a?(r=nt(r),r&&(typeof n=="string"||n!=null&&!Lc(n))&&(n=wr(n),!n&&mn(r))?Ci(Hr(r),0,a):r.split(n,a)):[]}var fm=xn(function(r,n,a){return r+(a?" ":"")+Mc(n)});function dm(r,n,a){return r=nt(r),a=a==null?0:Wi(De(a),0,r.length),n=wr(n),r.slice(a,a+n.length)==n}function pm(r,n,a){var u=v.templateSettings;a&&sr(r,n,a)&&(n=t),r=nt(r),n=qo({},n,u,wl);var p=qo({},n.imports,u.imports,wl),_=Gt(p),S=Ya(p,_),T,F,J=0,Q=n.interpolate||ln,Z="__p += '",ae=Qa((n.escape||ln).source+"|"+Q.source+"|"+(Q===bt?Sa:ln).source+"|"+(n.evaluate||ln).source+"|$","g"),ve="//# sourceURL="+(st.call(n,"sourceURL")?(n.sourceURL+"").replace(/\s/g," "):"lodash.templateSources["+ ++Ha+"]")+`
`;r.replace(ae,function(Ee,We,Ze,Er,or,Sr){return Ze||(Ze=Er),Z+=r.slice(J,Sr).replace(Na,zg),We&&(T=!0,Z+=`' +
__e(`+We+`) +
'`),or&&(F=!0,Z+=`';
`+or+`;
__p += '`),Ze&&(Z+=`' +
((__t = (`+Ze+`)) == null ? '' : __t) +
'`),J=Sr+Ee.length,Ee}),Z+=`';
`;var be=st.call(n,"variable")&&n.variable;if(!be)Z=`with (obj) {
`+Z+`
}
`;else if(ba.test(be))throw new Ae(f);Z=(F?Z.replace(Jr,""):Z).replace(rr,"$1").replace(oi,"$1;"),Z="function("+(be||"obj")+`) {
`+(be?"":`obj || (obj = {});
`)+"var __t, __p = ''"+(T?", __e = _.escape":"")+(F?`, __j = Array.prototype.join;
function print() { __p += __j.call(arguments, '') }
`:`;
`)+Z+`return __p
}`;var He=df(function(){return it(_,ve+"return "+Z).apply(t,S)});if(He.source=Z,$c(He))throw He;return He}function gm(r){return nt(r).toLowerCase()}function vm(r){return nt(r).toUpperCase()}function ym(r,n,a){if(r=nt(r),r&&(a||n===t))return bh(r);if(!r||!(n=wr(n)))return r;var u=Hr(r),p=Hr(n),_=Eh(u,p),S=Sh(u,p)+1;return Ci(u,_,S).join("")}function _m(r,n,a){if(r=nt(r),r&&(a||n===t))return r.slice(0,Oh(r)+1);if(!r||!(n=wr(n)))return r;var u=Hr(r),p=Sh(u,Hr(n))+1;return Ci(u,0,p).join("")}function mm(r,n,a){if(r=nt(r),r&&(a||n===t))return r.replace(xt,"");if(!r||!(n=wr(n)))return r;var u=Hr(r),p=Eh(u,Hr(n));return Ci(u,p).join("")}function wm(r,n){var a=k,u=se;if(Et(n)){var p="separator"in n?n.separator:p;a="length"in n?De(n.length):a,u="omission"in n?wr(n.omission):u}r=nt(r);var _=r.length;if(mn(r)){var S=Hr(r);_=S.length}if(a>=_)return r;var T=a-wn(u);if(T<1)return u;var F=S?Ci(S,0,T).join(""):r.slice(0,T);if(p===t)return F+u;if(S&&(T+=F.length-T),Lc(p)){if(r.slice(T).search(p)){var J,Q=F;for(p.global||(p=Qa(p.source,nt(Pr.exec(p))+"g")),p.lastIndex=0;J=p.exec(Q);)var Z=J.index;F=F.slice(0,Z===t?T:Z)}}else if(r.indexOf(wr(p),T)!=T){var ae=F.lastIndexOf(p);ae>-1&&(F=F.slice(0,ae))}return F+u}function bm(r){return r=nt(r),r&&St.test(r)?r.replace(Si,Jg):r}var Em=xn(function(r,n,a){return r+(a?" ":"")+n.toUpperCase()}),Mc=dl("toUpperCase");function ff(r,n,a){return r=nt(r),n=a?t:n,n===t?Vg(r)?Zg(r):Fg(r):r.match(n)||[]}var df=Ke(function(r,n){try{return kt(r,t,n)}catch(a){return $c(a)?a:new Ae(a)}}),Sm=di(function(r,n){return Tr(n,function(a){a=ti(a),li(r,a,Cc(r[a],r))}),r});function Im(r){var n=r==null?0:r.length,a=me();return r=n?wt(r,function(u){if(typeof u[1]!="function")throw new Nr(d);return[a(u[0]),u[1]]}):[],Ke(function(u){for(var p=-1;++p<n;){var _=r[p];if(kt(_[0],this,u))return kt(_[1],this,u)}})}function Om(r){return J0(Rr(r,x))}function jc(r){return function(){return r}}function Pm(r,n){return r==null||r!==r?n:r}var xm=gl(),Tm=gl(!0);function gr(r){return r}function qc(r){return Vh(typeof r=="function"?r:Rr(r,x))}function Nm(r){return Gh(Rr(r,x))}function Am(r,n){return Wh(r,Rr(n,x))}var Rm=Ke(function(r,n){return function(a){return es(a,r,n)}}),Cm=Ke(function(r,n){return function(a){return es(r,a,n)}});function Hc(r,n,a){var u=Gt(n),p=bo(n,u);a==null&&!(Et(n)&&(p.length||!u.length))&&(a=n,n=r,r=this,p=bo(n,Gt(n)));var _=!(Et(a)&&"chain"in a)||!!a.chain,S=gi(r);return Tr(p,function(T){var F=n[T];r[T]=F,S&&(r.prototype[T]=function(){var J=this.__chain__;if(_||J){var Q=r(this.__wrapped__),Z=Q.__actions__=fr(this.__actions__);return Z.push({func:F,args:arguments,thisArg:r}),Q.__chain__=J,Q}return F.apply(r,Pi([this.value()],arguments))})}),r}function Um(){return Xe._===this&&(Xe._=s0),this}function Bc(){}function $m(r){return r=De(r),Ke(function(n){return Yh(n,r)})}var Lm=mc(wt),Fm=mc(vh),Dm=mc(Ka);function pf(r){return Pc(r)?Va(ti(r)):d1(r)}function Mm(r){return function(n){return r==null?t:Yi(r,n)}}var jm=yl(),qm=yl(!0);function zc(){return[]}function Kc(){return!1}function Hm(){return{}}function Bm(){return""}function zm(){return!0}function Km(r,n){if(r=De(r),r<1||r>W)return[];var a=re,u=Qt(r,re);n=me(n),r-=re;for(var p=Wa(u,n);++a<r;)n(a);return p}function Vm(r){return Ce(r)?wt(r,ti):br(r)?[r]:fr(Ul(nt(r)))}function km(r){var n=++i0;return nt(r)+n}var Gm=xo(function(r,n){return r+n},0),Wm=wc("ceil"),Ym=xo(function(r,n){return r/n},1),Jm=wc("floor");function Qm(r){return r&&r.length?wo(r,gr,sc):t}function Xm(r,n){return r&&r.length?wo(r,me(n,2),sc):t}function Zm(r){return mh(r,gr)}function ew(r,n){return mh(r,me(n,2))}function tw(r){return r&&r.length?wo(r,gr,uc):t}function rw(r,n){return r&&r.length?wo(r,me(n,2),uc):t}var iw=xo(function(r,n){return r*n},1),nw=wc("round"),sw=xo(function(r,n){return r-n},0);function ow(r){return r&&r.length?Ga(r,gr):0}function aw(r,n){return r&&r.length?Ga(r,me(n,2)):0}return v.after=Ny,v.ary=Kl,v.assign=v_,v.assignIn=sf,v.assignInWith=qo,v.assignWith=y_,v.at=__,v.before=Vl,v.bind=Cc,v.bindAll=Sm,v.bindKey=kl,v.castArray=Hy,v.chain=Hl,v.chunk=J1,v.compact=Q1,v.concat=X1,v.cond=Im,v.conforms=Om,v.constant=jc,v.countBy=oy,v.create=m_,v.curry=Gl,v.curryRight=Wl,v.debounce=Yl,v.defaults=w_,v.defaultsDeep=b_,v.defer=Ay,v.delay=Ry,v.difference=Z1,v.differenceBy=ev,v.differenceWith=tv,v.drop=rv,v.dropRight=iv,v.dropRightWhile=nv,v.dropWhile=sv,v.fill=ov,v.filter=cy,v.flatMap=ly,v.flatMapDeep=fy,v.flatMapDepth=dy,v.flatten=Dl,v.flattenDeep=av,v.flattenDepth=cv,v.flip=Cy,v.flow=xm,v.flowRight=Tm,v.fromPairs=uv,v.functions=T_,v.functionsIn=N_,v.groupBy=py,v.initial=lv,v.intersection=fv,v.intersectionBy=dv,v.intersectionWith=pv,v.invert=R_,v.invertBy=C_,v.invokeMap=vy,v.iteratee=qc,v.keyBy=yy,v.keys=Gt,v.keysIn=pr,v.map=$o,v.mapKeys=$_,v.mapValues=L_,v.matches=Nm,v.matchesProperty=Am,v.memoize=Fo,v.merge=F_,v.mergeWith=of,v.method=Rm,v.methodOf=Cm,v.mixin=Hc,v.negate=Do,v.nthArg=$m,v.omit=D_,v.omitBy=M_,v.once=Uy,v.orderBy=_y,v.over=Lm,v.overArgs=$y,v.overEvery=Fm,v.overSome=Dm,v.partial=Uc,v.partialRight=Jl,v.partition=my,v.pick=j_,v.pickBy=af,v.property=pf,v.propertyOf=Mm,v.pull=_v,v.pullAll=jl,v.pullAllBy=mv,v.pullAllWith=wv,v.pullAt=bv,v.range=jm,v.rangeRight=qm,v.rearg=Ly,v.reject=Ey,v.remove=Ev,v.rest=Fy,v.reverse=Ac,v.sampleSize=Iy,v.set=H_,v.setWith=B_,v.shuffle=Oy,v.slice=Sv,v.sortBy=Ty,v.sortedUniq=Av,v.sortedUniqBy=Rv,v.split=lm,v.spread=Dy,v.tail=Cv,v.take=Uv,v.takeRight=$v,v.takeRightWhile=Lv,v.takeWhile=Fv,v.tap=Qv,v.throttle=My,v.thru=Uo,v.toArray=tf,v.toPairs=cf,v.toPairsIn=uf,v.toPath=Vm,v.toPlainObject=nf,v.transform=z_,v.unary=jy,v.union=Dv,v.unionBy=Mv,v.unionWith=jv,v.uniq=qv,v.uniqBy=Hv,v.uniqWith=Bv,v.unset=K_,v.unzip=Rc,v.unzipWith=ql,v.update=V_,v.updateWith=k_,v.values=An,v.valuesIn=G_,v.without=zv,v.words=ff,v.wrap=qy,v.xor=Kv,v.xorBy=Vv,v.xorWith=kv,v.zip=Gv,v.zipObject=Wv,v.zipObjectDeep=Yv,v.zipWith=Jv,v.entries=cf,v.entriesIn=uf,v.extend=sf,v.extendWith=qo,Hc(v,v),v.add=Gm,v.attempt=df,v.camelCase=Q_,v.capitalize=hf,v.ceil=Wm,v.clamp=W_,v.clone=By,v.cloneDeep=Ky,v.cloneDeepWith=Vy,v.cloneWith=zy,v.conformsTo=ky,v.deburr=lf,v.defaultTo=Pm,v.divide=Ym,v.endsWith=X_,v.eq=zr,v.escape=Z_,v.escapeRegExp=em,v.every=ay,v.find=uy,v.findIndex=Ll,v.findKey=E_,v.findLast=hy,v.findLastIndex=Fl,v.findLastKey=S_,v.floor=Jm,v.forEach=Bl,v.forEachRight=zl,v.forIn=I_,v.forInRight=O_,v.forOwn=P_,v.forOwnRight=x_,v.get=Fc,v.gt=Gy,v.gte=Wy,v.has=A_,v.hasIn=Dc,v.head=Ml,v.identity=gr,v.includes=gy,v.indexOf=hv,v.inRange=Y_,v.invoke=U_,v.isArguments=Xi,v.isArray=Ce,v.isArrayBuffer=Yy,v.isArrayLike=dr,v.isArrayLikeObject=Ct,v.isBoolean=Jy,v.isBuffer=Ui,v.isDate=Qy,v.isElement=Xy,v.isEmpty=Zy,v.isEqual=e_,v.isEqualWith=t_,v.isError=$c,v.isFinite=r_,v.isFunction=gi,v.isInteger=Ql,v.isLength=Mo,v.isMap=Xl,v.isMatch=i_,v.isMatchWith=n_,v.isNaN=s_,v.isNative=o_,v.isNil=c_,v.isNull=a_,v.isNumber=Zl,v.isObject=Et,v.isObjectLike=Nt,v.isPlainObject=os,v.isRegExp=Lc,v.isSafeInteger=u_,v.isSet=ef,v.isString=jo,v.isSymbol=br,v.isTypedArray=Nn,v.isUndefined=h_,v.isWeakMap=l_,v.isWeakSet=f_,v.join=gv,v.kebabCase=tm,v.last=Ur,v.lastIndexOf=vv,v.lowerCase=rm,v.lowerFirst=im,v.lt=d_,v.lte=p_,v.max=Qm,v.maxBy=Xm,v.mean=Zm,v.meanBy=ew,v.min=tw,v.minBy=rw,v.stubArray=zc,v.stubFalse=Kc,v.stubObject=Hm,v.stubString=Bm,v.stubTrue=zm,v.multiply=iw,v.nth=yv,v.noConflict=Um,v.noop=Bc,v.now=Lo,v.pad=nm,v.padEnd=sm,v.padStart=om,v.parseInt=am,v.random=J_,v.reduce=wy,v.reduceRight=by,v.repeat=cm,v.replace=um,v.result=q_,v.round=nw,v.runInContext=L,v.sample=Sy,v.size=Py,v.snakeCase=hm,v.some=xy,v.sortedIndex=Iv,v.sortedIndexBy=Ov,v.sortedIndexOf=Pv,v.sortedLastIndex=xv,v.sortedLastIndexBy=Tv,v.sortedLastIndexOf=Nv,v.startCase=fm,v.startsWith=dm,v.subtract=sw,v.sum=ow,v.sumBy=aw,v.template=pm,v.times=Km,v.toFinite=vi,v.toInteger=De,v.toLength=rf,v.toLower=gm,v.toNumber=$r,v.toSafeInteger=g_,v.toString=nt,v.toUpper=vm,v.trim=ym,v.trimEnd=_m,v.trimStart=mm,v.truncate=wm,v.unescape=bm,v.uniqueId=km,v.upperCase=Em,v.upperFirst=Mc,v.each=Bl,v.eachRight=zl,v.first=Ml,Hc(v,function(){var r={};return Zr(v,function(n,a){st.call(v.prototype,a)||(r[a]=n)}),r}(),{chain:!1}),v.VERSION=s,Tr(["bind","bindKey","curry","curryRight","partial","partialRight"],function(r){v[r].placeholder=v}),Tr(["drop","take"],function(r,n){Je.prototype[r]=function(a){a=a===t?1:Vt(De(a),0);var u=this.__filtered__&&!n?new Je(this):this.clone();return u.__filtered__?u.__takeCount__=Qt(a,u.__takeCount__):u.__views__.push({size:Qt(a,re),type:r+(u.__dir__<0?"Right":"")}),u},Je.prototype[r+"Right"]=function(a){return this.reverse()[r](a).reverse()}}),Tr(["filter","map","takeWhile"],function(r,n){var a=n+1,u=a==U||a==le;Je.prototype[r]=function(p){var _=this.clone();return _.__iteratees__.push({iteratee:me(p,3),type:a}),_.__filtered__=_.__filtered__||u,_}}),Tr(["head","last"],function(r,n){var a="take"+(n?"Right":"");Je.prototype[r]=function(){return this[a](1).value()[0]}}),Tr(["initial","tail"],function(r,n){var a="drop"+(n?"":"Right");Je.prototype[r]=function(){return this.__filtered__?new Je(this):this[a](1)}}),Je.prototype.compact=function(){return this.filter(gr)},Je.prototype.find=function(r){return this.filter(r).head()},Je.prototype.findLast=function(r){return this.reverse().find(r)},Je.prototype.invokeMap=Ke(function(r,n){return typeof r=="function"?new Je(this):this.map(function(a){return es(a,r,n)})}),Je.prototype.reject=function(r){return this.filter(Do(me(r)))},Je.prototype.slice=function(r,n){r=De(r);var a=this;return a.__filtered__&&(r>0||n<0)?new Je(a):(r<0?a=a.takeRight(-r):r&&(a=a.drop(r)),n!==t&&(n=De(n),a=n<0?a.dropRight(-n):a.take(n-r)),a)},Je.prototype.takeRightWhile=function(r){return this.reverse().takeWhile(r).reverse()},Je.prototype.toArray=function(){return this.take(re)},Zr(Je.prototype,function(r,n){var a=/^(?:filter|find|map|reject)|While$/.test(n),u=/^(?:head|last)$/.test(n),p=v[u?"take"+(n=="last"?"Right":""):n],_=u||/^find/.test(n);p&&(v.prototype[n]=function(){var S=this.__wrapped__,T=u?[1]:arguments,F=S instanceof Je,J=T[0],Q=F||Ce(S),Z=function(We){var Ze=p.apply(v,Pi([We],T));return u&&ae?Ze[0]:Ze};Q&&a&&typeof J=="function"&&J.length!=1&&(F=Q=!1);var ae=this.__chain__,ve=!!this.__actions__.length,be=_&&!ae,He=F&&!ve;if(!_&&Q){S=He?S:new Je(this);var Ee=r.apply(S,T);return Ee.__actions__.push({func:Uo,args:[Z],thisArg:t}),new Ar(Ee,ae)}return be&&He?r.apply(this,T):(Ee=this.thru(Z),be?u?Ee.value()[0]:Ee.value():Ee)})}),Tr(["pop","push","shift","sort","splice","unshift"],function(r){var n=no[r],a=/^(?:push|sort|unshift)$/.test(r)?"tap":"thru",u=/^(?:pop|shift)$/.test(r);v.prototype[r]=function(){var p=arguments;if(u&&!this.__chain__){var _=this.value();return n.apply(Ce(_)?_:[],p)}return this[a](function(S){return n.apply(Ce(S)?S:[],p)})}}),Zr(Je.prototype,function(r,n){var a=v[n];if(a){var u=a.name+"";st.call(In,u)||(In[u]=[]),In[u].push({name:n,func:a})}}),In[Po(t,oe).name]=[{name:"wrapper",func:t}],Je.prototype.clone=b0,Je.prototype.reverse=E0,Je.prototype.value=S0,v.prototype.at=Xv,v.prototype.chain=Zv,v.prototype.commit=ey,v.prototype.next=ty,v.prototype.plant=iy,v.prototype.reverse=ny,v.prototype.toJSON=v.prototype.valueOf=v.prototype.value=sy,v.prototype.first=v.prototype.head,Gn&&(v.prototype[Gn]=ry),v},bn=e0();Rt?((Rt.exports=bn)._=bn,ht._=bn):Xe._=bn}).call(ws)})(ju,ju.exports);var f5=Object.defineProperty,d5=Object.defineProperties,p5=Object.getOwnPropertyDescriptors,Xd=Object.getOwnPropertySymbols,g5=Object.prototype.hasOwnProperty,v5=Object.prototype.propertyIsEnumerable,Zd=(i,e,t)=>e in i?f5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,zo=(i,e)=>{for(var t in e||(e={}))g5.call(e,t)&&Zd(i,t,e[t]);if(Xd)for(var t of Xd(e))v5.call(e,t)&&Zd(i,t,e[t]);return i},y5=(i,e)=>d5(i,p5(e));function Fr(i,e,t){let s;const o=qu(i);return e.rpcMap&&(s=e.rpcMap[o]),s||(s=`${l5}?chainId=eip155:${o}&projectId=${t}`),s}function qu(i){return i.includes("eip155")?Number(i.split(":")[1]):Number(i)}function Ng(i){return i.map(e=>`${e.split(":")[0]}:${e.split(":")[1]}`)}function _5(i,e){const t=Object.keys(e.namespaces).filter(o=>o.includes(i));if(!t.length)return[];const s=[];return t.forEach(o=>{const c=e.namespaces[o].accounts;s.push(...c)}),s}function m5(i={},e={}){const t=ep(i),s=ep(e);return ju.exports.merge(t,s)}function ep(i){var e,t,s,o;const c={};if(!Fn(i))return c;for(const[d,f]of Object.entries(i)){const g=eh(d)?[d]:f.chains,y=f.methods||[],b=f.events||[],x=f.rpcMap||{},P=bs(d);c[P]=y5(zo(zo({},c[P]),f),{chains:Qc(g,(e=c[P])==null?void 0:e.chains),methods:Qc(y,(t=c[P])==null?void 0:t.methods),events:Qc(b,(s=c[P])==null?void 0:s.events),rpcMap:zo(zo({},x),(o=c[P])==null?void 0:o.rpcMap)})}return c}function w5(i){return i.includes(":")?i.split(":")[2]:i}function b5(i){const e={};for(const[t,s]of Object.entries(i)){const o=s.methods||[],c=s.events||[],d=s.accounts||[],f=eh(t)?[t]:s.chains?s.chains:Ng(s.accounts);e[t]={chains:f,methods:o,events:c,accounts:d}}return e}function du(i){return typeof i=="number"?i:i.includes("0x")?parseInt(i,16):i.includes(":")?Number(i.split(":")[1]):Number(i)}const Ag={},Lt=i=>Ag[i],pu=(i,e)=>{Ag[i]=e};class E5{constructor(e){this.name="polkadot",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Fr(`${this.name}:${e}`,this.namespace);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2])||[]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fr(e,this.namespace);return typeof s>"u"?void 0:new Di(new hn(s,Lt("disableProviderPing")))}}class S5{constructor(e){this.name="eip155",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.httpProviders=this.createHttpProviders(),this.chainId=parseInt(this.getDefaultChain())}async request(e){switch(e.request.method){case"eth_requestAccounts":return this.getAccounts();case"eth_accounts":return this.getAccounts();case"wallet_switchEthereumChain":return await this.handleSwitchChain(e);case"eth_chainId":return parseInt(this.getDefaultChain())}return this.namespace.methods.includes(e.request.method)?await this.client.request(e):this.getHttpProvider().request(e.request)}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}setDefaultChain(e,t){const s=qu(e);if(!this.httpProviders[s]){const o=t||Fr(`${this.name}:${s}`,this.namespace,this.client.core.projectId);if(!o)throw new Error(`No RPC url provided for chainId: ${s}`);this.setHttpProvider(s,o)}this.chainId=s,this.events.emit(Mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${s}`)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId.toString();if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}createHttpProvider(e,t){const s=t||Fr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Di(new hn(s,Lt("disableProviderPing")))}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;const o=qu(t);e[o]=this.createHttpProvider(o,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}getHttpProvider(){const e=this.chainId,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}async handleSwitchChain(e){var t,s;let o=e.request.params?(t=e.request.params[0])==null?void 0:t.chainId:"0x0";o=o.startsWith("0x")?o:`0x${o}`;const c=parseInt(o,16);if(this.isChainApproved(c))this.setDefaultChain(`${c}`);else if(this.namespace.methods.includes("wallet_switchEthereumChain"))await this.client.request({topic:e.topic,request:{method:e.request.method,params:[{chainId:o}]},chainId:(s=this.namespace.chains)==null?void 0:s[0]}),this.setDefaultChain(`${c}`);else throw new Error(`Failed to switch to chain 'eip155:${c}'. The chain is not approved or the wallet does not support 'wallet_switchEthereumChain' method.`);return null}isChainApproved(e){return this.namespace.chains.includes(`${this.name}:${e}`)}}class I5{constructor(e){this.name="solana",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Fr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Di(new hn(s,Lt("disableProviderPing")))}}class O5{constructor(e){this.name="cosmos",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||Fr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Di(new hn(s,Lt("disableProviderPing")))}}class P5{constructor(e){this.name="cip34",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(this.chainId=e,!this.httpProviders[e]){const s=t||this.getCardanoRPCUrl(e);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.events.emit(Mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{const s=this.getCardanoRPCUrl(t);e[t]=this.createHttpProvider(t,s)}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}getCardanoRPCUrl(e){const t=this.namespace.rpcMap;if(t)return t[e]}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||this.getCardanoRPCUrl(e);return typeof s>"u"?void 0:new Di(new hn(s,Lt("disableProviderPing")))}}class x5{constructor(e){this.name="elrond",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Fr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Di(new hn(s,Lt("disableProviderPing")))}}class T5{constructor(e){this.name="multiversx",this.namespace=e.namespace,this.events=Lt("events"),this.client=Lt("client"),this.chainId=this.getDefaultChain(),this.httpProviders=this.createHttpProviders()}updateNamespace(e){this.namespace=Object.assign(this.namespace,e)}requestAccounts(){return this.getAccounts()}request(e){return this.namespace.methods.includes(e.request.method)?this.client.request(e):this.getHttpProvider().request(e.request)}setDefaultChain(e,t){if(!this.httpProviders[e]){const s=t||Fr(`${this.name}:${e}`,this.namespace,this.client.core.projectId);if(!s)throw new Error(`No RPC url provided for chainId: ${e}`);this.setHttpProvider(e,s)}this.chainId=e,this.events.emit(Mi.DEFAULT_CHAIN_CHANGED,`${this.name}:${this.chainId}`)}getDefaultChain(){if(this.chainId)return this.chainId;if(this.namespace.defaultChain)return this.namespace.defaultChain;const e=this.namespace.chains[0];if(!e)throw new Error("ChainId not found");return e.split(":")[1]}getAccounts(){const e=this.namespace.accounts;return e?[...new Set(e.filter(t=>t.split(":")[1]===this.chainId.toString()).map(t=>t.split(":")[2]))]:[]}createHttpProviders(){const e={};return this.namespace.chains.forEach(t=>{var s;e[t]=this.createHttpProvider(t,(s=this.namespace.rpcMap)==null?void 0:s[t])}),e}getHttpProvider(){const e=`${this.name}:${this.chainId}`,t=this.httpProviders[e];if(typeof t>"u")throw new Error(`JSON-RPC provider for ${e} not found`);return t}setHttpProvider(e,t){const s=this.createHttpProvider(e,t);s&&(this.httpProviders[e]=s)}createHttpProvider(e,t){const s=t||Fr(e,this.namespace,this.client.core.projectId);return typeof s>"u"?void 0:new Di(new hn(s,Lt("disableProviderPing")))}}var N5=Object.defineProperty,A5=Object.defineProperties,R5=Object.getOwnPropertyDescriptors,tp=Object.getOwnPropertySymbols,C5=Object.prototype.hasOwnProperty,U5=Object.prototype.propertyIsEnumerable,rp=(i,e,t)=>e in i?N5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Ko=(i,e)=>{for(var t in e||(e={}))C5.call(e,t)&&rp(i,t,e[t]);if(tp)for(var t of tp(e))U5.call(e,t)&&rp(i,t,e[t]);return i},gu=(i,e)=>A5(i,R5(e));class ph{constructor(e){this.events=new Ku,this.rpcProviders={},this.shouldAbortPairingAttempt=!1,this.maxPairingAttempts=10,this.disableProviderPing=!1,this.providerOpts=e,this.logger=typeof(e==null?void 0:e.logger)<"u"&&typeof(e==null?void 0:e.logger)!="string"?e.logger:et.pino(et.getDefaultLoggerOptions({level:(e==null?void 0:e.logger)||Jd})),this.disableProviderPing=(e==null?void 0:e.disableProviderPing)||!1}static async init(e){const t=new ph(e);return await t.initialize(),t}async request(e,t){const[s,o]=this.validateChain(t);if(!this.session)throw new Error("Please call connect() before request()");return await this.getProvider(s).request({request:Ko({},e),chainId:`${s}:${o}`,topic:this.session.topic})}sendAsync(e,t,s){this.request(e,s).then(o=>t(null,o)).catch(o=>t(o,void 0))}async enable(){if(!this.client)throw new Error("Sign Client not initialized");return this.session||await this.connect({namespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties}),await this.requestAccounts()}async disconnect(){var e;if(!this.session)throw new Error("Please call connect() before enable()");await this.client.disconnect({topic:(e=this.session)==null?void 0:e.topic,reason:$t("USER_DISCONNECTED")}),await this.cleanup()}async connect(e){if(!this.client)throw new Error("Sign Client not initialized");if(this.setNamespaces(e),await this.cleanupPendingPairings(),!e.skipPairing)return await this.pair(e.pairingTopic)}on(e,t){this.events.on(e,t)}once(e,t){this.events.once(e,t)}removeListener(e,t){this.events.removeListener(e,t)}off(e,t){this.events.off(e,t)}get isWalletConnect(){return!0}async pair(e){this.shouldAbortPairingAttempt=!1;let t=0;do{if(this.shouldAbortPairingAttempt)throw new Error("Pairing aborted");if(t>=this.maxPairingAttempts)throw new Error("Max auto pairing attempts reached");const{uri:s,approval:o}=await this.client.connect({pairingTopic:e,requiredNamespaces:this.namespaces,optionalNamespaces:this.optionalNamespaces,sessionProperties:this.sessionProperties});s&&(this.uri=s,this.events.emit("display_uri",s)),await o().then(c=>{this.session=c,this.namespaces||(this.namespaces=b5(c.namespaces),this.persist("namespaces",this.namespaces))}).catch(c=>{if(c.message!==xg)throw c;t++})}while(!this.session);return this.onConnect(),this.session}setDefaultChain(e,t){try{if(!this.session)return;const[s,o]=this.validateChain(e);this.getProvider(s).setDefaultChain(o,t)}catch(s){if(!/Please call connect/.test(s.message))throw s}}async cleanupPendingPairings(e={}){this.logger.info("Cleaning up inactive pairings...");const t=this.client.pairing.getAll();if(si(t)){for(const s of t)e.deletePairings?this.client.core.expirer.set(s.topic,0):await this.client.core.relayer.subscriber.unsubscribe(s.topic);this.logger.info(`Inactive pairings cleared: ${t.length}`)}}abortPairingAttempt(){this.shouldAbortPairingAttempt=!0}async checkStorage(){if(this.namespaces=await this.getFromStore("namespaces"),this.optionalNamespaces=await this.getFromStore("optionalNamespaces")||{},this.client.session.length){const e=this.client.session.keys.length-1;this.session=this.client.session.get(this.client.session.keys[e]),this.createProviders()}}async initialize(){this.logger.trace("Initialized"),await this.createClient(),await this.checkStorage(),this.registerEventListeners()}async createClient(){this.client=this.providerOpts.client||await s5.init({logger:this.providerOpts.logger||Jd,relayUrl:this.providerOpts.relayUrl||c5,projectId:this.providerOpts.projectId,metadata:this.providerOpts.metadata,storageOptions:this.providerOpts.storageOptions,storage:this.providerOpts.storage,name:this.providerOpts.name}),this.logger.trace("SignClient Initialized")}createProviders(){if(!this.client)throw new Error("Sign Client not initialized");if(!this.session)throw new Error("Session not initialized. Please call connect() before enable()");const e=[...new Set(Object.keys(this.session.namespaces).map(t=>bs(t)))];pu("client",this.client),pu("events",this.events),pu("disableProviderPing",this.disableProviderPing),e.forEach(t=>{if(!this.session)return;const s=_5(t,this.session),o=Ng(s),c=m5(this.namespaces,this.optionalNamespaces),d=gu(Ko({},c[t]),{accounts:s,chains:o});switch(t){case"eip155":this.rpcProviders[t]=new S5({namespace:d});break;case"solana":this.rpcProviders[t]=new I5({namespace:d});break;case"cosmos":this.rpcProviders[t]=new O5({namespace:d});break;case"polkadot":this.rpcProviders[t]=new E5({namespace:d});break;case"cip34":this.rpcProviders[t]=new P5({namespace:d});break;case"elrond":this.rpcProviders[t]=new x5({namespace:d});break;case"multiversx":this.rpcProviders[t]=new T5({namespace:d});break}})}registerEventListeners(){if(typeof this.client>"u")throw new Error("Sign Client is not initialized");this.client.on("session_ping",e=>{this.events.emit("session_ping",e)}),this.client.on("session_event",e=>{const{params:t}=e,{event:s}=t;if(s.name==="accountsChanged"){const o=s.data;o&&si(o)&&this.events.emit("accountsChanged",o.map(w5))}else if(s.name==="chainChanged"){const o=t.chainId,c=t.event.data,d=bs(o),f=du(o)!==du(c)?`${d}:${du(c)}`:o;this.onChainChanged(f)}else this.events.emit(s.name,s.data);this.events.emit("session_event",e)}),this.client.on("session_update",({topic:e,params:t})=>{var s;const{namespaces:o}=t,c=(s=this.client)==null?void 0:s.session.get(e);this.session=gu(Ko({},c),{namespaces:o}),this.onSessionUpdate(),this.events.emit("session_update",{topic:e,params:t})}),this.client.on("session_delete",async e=>{await this.cleanup(),this.events.emit("session_delete",e),this.events.emit("disconnect",gu(Ko({},$t("USER_DISCONNECTED")),{data:e.topic}))}),this.on(Mi.DEFAULT_CHAIN_CHANGED,e=>{this.onChainChanged(e,!0)})}getProvider(e){if(!this.rpcProviders[e])throw new Error(`Provider not found: ${e}`);return this.rpcProviders[e]}onSessionUpdate(){Object.keys(this.rpcProviders).forEach(e=>{var t;this.getProvider(e).updateNamespace((t=this.session)==null?void 0:t.namespaces[e])})}setNamespaces(e){const{namespaces:t,optionalNamespaces:s,sessionProperties:o}=e;t&&Object.keys(t).length&&(this.namespaces=t),s&&Object.keys(s).length&&(this.optionalNamespaces=s),this.sessionProperties=o,this.persist("namespaces",t),this.persist("optionalNamespaces",s)}validateChain(e){const[t,s]=(e==null?void 0:e.split(":"))||["",""];if(!this.namespaces||!Object.keys(this.namespaces).length)return[t,s];if(t&&!Object.keys(this.namespaces||{}).map(d=>bs(d)).includes(t))throw new Error(`Namespace '${t}' is not configured. Please call connect() first with namespace config.`);if(t&&s)return[t,s];const o=bs(Object.keys(this.namespaces)[0]),c=this.rpcProviders[o].getDefaultChain();return[o,c]}async requestAccounts(){const[e]=this.validateChain();return await this.getProvider(e).requestAccounts()}onChainChanged(e,t=!1){var s;if(!this.namespaces)return;const[o,c]=this.validateChain(e);t||this.getProvider(o).setDefaultChain(c),((s=this.namespaces[o])!=null?s:this.namespaces[`${o}:${c}`]).defaultChain=c,this.persist("namespaces",this.namespaces),this.events.emit("chainChanged",c)}onConnect(){this.createProviders(),this.events.emit("connect",{session:this.session})}async cleanup(){this.session=void 0,this.namespaces=void 0,this.optionalNamespaces=void 0,this.sessionProperties=void 0,this.persist("namespaces",void 0),this.persist("optionalNamespaces",void 0),this.persist("sessionProperties",void 0),await this.cleanupPendingPairings({deletePairings:!0})}persist(e,t){this.client.core.storage.setItem(`${Qd}/${e}`,t)}async getFromStore(e){return await this.client.core.storage.getItem(`${Qd}/${e}`)}}const $5=ph,L5="wc",F5="ethereum_provider",D5=`${L5}@2:${F5}:`,M5="https://rpc.walletconnect.com/v1/",Hu=["eth_sendTransaction","personal_sign"],j5=["eth_accounts","eth_requestAccounts","eth_sendRawTransaction","eth_sign","eth_signTransaction","eth_signTypedData","eth_signTypedData_v3","eth_signTypedData_v4","wallet_switchEthereumChain","wallet_addEthereumChain","wallet_getPermissions","wallet_requestPermissions","wallet_registerOnboarding","wallet_watchAsset","wallet_scanQRCode"],Bu=["chainChanged","accountsChanged"],q5=["message","disconnect","connect"];var H5=Object.defineProperty,B5=Object.defineProperties,z5=Object.getOwnPropertyDescriptors,ip=Object.getOwnPropertySymbols,K5=Object.prototype.hasOwnProperty,V5=Object.prototype.propertyIsEnumerable,np=(i,e,t)=>e in i?H5(i,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):i[e]=t,Es=(i,e)=>{for(var t in e||(e={}))K5.call(e,t)&&np(i,t,e[t]);if(ip)for(var t of ip(e))V5.call(e,t)&&np(i,t,e[t]);return i},sp=(i,e)=>B5(i,z5(e));function ia(i){return Number(i[0].split(":")[1])}function vu(i){return`0x${i.toString(16)}`}function k5(i){const{chains:e,optionalChains:t,methods:s,optionalMethods:o,events:c,optionalEvents:d,rpcMap:f}=i;if(!si(e))throw new Error("Invalid chains");const g={chains:e,methods:s||Hu,events:c||Bu,rpcMap:Es({},e.length?{[ia(e)]:f[ia(e)]}:{})},y=c==null?void 0:c.filter(A=>!Bu.includes(A)),b=s==null?void 0:s.filter(A=>!Hu.includes(A));if(!t&&!d&&!o&&!(y!=null&&y.length)&&!(b!=null&&b.length))return{required:e.length?g:void 0};const x=(y==null?void 0:y.length)&&(b==null?void 0:b.length)||!t,P={chains:[...new Set(x?g.chains.concat(t||[]):t)],methods:[...new Set(g.methods.concat(o!=null&&o.length?o:j5))],events:[...new Set(g.events.concat(d||q5))],rpcMap:f};return{required:e.length?g:void 0,optional:t.length?P:void 0}}class gh{constructor(){this.events=new Dr.EventEmitter,this.namespace="eip155",this.accounts=[],this.chainId=1,this.STORAGE_KEY=D5,this.on=(e,t)=>(this.events.on(e,t),this),this.once=(e,t)=>(this.events.once(e,t),this),this.removeListener=(e,t)=>(this.events.removeListener(e,t),this),this.off=(e,t)=>(this.events.off(e,t),this),this.parseAccount=e=>this.isCompatibleChainId(e)?this.parseAccountId(e).address:e,this.signer={},this.rpc={}}static async init(e){const t=new gh;return await t.initialize(e),t}async request(e){return await this.signer.request(e,this.formatChainId(this.chainId))}sendAsync(e,t){this.signer.sendAsync(e,t,this.formatChainId(this.chainId))}get connected(){return this.signer.client?this.signer.client.core.relayer.connected:!1}get connecting(){return this.signer.client?this.signer.client.core.relayer.connecting:!1}async enable(){return this.session||await this.connect(),await this.request({method:"eth_requestAccounts"})}async connect(e){if(!this.signer.client)throw new Error("Provider not initialized. Call init() first");this.loadConnectOpts(e);const{required:t,optional:s}=k5(this.rpc);try{const o=await new Promise(async(d,f)=>{var g;this.rpc.showQrModal&&((g=this.modal)==null||g.subscribeModal(y=>{!y.open&&!this.signer.session&&(this.signer.abortPairingAttempt(),f(new Error("Connection request reset. Please try again.")))})),await this.signer.connect(sp(Es({namespaces:Es({},t&&{[this.namespace]:t})},s&&{optionalNamespaces:{[this.namespace]:s}}),{pairingTopic:e==null?void 0:e.pairingTopic})).then(y=>{d(y)}).catch(y=>{f(new Error(y.message))})});if(!o)return;const c=iE(o.namespaces,[this.namespace]);this.setChainIds(this.rpc.chains.length?this.rpc.chains:c),this.setAccounts(c),this.events.emit("connect",{chainId:vu(this.chainId)})}catch(o){throw this.signer.logger.error(o),o}finally{this.modal&&this.modal.closeModal()}}async disconnect(){this.session&&await this.signer.disconnect(),this.reset()}get isWalletConnect(){return!0}get session(){return this.signer.session}registerEventListeners(){this.signer.on("session_event",e=>{const{params:t}=e,{event:s}=t;s.name==="accountsChanged"?(this.accounts=this.parseAccounts(s.data),this.events.emit("accountsChanged",this.accounts)):s.name==="chainChanged"?this.setChainId(this.formatChainId(s.data)):this.events.emit(s.name,s.data),this.events.emit("session_event",e)}),this.signer.on("chainChanged",e=>{const t=parseInt(e);this.chainId=t,this.events.emit("chainChanged",vu(this.chainId)),this.persist()}),this.signer.on("session_update",e=>{this.events.emit("session_update",e)}),this.signer.on("session_delete",e=>{this.reset(),this.events.emit("session_delete",e),this.events.emit("disconnect",sp(Es({},$t("USER_DISCONNECTED")),{data:e.topic,name:"USER_DISCONNECTED"}))}),this.signer.on("display_uri",e=>{var t,s;this.rpc.showQrModal&&((t=this.modal)==null||t.closeModal(),(s=this.modal)==null||s.openModal({uri:e})),this.events.emit("display_uri",e)})}switchEthereumChain(e){this.request({method:"wallet_switchEthereumChain",params:[{chainId:e.toString(16)}]})}isCompatibleChainId(e){return typeof e=="string"?e.startsWith(`${this.namespace}:`):!1}formatChainId(e){return`${this.namespace}:${e}`}parseChainId(e){return Number(e.split(":")[1])}setChainIds(e){const t=e.filter(s=>this.isCompatibleChainId(s)).map(s=>this.parseChainId(s));t.length&&(this.chainId=t[0],this.events.emit("chainChanged",vu(this.chainId)),this.persist())}setChainId(e){if(this.isCompatibleChainId(e)){const t=this.parseChainId(e);this.chainId=t,this.switchEthereumChain(t)}}parseAccountId(e){const[t,s,o]=e.split(":");return{chainId:`${t}:${s}`,address:o}}setAccounts(e){this.accounts=e.filter(t=>this.parseChainId(this.parseAccountId(t).chainId)===this.chainId).map(t=>this.parseAccountId(t).address),this.events.emit("accountsChanged",this.accounts)}getRpcConfig(e){var t,s;const o=(t=e==null?void 0:e.chains)!=null?t:[],c=(s=e==null?void 0:e.optionalChains)!=null?s:[],d=o.concat(c);if(!d.length)throw new Error("No chains specified in either `chains` or `optionalChains`");const f=o.length?(e==null?void 0:e.methods)||Hu:[],g=o.length?(e==null?void 0:e.events)||Bu:[],y=(e==null?void 0:e.optionalMethods)||[],b=(e==null?void 0:e.optionalEvents)||[],x=(e==null?void 0:e.rpcMap)||this.buildRpcMap(d,e.projectId),P=(e==null?void 0:e.qrModalOptions)||void 0;return{chains:o==null?void 0:o.map(A=>this.formatChainId(A)),optionalChains:c.map(A=>this.formatChainId(A)),methods:f,events:g,optionalMethods:y,optionalEvents:b,rpcMap:x,showQrModal:!!(e!=null&&e.showQrModal),qrModalOptions:P,projectId:e.projectId,metadata:e.metadata}}buildRpcMap(e,t){const s={};return e.forEach(o=>{s[o]=this.getRpcUrl(o,t)}),s}async initialize(e){if(this.rpc=this.getRpcConfig(e),this.chainId=this.rpc.chains.length?ia(this.rpc.chains):ia(this.rpc.optionalChains),this.signer=await $5.init({projectId:this.rpc.projectId,metadata:this.rpc.metadata,disableProviderPing:e.disableProviderPing,relayUrl:e.relayUrl,storageOptions:e.storageOptions}),this.registerEventListeners(),await this.loadPersistedSession(),this.rpc.showQrModal){let t;try{const{WalletConnectModal:s}=await hw(()=>import("./index-f2f2b55e.js").then(o=>o.i),["assets/index-f2f2b55e.js","assets/index-ce1aab06.js","assets/index-1c74630b.css"]);t=s}catch{throw new Error("To use QR modal, please install @walletconnect/modal package")}if(t)try{this.modal=new t(Es({walletConnectVersion:2,projectId:this.rpc.projectId,standaloneChains:this.rpc.chains},this.rpc.qrModalOptions))}catch(s){throw this.signer.logger.error(s),new Error("Could not generate WalletConnectModal Instance")}}}loadConnectOpts(e){if(!e)return;const{chains:t,optionalChains:s,rpcMap:o}=e;t&&si(t)&&(this.rpc.chains=t.map(c=>this.formatChainId(c)),t.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)})),s&&si(s)&&(this.rpc.optionalChains=[],this.rpc.optionalChains=s==null?void 0:s.map(c=>this.formatChainId(c)),s.forEach(c=>{this.rpc.rpcMap[c]=(o==null?void 0:o[c])||this.getRpcUrl(c)}))}getRpcUrl(e,t){var s;return((s=this.rpc.rpcMap)==null?void 0:s[e])||`${M5}?chainId=eip155:${e}&projectId=${t||this.rpc.projectId}`}async loadPersistedSession(){if(!this.session)return;const e=await this.signer.client.core.storage.getItem(`${this.STORAGE_KEY}/chainId`),t=this.session.namespaces[`${this.namespace}:${e}`]?this.session.namespaces[`${this.namespace}:${e}`]:this.session.namespaces[this.namespace];this.setChainIds(e?[this.formatChainId(e)]:t==null?void 0:t.accounts),this.setAccounts(t==null?void 0:t.accounts)}reset(){this.chainId=1,this.accounts=[]}persist(){this.session&&this.signer.client.core.storage.setItem(`${this.STORAGE_KEY}/chainId`,this.chainId)}parseAccounts(e){return typeof e=="string"||e instanceof String?[this.parseAccount(e)]:e.map(t=>this.parseAccount(t))}}const hO=gh;export{hO as EthereumProvider,q5 as OPTIONAL_EVENTS,j5 as OPTIONAL_METHODS,Bu as REQUIRED_EVENTS,Hu as REQUIRED_METHODS,gh as default};
